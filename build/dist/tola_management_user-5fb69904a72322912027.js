(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"9KAa":function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),p=r.n(n),a=r("i8i4"),o=r.n(a),f=r("2vnA"),i=r("XoI5");function s(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function c(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?s(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}var u,g,h,y,_,b,v,E,O,w,j,x,k,S,P,C,N,A,D,R,z,F,I,U,T,L,H,M,B,q,V,G,W,J,l,d,m,$,K,Y=function(e,t){return i.a.get("/tola_management/user/",{params:c({page:e},t)}).then(function(e){var t=e.data,r=t.count,n=(t.results.length,t.page_count);return{users:t.results,total_pages:n,total_users:r,next_page:t.next,prev_page:t.previous}})},Q=function(e){return i.a.get("/tola_management/user/".concat(e,"/")).then(function(e){return e.data})},X=function(e,t){return i.a.put("/tola_management/user/".concat(e,"/"),t).then(function(e){return e.data})},Z=function(e){return i.a.get("/tola_management/user/".concat(e,"/program_access/")).then(function(e){return e.data})},ee=function(e,t){return i.a.put("/tola_management/user/".concat(e,"/program_access/"),t).then(function(e){})},te=function(e){return i.a.get("/tola_management/user/".concat(e,"/history/")).then(function(e){return e.data})},re=function(e){return i.a.post("/tola_management/user/",e).then(function(e){return e.data})},ne=function(e){return i.a.post("/tola_management/user/".concat(e,"/resend_registration_email/"),{}).then(function(e){return e.data})},ae=function(e,t){return i.a.post("/tola_management/user/bulk_update_status/",{user_ids:e,new_status:t}).then(function(e){return e.data})},oe=function(e,t){return i.a.post("/tola_management/user/bulk_add_programs/",{user_ids:e,added_programs:t}).then(function(e){return e.data})},ie=function(e,t){return i.a.post("/tola_management/user/bulk_remove_programs/",{user_ids:e,removed_programs:t}).then(function(e){return e.data})},se=function(e){return i.a.get("/tola_management/user/".concat(e,"/aggregate_data/")).then(function(e){return e.data})},ce=function(e,t){return i.a.put("/tola_management/user/".concat(e,"/is_active/"),t).then(function(e){return e.data})},ue=r("WtQ/");function le(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||fe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||fe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){if(e){if("string"==typeof e)return de(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?de(e,t):void 0}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function me(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,t,r){return t&&he(e.prototype,t),r&&he(e,r),e}function _e(r,n,e,t,a){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(r,n,e)||e},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(r,n,o),o=null),o}function be(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function ve(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?be(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):be(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}var Ee,Oe={profile:ve({},{id:null,first_name:"",last_name:"",username:"",email:"",phone_number:"",organization_id:null,mode_of_contact:"",title:"",user_programs:0,user:{is_active:!0}}),access:{country:{},programs:[]},history:[]},we=(g=_e((u=function(){function m(e){var t=this,r=e.regions,n=e.countries,a=e.organizations,o=e.programs,i=e.users,s=e.access,c=e.is_superuser,u=e.programs_filter,l=e.country_filter,p=e.organizations_filter,f=e.program_role_choices,d=e.country_role_choices;ge(this,m),me(this,"users",g,this),me(this,"users_listing",h,this),me(this,"users_count",y,this),me(this,"fetching_users_listing",_,this),me(this,"current_page",b,this),me(this,"total_pages",v,this),me(this,"bulk_targets",E,this),me(this,"bulk_targets_all",O,this),me(this,"applying_bulk_updates",w,this),me(this,"saving_user_profile",j,this),me(this,"saving_user_programs",x,this),me(this,"access",k,this),me(this,"is_superuser",S,this),me(this,"fetching_editing_target",P,this),me(this,"editing_target",C,this),me(this,"editing_target_data",N,this),me(this,"editing_errors",A,this),me(this,"new_user",D,this),me(this,"countries",R,this),me(this,"ordered_country_ids",z,this),me(this,"organizations",F,this),me(this,"programs",I,this),me(this,"available_users",U,this),me(this,"countries_selections",T,this),me(this,"organization_selections",L,this),me(this,"program_selections",H,this),me(this,"user_selections",M,this),me(this,"program_bulk_selections",B,this),me(this,"unsaved_changes_actions",q,this),me(this,"active_editor_pane",V,this),this.active_pane_is_dirty=!1,this.country_role_choices=[],this.program_role_choices=[],this.user_status_options=[{value:1,label:gettext("Active")},{value:0,label:gettext("Inactive")}],this.admin_role_options=[{value:1,label:gettext("Yes")},{value:0,label:gettext("No")}],me(this,"filters",G,this),me(this,"appliedFilters",W,this),me(this,"changelog_expanded_rows",J,this),this.regions=r,this.countries=n,this.ordered_country_ids=Object.values(n).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return e.id}),this.organizations=a,this.programs=o,this.available_users=i.filter(function(e){return e.name}),this.countries_selections=Object(ue.d)(this.ordered_country_ids.map(function(e){return t.countries[e]}).map(function(e){return{value:e.id,label:e.name}})),this.organization_selections=Object(ue.d)(Object.values(a).map(function(e){return{value:e.id,label:e.name}})),this.program_selections=this.createProgramSelections(this.programs),this.user_selections=this.available_users.map(function(e){return{value:e.id,label:e.name}}),this.program_bulk_selections=this.ordered_country_ids.map(function(e){return t.countries[e]}).map(function(t){return{label:t.name,options:t.programs.map(function(e){return{label:t.name+": "+o[e].name,value:t.id+"_"+e}})}}),this.access=s,this.is_superuser=c,this.filters.programs=u.map(function(e){return t.programs[e]}).map(function(e){return{label:e.name,value:e.id}}),this.filters.organizations=p.map(function(e){return t.organizations[e]}).map(function(e){return{label:e.name,value:e.id}}),this.filters.countries=l.map(function(e){return t.countries[e]}).map(function(e){return{label:e.name,value:e.id}}),this.country_role_choices=d.map(function(e){var t=pe(e,2),r=t[0];return{label:t[1],value:r}}),this.program_role_choices=f.map(function(e){var t=pe(e,2),r=t[0];return{label:t[1],value:r}}),this.appliedFilters=ve({},this.filters),this.fetchUsers()}return ye(m,[{key:"marshalFilters",value:function(e){return Object.entries(e).reduce(function(e,t){return Array.isArray(t[1])?e[t[0]]=t[1].map(function(e){return e.value}):e[t[0]]=t[1].value,e},{})}},{key:"dirtyConfirm",value:function(){return!this.active_pane_is_dirty||this.active_pane_is_dirty&&confirm(gettext("You have unsaved changes. Are you sure you want to discard them?"))}},{key:"getSelectedBulkTargetIDs",value:function(){return le(this.bulk_targets.entries()).filter(function(e){var t=pe(e,2);t[0];return t[1]}).map(function(e){var t=pe(e,2),r=t[0];t[1];return r})}},{key:"onSaveErrorHandler",value:function(e){PNotify.error({text:e||gettext("Saving Failed"),delay:5e3})}},{key:"onSaveSuccessHandler",value:function(e){PNotify.success({text:e||gettext("Successfully Saved"),delay:5e3})}},{key:"createProgramSelections",value:function(e){return Object(ue.d)(Object.values(e).map(function(e){return{value:e.id,label:e.name}}))}},{key:"onProfilePaneChange",value:function(e){this.dirtyConfirm()&&(this.active_editor_pane=e,this.active_pane_is_dirty=!1)}},{key:"setActiveFormIsDirty",value:function(e){this.active_pane_is_dirty=e}},{key:"fetchUsers",value:function(){var t=this;this.dirtyConfirm()&&(this.fetching_users_listing=!0,Y(this.current_page+1,this.marshalFilters(this.appliedFilters)).then(function(e){Object(f.p)(function(){t.active_editor_pane="profile",t.active_pane_is_dirty=!1,t.fetching_users_listing=!1,t.users=e.users.reduce(function(e,t){return e[t.id]=t,e},{}),t.users_listing=e.users.map(function(e){return e.id}),t.bulk_targets_all=!1,t.bulk_targets=new Map,t.users_count=e.total_users,t.total_pages=e.total_pages,t.next_page=e.next_page,t.previous_page=e.previous_page})}))}},{key:"applyFilters",value:function(){this.appliedFilters=ve({},this.filters),this.current_page=0,this.fetchUsers()}},{key:"changePage",value:function(e){e.selected!=this.current_page&&(this.current_page=e.selected,this.fetchUsers())}},{key:"toggleBulkTargetsAll",value:function(){var t=this;this.bulk_targets_all=!this.bulk_targets_all;var e=Object.values(this.users_listing);this.bulk_targets=new Map(e.map(function(e){return[e,t.bulk_targets_all]}))}},{key:"toggleBulkTarget",value:function(e){this.bulk_targets.set(e,!this.bulk_targets.get(e))}},{key:"changeCountryFilter",value:function(e){var t,r,n=this;0==(this.filters.countries=e).length?this.program_selections=this.createProgramSelections(this.programs):(t=e.map(function(e){return e.value}).map(function(e){return n.countries[e]}).flatMap(function(e){return e.programs}),r=new Set(t),this.program_selections=this.createProgramSelections(Array.from(r).map(function(e){return n.programs[e]})))}},{key:"changeBaseCountryFilter",value:function(e){this.filters.base_countries=e}},{key:"changeOrganizationFilter",value:function(e){this.filters.organizations=e}},{key:"changeProgramFilter",value:function(e){this.filters.programs=e}},{key:"changeUserStatusFilter",value:function(e){this.filters.user_status=e}},{key:"changeAdminRoleFilter",value:function(e){this.filters.admin_role=e}},{key:"changeUserFilter",value:function(e){this.filters.users=e,this.applyFilters()}},{key:"toggleEditingTarget",value:function(e){var o=this;this.dirtyConfirm()&&(this.editing_errors={},this.editing_target_data=ve({},Oe),this.active_pane_is_dirty=!1,"new"==this.editing_target&&this.users_listing.shift(),this.active_editor_pane="profile",this.editing_target==e?this.editing_target=null:(this.editing_target=e,this.fetching_editing_target=!0,Promise.all([Q(e),Z(e),te(e)]).then(function(e){var t=pe(e,3),r=t[0],n=t[1],a=t[2];Object(f.p)(function(){o.fetching_editing_target=!1,o.editing_target_data={profile:r,access:n,history:a}})})))}},{key:"updateActiveEditPage",value:function(e){this.active_edit_page=e,this.active_pane_is_dirty=!1}},{key:"createUser",value:function(){this.dirtyConfirm()&&(this.editing_errors={},this.active_pane_is_dirty=!1,this.active_editor_pane="profile","new"==this.editing_target&&this.users_listing.shift(),this.editing_target_data=ve({},Oe),this.users.new={id:"new",name:"",organization_name:"",user_programs:0,is_active:!1},this.users_listing.unshift("new"),this.editing_target="new")}},{key:"updateUserProfile",value:function(e,t){var o=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,X(e,t).then(function(a){return Promise.all([se(a.id),te(a.id)]).then(function(e){var t=pe(e,2),r=t[0],n=t[1];o.onSaveSuccessHandler(),Object(f.p)(function(){o.saving_user_profile=!1,o.users[a.id]={id:a.id,name:a.name,organization_name:o.organizations[a.organization_id].name,user_programs:r.program_count,is_active:a.user.is_active},o.active_pane_is_dirty=!1,o.editing_target_data.profile=a,o.editing_target_data.history=n})})}).catch(function(e){o.onSaveErrorHandler(e.response.data.detail),Object(f.p)(function(){o.saving_user_profile=!1,o.editing_errors=e.response.data})})}},{key:"updateUserIsActive",value:function(e,t){var o=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,ce(e,t).then(function(a){return Promise.all([se(e),te(e)]).then(function(e){var t=pe(e,2),r=t[0],n=t[1];o.onSaveSuccessHandler(),Object(f.p)(function(){o.saving_user_profile=!1,o.users[a.id]={id:a.id,name:a.name,organization_name:o.organizations[a.organization_id].name,user_programs:r.program_count,is_active:a.user.is_active},o.active_pane_is_dirty=!1,o.editing_target_data.profile=a,o.editing_target_data.history=n})})}).catch(function(e){o.onSaveErrorHandler(e.response.data.detail),Object(f.p)(function(){o.saving_user_profile=!1,o.editing_errors=e.response.data})})}},{key:"resendRegistrationEmail",value:function(e){var t=this;this.saving_user_profile=!0,ne(e).then(function(e){Object(f.p)(function(){t.saving_user_profile=!1,t.onSaveSuccessHandler(gettext("Verification email sent"))})}).catch(function(){t.onSaveSuccessHandler(gettext("Verification email send failed"))})}},{key:"saveNewUser",value:function(e){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,re(e).then(function(t){return se(t.id).then(function(e){r.onSaveSuccessHandler(),Object(f.p)(function(){r.saving_user_profile=!1,r.users[t.id]={id:t.id,name:t.name,organization_name:r.organizations[t.organization_id].name,user_programs:e.program_count,is_active:t.user.is_active},r.active_pane_is_dirty=!1,r.user_selections.push({value:t.id,label:t.name}),r.users_listing[0]=t.id,r.editing_target=null,r.toggleEditingTarget(t.id),delete r.users.new})})}).catch(function(e){r.onSaveErrorHandler(e.response.data.detail),Object(f.p)(function(){r.saving_user_profile=!1,r.editing_errors=e.response.data})})}},{key:"saveNewUserAndAddAnother",value:function(e){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,re(e).then(function(t){return se(t.id).then(function(e){r.onSaveSuccessHandler(),Object(f.p)(function(){r.saving_user_profile=!1,r.users[t.id]={id:t.id,name:t.name,organization_name:r.organizations[t.organization_id].name,user_programs:e.program_count,is_active:t.user.is_active},r.active_pane_is_dirty=!1,r.user_selections.push({value:t.id,label:t.name}),r.users_listing[0]=t.id,delete r.users.new,r.createUser()})})}).catch(function(e){r.onSaveErrorHandler(e.response.data.detail),Object(f.p)(function(){r.saving_user_profile=!1,r.editing_errors=e.response.data})})}},{key:"saveUserPrograms",value:function(o,e){var i=this;this.saving_user_programs=!0,this.active_pane_is_dirty=!1,ee(o,e).then(function(e){return Promise.all([se(o),te(o),Z(o)]).then(function(e){var t=pe(e,3),r=t[0],n=t[1],a=t[2];Object(f.p)(function(){i.saving_user_programs=!1,i.users[o].user_programs=r.program_count,i.editing_target_data.history=n,i.editing_target_data.access=a,i.active_pane_is_dirty=!1}),i.onSaveSuccessHandler()})}).catch(function(e){i.onSaveErrorHandler(e.response.data.detail),Object(f.p)(function(){i.saving_user_programs=!1})})}},{key:"bulkUpdateUserStatus",value:function(e){var r=this;this.applying_bulk_updates=!0,ae(this.getSelectedBulkTargetIDs(),e).then(function(e){Object(f.p)(function(){e.forEach(function(e){var t=Object.assign(r.users[e.id],e);r.users[t.id]=t}),r.applying_bulk_updates=!1}),r.onSaveSuccessHandler()}).catch(function(e){Object(f.p)(function(){r.applying_bulk_updates=!1}),r.onSaveErrorHandler()})}},{key:"bulkAddPrograms",value:function(e){var a=this;this.applying_bulk_updates=!0,oe(this.getSelectedBulkTargetIDs(),e.map(function(e){var t=pe(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}})).then(function(e){a.getSelectedBulkTargetIDs().forEach(function(e){a.editing_target==e&&Z(e).then(function(e){Object(f.p)(function(){a.editing_target_data.access=e})})}),Object(f.p)(function(){Object.entries(e).forEach(function(e){var t=pe(e,2),r=t[0],n=t[1];a.users[r].user_programs=n}),a.applying_bulk_updates=!1}),a.onSaveSuccessHandler()}).catch(function(e){Object(f.p)(function(){a.applying_bulk_updates=!1}),a.onSaveErrorHandler()})}},{key:"bulkRemovePrograms",value:function(e){var a=this;this.applying_bulk_updates=!0,ie(this.getSelectedBulkTargetIDs(),e.map(function(e){var t=pe(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}})).then(function(e){a.getSelectedBulkTargetIDs().forEach(function(e){a.editing_target==e&&Z(e).then(function(e){Object(f.p)(function(){a.editing_target_data.access=e})})}),Object(f.p)(function(){Object.entries(e).forEach(function(e){var t=pe(e,2),r=t[0],n=t[1];a.users[r].user_programs=n}),a.applying_bulk_updates=!1}),a.onSaveSuccessHandler()}).catch(function(e){Object(f.p)(function(){a.applying_bulk_updates=!1}),a.onSaveErrorHandler()})}},{key:"clearFilters",value:function(){this.filters={countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:this.filters.users||[]}}},{key:"toggleChangeLogRowExpando",value:function(e){this.changelog_expanded_rows.has(e)?this.changelog_expanded_rows.delete(e):this.changelog_expanded_rows.add(e)}},{key:"countriesByRegion",get:function(){var e=this;return Object.values(this.regions||{}).map(function(t){return{id:t.id,name:gettext(t.name),countries:Object.values(e.countries).filter(function(e){return e.region==t.id})}}).filter(function(e){return 0<e.countries.length}).sort(function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1})}}]),m}()).prototype,"users",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),h=_e(u.prototype,"users_listing",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y=_e(u.prototype,"users_count",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=_e(u.prototype,"fetching_users_listing",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=_e(u.prototype,"current_page",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=_e(u.prototype,"total_pages",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=_e(u.prototype,"bulk_targets",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),O=_e(u.prototype,"bulk_targets_all",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=_e(u.prototype,"applying_bulk_updates",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=_e(u.prototype,"saving_user_profile",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=_e(u.prototype,"saving_user_programs",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=_e(u.prototype,"access",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:{},programs:{}}}}),S=_e(u.prototype,"is_superuser",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=_e(u.prototype,"fetching_editing_target",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=_e(u.prototype,"editing_target",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=_e(u.prototype,"editing_target_data",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ve({},Oe)}}),A=_e(u.prototype,"editing_errors",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),D=_e(u.prototype,"new_user",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=_e(u.prototype,"countries",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),z=_e(u.prototype,"ordered_country_ids",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=_e(u.prototype,"organizations",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),I=_e(u.prototype,"programs",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),U=_e(u.prototype,"available_users",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=_e(u.prototype,"countries_selections",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=_e(u.prototype,"organization_selections",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=_e(u.prototype,"program_selections",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=_e(u.prototype,"user_selections",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=_e(u.prototype,"program_bulk_selections",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=_e(u.prototype,"unsaved_changes_actions",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{save:function(){},discard:function(){}}}}),V=_e(u.prototype,"active_editor_pane",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"profile"}}),G=_e(u.prototype,"filters",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:[]}}}),W=_e(u.prototype,"appliedFilters",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),J=_e(u.prototype,"changelog_expanded_rows",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),_e(u.prototype,"countriesByRegion",[f.f],Object.getOwnPropertyDescriptor(u.prototype,"countriesByRegion"),u.prototype),_e(u.prototype,"onProfilePaneChange",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"onProfilePaneChange"),u.prototype),_e(u.prototype,"fetchUsers",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"fetchUsers"),u.prototype),_e(u.prototype,"applyFilters",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"applyFilters"),u.prototype),_e(u.prototype,"changePage",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changePage"),u.prototype),_e(u.prototype,"toggleBulkTargetsAll",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"toggleBulkTargetsAll"),u.prototype),_e(u.prototype,"toggleBulkTarget",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"toggleBulkTarget"),u.prototype),_e(u.prototype,"changeCountryFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeCountryFilter"),u.prototype),_e(u.prototype,"changeBaseCountryFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeBaseCountryFilter"),u.prototype),_e(u.prototype,"changeOrganizationFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeOrganizationFilter"),u.prototype),_e(u.prototype,"changeProgramFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeProgramFilter"),u.prototype),_e(u.prototype,"changeUserStatusFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeUserStatusFilter"),u.prototype),_e(u.prototype,"changeAdminRoleFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeAdminRoleFilter"),u.prototype),_e(u.prototype,"changeUserFilter",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"changeUserFilter"),u.prototype),_e(u.prototype,"toggleEditingTarget",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"toggleEditingTarget"),u.prototype),_e(u.prototype,"updateActiveEditPage",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"updateActiveEditPage"),u.prototype),_e(u.prototype,"createUser",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"createUser"),u.prototype),_e(u.prototype,"updateUserProfile",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"updateUserProfile"),u.prototype),_e(u.prototype,"updateUserIsActive",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"updateUserIsActive"),u.prototype),_e(u.prototype,"resendRegistrationEmail",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"resendRegistrationEmail"),u.prototype),_e(u.prototype,"saveNewUser",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"saveNewUser"),u.prototype),_e(u.prototype,"saveNewUserAndAddAnother",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"saveNewUserAndAddAnother"),u.prototype),_e(u.prototype,"saveUserPrograms",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"saveUserPrograms"),u.prototype),_e(u.prototype,"bulkUpdateUserStatus",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"bulkUpdateUserStatus"),u.prototype),_e(u.prototype,"bulkAddPrograms",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"bulkAddPrograms"),u.prototype),_e(u.prototype,"bulkRemovePrograms",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"bulkRemovePrograms"),u.prototype),_e(u.prototype,"clearFilters",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"clearFilters"),u.prototype),_e(u.prototype,"toggleChangeLogRowExpando",[f.d],Object.getOwnPropertyDescriptor(u.prototype,"toggleChangeLogRowExpando"),u.prototype),u),je=(d=_e((l=function(){function r(e,t){ge(this,r),me(this,"regions",d,this),me(this,"countries",m,this),me(this,"_selectedCountryIds",$,this),me(this,"_expandedCountryIds",K,this),this.regions=e,this.countries=t,this._selectedCountryIds=[],this._expandedCountryIds=new Set(le(Object.keys(this.countries).map(function(e){return parseInt(e)}))),this.nameSort=function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1}}return ye(r,[{key:"isExpanded",value:function(e){return this._expandedCountryIds.has(parseInt(e))}},{key:"toggleExpanded",value:function(e){this._expandedCountryIds.has(parseInt(e))?this._expandedCountryIds.delete(parseInt(e)):this._expandedCountryIds.add(parseInt(e))}},{key:"setExpanded",value:function(e){this._expandedCountryIds.add(parseInt(e))}},{key:"removeRegion",value:function(t){var r=Object.values(this.countries).filter(function(e){return e.region==t}).map(function(e){return e.id});this._selectedCountryIds=this._selectedCountryIds.filter(function(e){return!r.includes(e)})}},{key:"addRegion",value:function(t){var e=Object.values(this.countries).filter(function(e){return e.region==t}).map(function(e){return e.id});this._selectedCountryIds=le(new Set([].concat(le(this._selectedCountryIds),le(e))))}},{key:"removeCountry",value:function(t){this._selectedCountryIds=this._selectedCountryIds.filter(function(e){return e!==t}),this._expandedCountryIds.delete(parseInt(t))}},{key:"addCountry",value:function(e){this._selectedCountryIds=le(new Set([].concat(le(this._selectedCountryIds),[e]))),this._expandedCountryIds.add(parseInt(e))}},{key:"updateSelected",value:function(t){var r=this;0==t.length?(this._selectedCountryIds=[],this._expandedCountryIds=new Set(le(Object.keys(this.countries).map(function(e){return parseInt(e)})))):t.length<this.selectedOptions.length?(this.selectedOptions.filter(function(e){return!t.map(function(e){return e.value}).includes(e.value)}).forEach(function(e){e.value&&"".concat(e.value).includes("r")?r.removeRegion(e.value.slice(2)):e.value&&r.removeCountry(e.value)}),0==this.selectedOptions.length&&(this._expandedCountryIds=new Set(le(Object.keys(this.countries).map(function(e){return parseInt(e)}))))):(0==this.selectedOptions.length&&(this._expandedCountryIds=new Set([])),t.filter(function(e){return!r.selectedOptions.map(function(e){return e.value}).includes(e.value)}).forEach(function(e){e.value&&"".concat(e.value).includes("r")?r.addRegion(e.value.slice(2)):e.value&&r.addCountry(e.value)}))}},{key:"orderedRegions",get:function(){var e=this;return Object.values(this.regions||{}).map(function(t){return{id:t.id,name:gettext(t.name),countries:Object.values(e.countries).filter(function(e){return e.region==t.id}).sort(e.nameSort)}}).filter(function(e){return 0<e.countries.length}).sort(this.nameSort)}},{key:"groupedOptions",get:function(){return[{label:gettext("Regions"),value:null,selectable:!1,options:this.orderedRegions.map(function(e){return{label:e.name,value:"r-".concat(e.id)}})}].concat(le(this.orderedRegions.map(function(e){return{label:e.name,value:null,divider:!0,options:e.countries.map(function(e){return{label:e.name,value:e.id}})}})))}},{key:"selectedCountries",get:function(){return this._selectedCountryIds.map(function(e){return parseInt(e)})}},{key:"selectedOptions",get:function(){function t(e){return r.selectedCountries.includes(e.id)}var r=this;return[].concat(le(this.orderedRegions.filter(function(e){return e.countries.every(t)}).map(function(e){return{value:"r-".concat(e.id),label:e.name,noList:!0}})),le(this.selectedCountries.map(function(e){return{label:r.countries[e].name,value:r.countries[e].id}})))}}]),r}()).prototype,"regions",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_e(l.prototype,"countries",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=_e(l.prototype,"_selectedCountryIds",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=_e(l.prototype,"_expandedCountryIds",[f.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e(l.prototype,"orderedRegions",[f.f],Object.getOwnPropertyDescriptor(l.prototype,"orderedRegions"),l.prototype),_e(l.prototype,"groupedOptions",[f.f],Object.getOwnPropertyDescriptor(l.prototype,"groupedOptions"),l.prototype),_e(l.prototype,"selectedCountries",[f.f],Object.getOwnPropertyDescriptor(l.prototype,"selectedCountries"),l.prototype),_e(l.prototype,"selectedOptions",[f.f],Object.getOwnPropertyDescriptor(l.prototype,"selectedOptions"),l.prototype),_e(l.prototype,"toggleExpanded",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"toggleExpanded"),l.prototype),_e(l.prototype,"setExpanded",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"setExpanded"),l.prototype),_e(l.prototype,"removeRegion",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"removeRegion"),l.prototype),_e(l.prototype,"addRegion",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"addRegion"),l.prototype),_e(l.prototype,"removeCountry",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"removeCountry"),l.prototype),_e(l.prototype,"addCountry",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"addCountry"),l.prototype),_e(l.prototype,"updateSelected",[f.d],Object.getOwnPropertyDescriptor(l.prototype,"updateSelected"),l.prototype),l),xe=r("okNM"),ke=r("Cs6D"),Se=r("Z2Y6"),Pe=r("TGVD");function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=Re(o);return t=i?(e=Re(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==Ce(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze,Fe=Object(xe.c)(Ee=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(a,p.a.Component);var e,t,r,n=De(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),n.apply(this,arguments)}return e=a,(t=[{key:"updateActivePage",value:function(e){this.props.new||this.props.notifyPaneChange(e)}},{key:"render",value:function(){var t=this,e=this.props,r=e.ProfileSection,n=e.ProgramSection,a=e.HistorySection,o=e.active_pane,i="profile"==o?"active":"",s="programs_and_roles"==o?"active":"",c="status_and_history"==o?"active":"",u=this.props.new?"disabled":"";return p.a.createElement("div",{className:"tab-set--vertical"},p.a.createElement("ul",{className:"nav nav-tabs"},p.a.createElement("li",{className:"nav-item"},p.a.createElement("a",{href:"#",className:"nav-link ".concat(i),onClick:function(e){e.preventDefault(),t.updateActivePage("profile")}},gettext("Profile"))),p.a.createElement("li",{className:"nav-item"},p.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(s," ").concat(u),onClick:function(e){e.preventDefault(),t.updateActivePage("programs_and_roles")}},gettext("Programs and Roles"))),p.a.createElement("li",{className:"nav-item"},p.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(c," ").concat(u),onClick:function(e){e.preventDefault(),t.updateActivePage("status_and_history")}},gettext("Status and History")))),p.a.createElement("div",{className:"tab-content"},"profile"==o&&p.a.createElement(r,null),"programs_and_roles"==o&&p.a.createElement(n,null),"status_and_history"==o&&p.a.createElement(a,null)))}}])&&Ne(e.prototype,t),r&&Ne(e,r),a}())||Ee;function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function Te(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Ue(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):Ue(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}function Le(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return He(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=Ve(o);return t=i?(e=Ve(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==Ie(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ge,We=Object(xe.c)(ze=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(l,p.a.Component);var e,t,r,u=qe(l);function l(t){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),e=u.call(this,t);var r,n=t.userData,a=[],o=Le(t.organizations.filter(function(e){return 1!=e.value||t.is_superuser}));try{for(o.s();!(r=o.n()).done;){var i=r.value,s=Object(f.r)(i);"Mercy Corps"===s.label&&(s.label=gettext("Mercy Corps -- managed by Okta"),s.isDisabled=!0),a.push(s)}}catch(e){o.e(e)}finally{o.f()}var c=a.find(function(e){return e.value==n.organization_id});return e.hasMCEmail=n.email.endsWith("@mercycorps.org"),e.state={original_user_data:Te({},n),managed_user_data:Te({},n),selected_organization:c,organization_listing:a},e}return e=l,(t=[{key:"save",value:function(){this.props.onUpdate(this.state.managed_user_data)}},{key:"saveNew",value:function(e){e.preventDefault(),this.props.onCreate(this.state.managed_user_data)}},{key:"saveNewAndAddAnother",value:function(e){e.preventDefault(),this.props.onCreateAndAddAnother(this.state.managed_user_data)}},{key:"updateFirstName",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{first_name:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateLastName",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{last_name:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateUsername",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{username:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateOrganization",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{organization_id:e.value}),selected_organization:e},function(){return t.hasUnsavedDataAction()})}},{key:"updateTitle",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{title:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateEmail",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{email:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updatePhone",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{phone_number:e})},function(){return t.hasUnsavedDataAction()})}},{key:"updateModeOfContact",value:function(e){var t=this;this.setState({managed_user_data:Te(Te({},this.state.managed_user_data),{},{mode_of_contact:e})},function(){return t.hasUnsavedDataAction()})}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(JSON.stringify(this.state.managed_user_data)!=JSON.stringify(this.state.original_user_data))}},{key:"resetForm",value:function(){var t=this,e=this.state.organization_listing.find(function(e){return e.value==t.state.original_user_data.organization_id});this.setState({managed_user_data:this.state.original_user_data,selected_organization:e},function(){return t.hasUnsavedDataAction()})}},{key:"render",value:function(){var t=this,e=this.state.managed_user_data,r=this.props.errors,n=this.props.disabled,a=r.first_name?"is-invalid":"",o=r.last_name?"is-invalid":"",i=r.username?"is-invalid":"",s=r.email?"is-invalid":"",c=r.organization_id?"is-invalid":"";return p.a.createElement("div",{className:"tab-pane--react"},p.a.createElement("h2",{className:"no-bold"},e.name?e.name+": ":"",gettext("Profile")),p.a.createElement("form",{className:"form"},p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-first-name-input"},gettext("Preferred First Name")),p.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+a,type:"text",value:e.first_name||"",onChange:function(e){return t.updateFirstName(e.target.value)},id:"user-first-name-input",required:!0}),r.first_name&&p.a.createElement("div",{className:"invalid-feedback"},r.first_name)),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-last-name-input"},gettext("Preferred Last Name")),p.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+o,type:"text",value:e.last_name||"",onChange:function(e){return t.updateLastName(e.target.value)},id:"user-last-name-input",required:!0}),r.last_name&&p.a.createElement("div",{className:"invalid-feedback"},r.last_name)),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-username-input"},gettext("Username")),p.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+i,type:"text",value:e.username||"",onChange:function(e){return t.updateUsername(e.target.value)},id:"user-username-input",required:!0}),r.username&&p.a.createElement("div",{className:"invalid-feedback"},r.username)),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-organization-input"},gettext("Organization")),p.a.createElement(ke.a,{isDisabled:n||this.hasMCEmail,className:"react-select "+c,value:this.state.selected_organization,options:this.state.organization_listing,onChange:function(e){return t.updateOrganization(e)},placeholder:gettext("None Selected"),id:"user-organization-input"}),r.organization_id&&p.a.createElement("div",{className:"invalid-feedback feedback--react-select"},r.organization_id)),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{htmlFor:"user-title-input"},gettext("Title")),p.a.createElement("input",{disabled:n,maxLength:"50",type:"text",value:e.title||"",onChange:function(e){return t.updateTitle(e.target.value)},className:"form-control",id:"user-title-input"})),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-email-input"},gettext("Email")),p.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+s,type:"email",value:e.email||"",onChange:function(e){return t.updateEmail(e.target.value)},id:"user-email-input"}),r.email&&p.a.createElement("div",{className:"invalid-feedback"},r.email)),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{htmlFor:"user-phone-input"},gettext("Phone")),p.a.createElement("input",{disabled:n,type:"tel",value:e.phone_number||"",onChange:function(e){return t.updatePhone(e.target.value)},className:"form-control",id:"user-phone-input"})),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{htmlFor:"user-mode-of-contact-input"},gettext("Preferred Mode of Contact")),p.a.createElement("input",{disabled:n,type:"text",value:e.mode_of_contact||"",onChange:function(e){return t.updateModeOfContact(e.target.value)},className:"form-control",id:"user-mode-of-contact-input"})),this.props.new&&!n&&p.a.createElement("div",{className:"form-group btn-row"},p.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(e){return t.saveNew(e)}},gettext("Save changes")),p.a.createElement("button",{className:"btn btn-secondary",onClick:function(e){return t.saveNewAndAddAnother(e)}},gettext("Save And Add Another")),p.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.resetForm()}},gettext("Reset"))),!this.props.new&&!n&&p.a.createElement("div",{className:"form-group btn-row"},p.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return t.save()}},gettext("Save changes")),p.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.resetForm()}},gettext("Reset")))))}}])&&Me(e.prototype,t),r&&Me(e,r),l}())||ze,Je=r("c7k8"),$e=r("IP2g");function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=et(o);return t=i?(e=et(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==Ke(n)&&"function"!=typeof n?Ze(r):n}}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e){return function(e){if(Array.isArray(e))return st(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||it(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(r),!0).forEach(function(e){at(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rt(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function at(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||it(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){if(e){if("string"==typeof e)return st(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?st(e,t):void 0}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ct(e,t,r){if(!r)return{programs:e,countries:t};var n=Object.entries(e).filter(function(e){var t=ot(e,2);t[0];return t[1].name.toLowerCase().includes(r.toLowerCase())}).map(function(e){var t=ot(e,2);t[0];return t[1]});return{countries:Object.entries(t).filter(function(e){var t=ot(e,2),r=(t[0],t[1]);return n.some(function(e){return r.programs.has(e.id)})}).map(function(e){var t=ot(e,2);t[0];return t[1]}).reduce(function(e,t){return nt(nt({},e),{},at({},t.id,t))},{}),programs:n.reduce(function(e,t){return nt(nt({},e),{},at({},t.id,t))},{})}}function ut(t,e){return 0<e.length?e.filter(function(e){return t[e]}).map(function(e){return t[e]}).reduce(function(e,t){return nt(nt({},e),{},at({},t.id,t))},{}):t}function lt(t,r,n){return Array.from(t.programs).filter(function(e){return!!r[e]}).every(function(e){return n.programs["".concat(t.id,"_").concat(e)]&&n.programs["".concat(t.id,"_").concat(e)].has_access})}var pt,ft=function(e,o){return Object.entries(e).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,nt(nt({},a),{},{type:"country",options:[{label:gettext("Individual programs only"),value:"none"}].concat(tt(o.country_role_choices)),admin_access:o.is_superuser,programs:new Set(a.programs)})))},{})},dt=function(e,o){return Object.entries(e).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,nt(nt({},a),{},{type:"program",options:o.program_role_choices})))},{})},mt=function(e,r,n){return e.flatMap(function(t){return[t].concat(tt(n(t.id)?Array.from(t.programs).filter(function(e){return r[e]}).map(function(e){return nt(nt({},r[e]),{},{id:"".concat(t.id,"_").concat(e),country_id:t.id})}):[]))})},gt=function(e){return{countries:Object.entries(e.countries).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,nt(nt({},a),{},{has_access:!0})))},{}),programs:e.programs.reduce(function(e,t){return nt(nt({},e),{},at({},"".concat(t.country,"_").concat(t.program),nt(nt({},t),{},{has_access:!0})))},{})}},ht=Object(xe.c)(Ge=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(s,p.a.Component);var e,t,r,i=Xe(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=i.call(this,e);var r=e.store,n=ft(r.countries,r),a=dt(r.programs,r);t.countryStore=new je(r.regions,r.countries);var o=t.isExpanded.bind(Ze(t),"");return t.state={program_filter:"",countries:n,programs:a,filtered_countries:n,filtered_programs:a,ordered_country_ids:r.ordered_country_ids,flattened_programs:mt(r.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),a,o),original_user_program_access:gt(r.editing_target_data.access),user_program_access:gt(r.editing_target_data.access)},t}return e=s,(t=[{key:"saveForm",value:function(){var r=this,e=this.state.user_program_access;this.props.onSave({countries:Object.entries(e.countries).filter(function(e){var t=ot(e,2);t[0],t[1];return r.props.store.is_superuser}).filter(function(e){var t=ot(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,a))},{}),programs:Object.entries(e.programs).filter(function(e){var t=ot(e,2);t[0];return t[1].has_access}).map(function(e){var t=ot(e,2);t[0];return t[1]})}),this.hasUnsavedDataAction()}},{key:"hasUnsavedDataAction",value:function(){var e={countries:Object.entries(this.state.user_program_access.countries).filter(function(e){var t=ot(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,a))},{}),programs:Object.entries(this.state.user_program_access.programs).filter(function(e){var t=ot(e,2);t[0];return t[1].has_access}).reduce(function(e,t){var r=ot(t,2),n=r[0],a=r[1];return nt(nt({},e),{},at({},n,a))},{})};this.props.onIsDirtyChange(JSON.stringify(e)!=JSON.stringify(this.state.original_user_program_access))}},{key:"resetForm",value:function(){var e=this;this.setState({user_program_access:{countries:nt({},this.state.original_user_program_access.countries),programs:nt({},this.state.original_user_program_access.programs)}},function(){return e.hasUnsavedDataAction()})}},{key:"toggleProgramAccess",value:function(t){var e=this,r=this.state.user_program_access.programs,n=function(){if(r[t])return nt(nt({},r[t]),{},{has_access:!r[t].has_access});var e=ot(t.split("_"),2);return{country:e[0],program:e[1],role:"low",has_access:!0}}();this.setState({user_program_access:nt(nt({},this.state.user_program_access),{},{programs:nt(nt({},r),{},at({},t,n))})},function(){return e.hasUnsavedDataAction()})}},{key:"toggleAllProgramsForCountry",value:function(e){var a=this,o=this.state.countries[e],t=lt(o,a.state.filtered_programs,a.state.user_program_access)?Array.from(o.programs).filter(function(e){return!!a.state.filtered_programs[e]}).reduce(function(e,t){var r="".concat(o.id,"_").concat(t),n=a.state.user_program_access.programs[r];return n?nt(nt({},e),{},at({},r,nt(nt({},n),{},{has_access:!1}))):e},{}):Array.from(o.programs).filter(function(e){return!!a.state.filtered_programs[e]}).reduce(function(e,t){var r="".concat(o.id,"_").concat(t),n=a.state.user_program_access.programs[r];return nt(nt({},e),{},at({},r,n?nt(nt({},n),{},{has_access:!0}):{program:t,country:o.id,role:"low",has_access:!0}))},{});this.setState({user_program_access:nt(nt({},this.state.user_program_access),{},{programs:nt(nt({},this.state.user_program_access.programs),t)})},function(){return a.hasUnsavedDataAction()})}},{key:"changeCountryRole",value:function(e,t){var r=this,n=nt({},this.state.user_program_access.countries[e]),a=nt(nt({},n),{},"none"!=t?{role:t,has_access:!0}:{role:t,has_access:!1});this.setState({user_program_access:nt(nt({},this.state.user_program_access),{},{countries:nt(nt({},this.state.user_program_access.countries),{},at({},e,a))})},function(){return r.hasUnsavedDataAction()})}},{key:"changeProgramRole",value:function(e,t){var r=this,n=ot(e.split("_"),2),a=n[0],o=n[1],i=this.state.user_program_access,s=i[a]&&i[a].has_access&&"low"==t?{program:o,country:a,role:t,has_access:!1}:{program:o,country:a,role:t,has_access:!0};this.setState({user_program_access:nt(nt({},this.state.user_program_access),{},{programs:nt(nt({},this.state.user_program_access.programs),{},at({},e,s))})},function(){return r.hasUnsavedDataAction()})}},{key:"clearFilter",value:function(){var e=ut(this.state.countries,this.countryStore.selectedCountries),t=ct(this.state.programs,e,""),r=t.countries,n=t.programs,a=this.isExpanded.bind(this,"");this.setState({program_filter:"",filtered_programs:n,filtered_countries:r,flattened_programs:mt(this.state.ordered_country_ids.filter(function(e){return e in r}).map(function(e){return r[e]}),n,a)})}},{key:"updateProgramFilter",value:function(e){var t=ut(this.state.countries,this.countryStore.selectedCountries),r=ct(this.state.programs,t,e),n=r.countries,a=r.programs,o=this.isExpanded.bind(this,e);this.setState({program_filter:e,filtered_programs:a,filtered_countries:n,flattened_programs:mt(this.state.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),a,o)})}},{key:"changeCountryFilter",value:function(e){this.countryStore.updateSelected(e);var t=ut(this.state.countries,this.countryStore.selectedCountries),r=ct(this.state.programs,t,this.state.program_filter),n=r.countries,a=(r.programs,this.isExpanded.bind(this,this.state.program_filter));this.setState({filtered_countries:n,flattened_programs:mt(this.state.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),this.state.filtered_programs,a)})}},{key:"toggleCountryExpanded",value:function(e){this.countryStore.toggleExpanded(e);var t=ut(this.state.countries,this.countryStore.selectedCountries),r=ct(this.state.programs,t,this.state.program_filter),n=r.countries,a=(r.programs,this.isExpanded.bind(this,this.state.program_filter));this.setState({filtered_countries:n,flattened_programs:mt(this.state.ordered_country_ids.filter(function(e){return e in n}).map(function(e){return n[e]}),this.state.filtered_programs,a)})}},{key:"isExpanded",value:function(e,t){return!!(e&&0<e.length)||this.countryStore.isExpanded(t)}},{key:"render",value:function(){var o=this,e=this.props,t=e.user;e.onSave;return p.a.createElement("div",{className:"tab-pane--react edit-user-programs"},p.a.createElement("h2",{className:"no-bold"},t.name?t.name+": ":"",gettext("Programs and Roles"),p.a.createElement("sup",null,"   ",p.a.createElement("a",{target:"_blank",href:"https://learn.mercycorps.org/index.php/TOLA:Section_05/en#5.4_User_Roles_Matrix_.28Program_Permissions.29"},p.a.createElement("i",{"aria-label":gettext("More information on Program Roles"),className:"far fa-question-circle"})))),p.a.createElement("div",{className:"edit-user-programs__filter-form"},p.a.createElement("div",{className:"edit-user-programs__country-filter form-group react-multiselect-checkbox"},p.a.createElement(Se.a,{placeholder:gettext("Filter countries"),isMulti:!0,value:this.countryStore.selectedOptions,options:this.countryStore.groupedOptions,onChange:function(e){return o.changeCountryFilter(e)}})),p.a.createElement("div",{className:"form-group edit-user-programs__program-filter"},p.a.createElement("div",{className:"input-group"},p.a.createElement("input",{placeholder:gettext("Filter programs"),type:"text",value:this.state.program_filter,className:"form-control",onChange:function(e){return o.updateProgramFilter(e.target.value)}}),p.a.createElement("div",{className:"input-group-append"},p.a.createElement("a",{onClick:function(e){e.preventDefault(),o.clearFilter()}},p.a.createElement("span",{className:"input-group-text"},p.a.createElement("i",{className:"fa fa-times-circle"}))))))),p.a.createElement("div",{className:"virtualized-table__wrapper"},p.a.createElement(Je.a,null,function(e){var t=e.height,r=e.width;return p.a.createElement(Je.f,{height:t,headerHeight:50,width:r,rowGetter:function(e){var t=e.index;return o.state.flattened_programs[t]},rowHeight:50,rowCount:o.state.flattened_programs.length},p.a.createElement(Je.d,{dataKey:"not_applicable_but_required",label:gettext("Has access?"),width:100,cellDataGetter:function(e){var t,r,n,a=e.rowData;return{checked:(r=a,n=o.state.user_program_access,"country"==r.type?n.countries[r.id]&&n.countries[r.id].has_access||!1:!(!o.state.user_program_access.countries[r.country_id]||!o.state.user_program_access.countries[r.country_id].has_access)||n.programs[r.id]&&n.programs[r.id].has_access||!1),disabled:"country"==(t=a).type?!(0<o.state.countries[t.id].programs.size)||!(o.props.store.access.countries[t.id]&&"basic_admin"==o.props.store.access.countries[t.id].role)||o.state.user_program_access.countries[t.id]&&o.state.user_program_access.countries[t.id].has_access:!(!o.state.user_program_access.countries[t.country_id]||!o.state.user_program_access.countries[t.country_id].has_access)||!o.props.store.access.countries[t.country_id]||"basic_admin"!=o.props.store.access.countries[t.country_id].role,id:a.id,type:a.type,expanded:"country"==a.type&&(o.state.program_filter||o.countryStore.isExpanded(a.id)),programsCount:"country"==a.type?a.programs.size:null,action:"country"==a.type?o.toggleAllProgramsForCountry.bind(o):o.toggleProgramAccess.bind(o)}},cellRenderer:function(e){var t=e.cellData;if("country"!=t.type)return p.a.createElement("div",{className:"check-column"},p.a.createElement("input",{type:"checkbox",checked:t.checked,disabled:t.disabled,onChange:function(){return t.action(t.id)}}));var r=lt(o.state.countries[t.id],o.state.filtered_programs,o.state.user_program_access)?gettext("Deselect All"):gettext("Select All"),n=t.disabled||!t.expanded?null:p.a.createElement("a",{className:"edit-user-programs__select-all",onClick:function(){return t.action(t.id)}},r);return p.a.createElement("div",{className:"check-column"},n)}}),p.a.createElement(Je.d,{dataKey:"not_applicable_but_required",label:gettext("Countries and Programs"),width:200,flexGrow:2,className:"pl-0",cellDataGetter:function(e){var t=e.rowData;return{expanded:"country"==t.type&&(o.state.program_filter||o.countryStore.isExpanded(t.id)),programsCount:"country"==t.type?t.programs.size:null,expandoAction:"country"==t.type?o.toggleCountryExpanded.bind(o,t.id):null,bold:"country"==t.type,name:t.name}},cellRenderer:function(e){var t=e.cellData;if(t.bold){var r=t.programsCount?p.a.createElement($e.a,{icon:t.expanded?"caret-down":"caret-right"}):null,n=p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"expando-toggle__icon"},r),p.a.createElement("div",{className:"expando-toggle__label"},p.a.createElement("strong",null,t.name)));return t.programsCount?p.a.createElement("div",{className:"edit-user-programs__expando expando-toggle icon__clickable",onClick:t.expandoAction},n):p.a.createElement("div",{className:"edit-user-programs__expando expando-toggle"},n)}return p.a.createElement("span",null,t.name)}}),p.a.createElement(Je.d,{width:100,flexGrow:1,className:"pl-0",dataKey:"not_applicable_but_required",label:gettext("Roles and Permissions"),cellDataGetter:function(e){var t,r=e.rowData;return{id:r.id,disabled:"country"==(t=r).type?!o.props.store.is_superuser:!(o.props.store.access.countries[t.country_id]&&"basic_admin"==o.props.store.access.countries[t.country_id].role&&(o.state.user_program_access.programs[t.id]&&o.state.user_program_access.programs[t.id].has_access||o.state.user_program_access.countries[t.country_id]&&o.state.user_program_access.countries[t.country_id].has_access)),type:r.type,options:r.options,action:"country"==r.type?o.changeCountryRole.bind(o):o.changeProgramRole.bind(o)}},cellRenderer:function(e){var t=e.cellData;return p.a.createElement("select",{disabled:t.disabled,value:function(e){if("country"==e.type){var t=o.state.user_program_access.countries;return t[e.id]?t[e.id].role:"none"}var r=o.state.user_program_access.programs;return r[e.id]?r[e.id].role:o.props.store.program_role_choices[0].value}(t),onChange:function(e){return t.action(t.id,e.target.value)}},t.options.map(function(e){return p.a.createElement("option",{key:e.value,value:e.value},e.label)}))}}))})),p.a.createElement("div",{className:"form-group btn-row"},p.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return o.saveForm()}},"Save Changes"),p.a.createElement("button",{type:"button",className:"btn btn-reset",onClick:function(){return o.resetForm()}},"Reset")))}}])&&Ye(e.prototype,t),r&&Ye(e,r),s}())||Ge,yt=r("KnAV");function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e,t){return(vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Et(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=Ot(o);return t=i?(e=Ot(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==_t(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wt=[{value:!0,label:gettext("Active")},{value:!1,label:gettext("Inactive")}],jt=Object(xe.c)(pt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vt(e,t)}(a,p.a.Component);var e,t,r,n=Et(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e)).toggleChangeLogRowExpando=function(e){t.props.store.toggleChangeLogRowExpando(e)},t.state={original_user_data:{user:{is_active:e.userData.user.is_active}},user_data:{user:{is_active:e.userData.user.is_active}}},t}return e=a,(t=[{key:"save",value:function(){this.props.onSave(this.state.user_data)}},{key:"onChange",value:function(e){var t=this;this.setState({user_data:{user:{is_active:e.value}}},function(){return t.hasUnsavedDataAction()})}},{key:"onResendRegistrationEmail",value:function(){this.props.onResendRegistrationEmail()}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(this.state.user_data.user.is_active==this.state.user_data.user.is_active)}},{key:"onReset",value:function(){var e=this;this.setState({user_data:this.state.original_user_data},function(){return e.hasUnsavedDataAction()})}},{key:"render",value:function(){var t=this,e=wt.find(function(e){return e.value==t.state.user_data.user.is_active}),r=this.props,n=r.history,a=r.store,o=a.changelog_expanded_rows;return p.a.createElement("div",{className:"edit-user-history"},p.a.createElement("h2",{className:"no-bold"},this.state.user_data.name?this.state.user_data.name+": ":"",gettext("Status and History")),p.a.createElement("div",{className:"form-group"},p.a.createElement("button",{className:"btn btn-secondary",onClick:function(){return t.onResendRegistrationEmail()}},gettext("Resend Registration Email"))),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{className:"label--required",htmlFor:"user-status-input"},gettext("Status")),p.a.createElement(ke.a,{isDisabled:this.props.disabled,options:wt,value:e,id:"user-status-input",onChange:function(e){return t.onChange(e)}})),!this.props.disabled&&p.a.createElement("div",{className:"form-group"},p.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return t.save()}},gettext("Save Changes")),p.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return t.onReset()}},gettext("Reset"))),p.a.createElement(yt.a,{data:n,expanded_rows:o,toggle_expando_cb:function(e){return a.toggleChangeLogRowExpando(e)}}))}}])&&bt(e.prototype,t),r&&bt(e,r),a}())||pt,xt=r("RCjz"),kt=r("DDFe"),St=r("tnXs");function Pt(){return(Pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dt(e,t,r){return t&&At(e.prototype,t),r&&At(e,r),e}function Rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ft(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=It(o);return t=i?(e=It(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==Ct(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ut=gettext("None Selected"),Tt=Object(xe.c)(function(e){var t=e.store,r=e.selections;return p.a.createElement("div",{className:"form-group react-multiselect-checkbox"},p.a.createElement("label",{htmlFor:"users_filter"},gettext("Find a User")),p.a.createElement(Se.a,{value:t.filters.users,options:r,onChange:function(e){return t.changeUserFilter(e)},placeholder:Ut,id:"users_filter"}))}),Lt=Object(xe.c)(function(e){var t=e.store,r=e.selections;return p.a.createElement("div",{className:"form-group react-multiselect-checkbox"},p.a.createElement("label",{htmlFor:"countries_permitted_filter"},gettext("Countries Permitted")),p.a.createElement(Se.a,{value:t.filters.countries,options:r,onChange:function(e){return t.changeCountryFilter(e)},placeholder:Ut,id:"countries_permitted_filter"}))}),Ht=Object(xe.c)(function(e){var t=e.store,r=e.selections;return p.a.createElement("div",{className:"form-group react-multiselect-checkbox"},p.a.createElement("label",{htmlFor:"base_country_filter"},gettext("Base Country")),p.a.createElement(Se.a,{value:t.filters.base_countries,options:r,onChange:function(e){return t.changeBaseCountryFilter(e)},placeholder:Ut,id:"base_country_filter"}))}),Mt=Object(xe.c)(function(e){var t=e.store,r=e.selections;return p.a.createElement("div",{className:"form-group react-multiselect-checkbox"},p.a.createElement("label",{htmlFor:"programs_filter"},gettext("Programs")),p.a.createElement(Se.a,{value:t.filters.programs,options:r,onChange:function(e){return t.changeProgramFilter(e)},placeholder:Ut,id:"programs_filter"}))}),Bt=function(){Rt(n,p.a.Component);var r=Ft(n);function n(e){var t;return Nt(this,n),(t=r.call(this,e)).active_child=p.a.createRef(),t.state={current_action:null,current_vals:[]},t}return Dt(n,[{key:"onActionChanged",value:function(e){this.setState({current_action:e.value,current_vals:[]})}},{key:"onChange",value:function(e){this.setState({current_vals:e})}},{key:"onApply",value:function(){var e=this.props.secondaryOptions[this.state.current_action];e&&e.onApply(this.state.current_vals)}},{key:"render",value:function(){var t=this,e=this.props.secondaryOptions[this.state.current_action],r=e&&e.component,n=!this.state.current_action||Array.isArray(this.state.current_vals)&&!this.state.current_vals.length||!this.state.current_vals;return p.a.createElement("div",{className:"controls__bulk-actions"},p.a.createElement("div",{className:"bulk__select"},p.a.createElement(ke.a,{placeholder:gettext("Bulk Actions"),value:this.props.primaryOptions.find(function(e){return e.value==t.state.current_action}),options:this.props.primaryOptions,onChange:function(e){return t.onActionChanged(e)}})),e&&p.a.createElement("div",{className:"bulk__select"},p.a.createElement(r,{placeholder:gettext("Select..."),value:this.state.current_vals,onChange:function(e){return t.onChange(e)}})),!e&&p.a.createElement("div",{className:"bulk__select"},p.a.createElement(ke.a,{placeholder:"---",noOptionsMessage:function(){return gettext("No options")}})),p.a.createElement("button",{className:"btn btn-secondary",disabled:n,onClick:function(){return t.onApply()}},gettext("Apply")))}}]),n}(),qt=Object(xe.c)(function(e){var a=e.store,t=(a.program_selections,{primary_options:[{label:gettext("Set account status"),value:"set_account_status"},{label:gettext("Add to program"),value:"add_to_program"},{label:gettext("Remove from program"),value:"remove_from_program"}],secondary_options:{set_account_status:{component:function(e){return p.a.createElement(ke.a,Pt({options:a.user_status_options},e))},onApply:function(e){return a.bulkUpdateUserStatus(e.value)}},add_to_program:{component:function(e){return p.a.createElement(Se.a,Pt({options:a.program_bulk_selections},e))},onApply:function(e){return a.bulkAddPrograms(e.map(function(e){return e.value}))}},remove_from_program:{component:function(e){return p.a.createElement(Se.a,Pt({options:a.program_bulk_selections},e))},onApply:function(e){return a.bulkRemovePrograms(e.map(function(e){return e.value}))}}}});return p.a.createElement("div",{id:"user-management-index-view",className:"row"},p.a.createElement(St.a,null,p.a.createElement("div",{className:"filter-section"},p.a.createElement(Lt,{store:a,selections:a.countries_selections}),p.a.createElement(Ht,{store:a,selections:a.countries_selections}),p.a.createElement(Mt,{store:a,selections:a.program_selections}),p.a.createElement("div",{className:"form-group react-multiselect-checkbox"},p.a.createElement("label",{htmlFor:"organization_filter"},gettext("Organization")),p.a.createElement(Se.a,{value:a.filters.organizations,options:a.organization_selections,onChange:function(e){return a.changeOrganizationFilter(e)},placeholder:Ut,id:"organization_filter"})),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{htmlFor:"status_filter"},gettext("Status")),p.a.createElement(ke.a,{value:a.filters.user_status,options:a.user_status_options,onChange:function(e){return a.changeUserStatusFilter(e)},placeholder:Ut,id:"status_filter"})),p.a.createElement("div",{className:"form-group"},p.a.createElement("label",{htmlFor:"admin_role_filter"},gettext("Administrator?")),p.a.createElement(ke.a,{value:a.filters.admin_role,options:a.admin_role_options,onChange:function(e){return a.changeAdminRoleFilter(e)},placeholder:Ut,id:"admin_role_filter"}))),p.a.createElement("div",{className:"filter-section filter-buttons"},p.a.createElement("button",{className:"btn btn-primary",onClick:function(){return a.applyFilters()}},gettext("Apply")),p.a.createElement("button",{className:"btn btn-reset",onClick:function(){return a.clearFilters()}},gettext("Reset")))),p.a.createElement("div",{className:"col admin-list"},p.a.createElement("header",{className:"page-title"},p.a.createElement("h1",null,gettext("Admin:")," ",p.a.createElement("small",null,gettext("Users")))),p.a.createElement("div",{className:"admin-list__controls"},p.a.createElement(Bt,{primaryOptions:t.primary_options,secondaryOptions:t.secondary_options}),p.a.createElement("div",{className:"controls__buttons"},p.a.createElement("a",{href:"#",tabIndex:"0",className:"btn btn-link btn-add",onClick:function(){return a.createUser()}},p.a.createElement("i",{className:"fas fa-plus-circle"}),gettext("Add user")))),p.a.createElement("div",{className:"admin-list__top-filter"},p.a.createElement(Tt,{store:a,selections:a.user_selections})),p.a.createElement(kt.a,{isLoading:a.fetching_users_listing||a.applying_bulk_updates},p.a.createElement("div",{className:"admin-list__table"},p.a.createElement(Pe.a,{data:a.users_listing.map(function(e){return a.users[e]}),keyField:"id",HeaderRow:function(e){var t=e.Col,r=e.Row;return p.a.createElement(r,null,p.a.createElement(t,{size:"0.5"},p.a.createElement("input",{type:"checkbox",checked:a.bulk_targets_all,onChange:function(){return a.toggleBulkTargetsAll()}})),p.a.createElement(t,{size:"2",className:"td--stretch"},gettext("User")),p.a.createElement(t,null,gettext("Organization")),p.a.createElement(t,null,gettext("Programs")),p.a.createElement(t,{size:"0.25"},gettext("Status")))},Row:function(e){var t=e.Col,r=e.Row,n=e.data;return p.a.createElement(r,{expanded:n.id==a.editing_target,Expando:Object(xe.c)(function(e){var t=e.Wrapper;return p.a.createElement(t,null,p.a.createElement(Fe,{notifyPaneChange:function(e){return a.onProfilePaneChange(e)},new:"new"==n.id,active_pane:a.active_editor_pane,ProfileSection:Object(xe.c)(function(){return p.a.createElement(kt.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},p.a.createElement(We,{disabled:1==n.organization_id&&!a.is_superuser&&"new"!=n.id,is_superuser:a.is_superuser,new:"new"==n.id,userData:a.editing_target_data.profile,errors:a.editing_errors,key:a.editing_target_data.profile.id,onUpdate:function(e){return a.updateUserProfile(n.id,e)},onCreate:function(e){return a.saveNewUser(e)},onCreateAndAddAnother:function(e){return a.saveNewUserAndAddAnother(e)},organizations:a.organization_selections,onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))}),ProgramSection:Object(xe.c)(function(){return p.a.createElement(kt.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},p.a.createElement(ht,{store:a,user:n,adminUserProgramRoles:a.access.program,adminUserCountryRoles:a.access.countries,onSave:function(e){return a.saveUserPrograms(n.id,e)},onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))}),HistorySection:Object(xe.c)(function(){return p.a.createElement(kt.a,{isLoading:a.fetching_editing_target||a.saving_user_profile||a.saving_user_programs},p.a.createElement(jt,{store:a,disabled:1==n.organization_id&&!a.is_superuser,userData:a.editing_target_data.profile,history:a.editing_target_data.history,onResendRegistrationEmail:function(){return a.resendRegistrationEmail(n.id)},onSave:function(e){return a.updateUserIsActive(n.id,e)},onIsDirtyChange:function(e){return a.setActiveFormIsDirty(e)}}))})}))})},p.a.createElement(t,{size:"0.5"},p.a.createElement("input",{type:"checkbox",checked:a.bulk_targets.get(n.id)||!1,onChange:function(){return a.toggleBulkTarget(n.id)}})),p.a.createElement(t,{size:"2",className:"td--stretch"},p.a.createElement("div",{className:"expando-toggle icon__clickable",onClick:function(){return a.toggleEditingTarget(n.id)}},p.a.createElement("div",{className:"expando-toggle__icon"},p.a.createElement($e.a,{icon:a.editing_target==n.id?"caret-down":"caret-right"})),p.a.createElement("div",{className:"expando-toggle__label"},p.a.createElement("i",{className:"fas fa-user"}),"",n.name||"---"," ",n.is_super&&p.a.createElement("span",{className:"badge badge-danger"},gettext("Super Admin"))))),p.a.createElement(t,null,p.a.createElement("i",{className:"fas fa-building"}),"",n.organization_name||"---"),p.a.createElement(t,{className:"text-nowrap"},n.user_programs?p.a.createElement("a",{href:"/tola_management/program/?users[]=".concat(n.id)},p.a.createElement("i",{className:"fas fa-cubes"}),"",interpolate(ngettext("%s program","%s programs",n.user_programs),[n.user_programs])):p.a.createElement("span",null,p.a.createElement("i",{className:"fas fa-cubes"}),"",gettext("0 programs"))),p.a.createElement(t,{size:"0.25"},n.is_active?gettext("Active"):gettext("Inactive")))}}))),p.a.createElement("div",{className:"admin-list__metadata"},p.a.createElement("div",{className:"metadata__count text-muted text-small"},a.users_count?"".concat(a.users_count," ").concat(gettext("users")):"--"),p.a.createElement("div",{className:"metadata__controls"},a.total_pages&&p.a.createElement(xt.a,{pageCount:a.total_pages,initialPage:a.current_page,onPageChange:function(e){return a.changePage(e)}})))))}),Vt=new we(jsContext);o.a.render(p.a.createElement(qt,{store:Vt}),document.querySelector("#app_root"))},DDFe:function(e,t,r){"use strict";var n=r("q1tI"),i=r.n(n);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}t.a=function(e){var t=e.children,r=e.isLoading,n=e.className,a=c(e,["children","isLoading","className"]),o=r?"loading":"";return i.a.createElement("div",s({className:"loading-spinner__container "+o+" "+(n||"")},a),i.a.createElement("div",{className:"loading-spinner__overlay"},i.a.createElement("div",{className:"loading-spinner__spinner"})),t)}},KnAV:function(e,t,r){"use strict";var n=r("q1tI"),u=r.n(n),a=r("okNM"),o=r("IP2g"),c=(r("2vnA"),r("v38i"));function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e){var t=e.name,r=e.data,n=e.extraTitleText,a=void 0===n?null:n,o=a?u.a.createElement("h4",{className:"disagg-type__title, text-small"},a):null;if("Disaggregation categories"===t&&"object"===p(r)&&null!==r){var i=Object.values(r).sort(function(e,t){return e.custom_sort-t.custom_sort});return u.a.createElement(u.a.Fragment,null,u.a.createElement("strong",null,t,": "),o,u.a.createElement("ul",{className:"no-list-style"},i.map(function(e,t){return u.a.createElement("li",{key:t},void 0!==e.label&&null!==e.label?e.label:"")})))}var s=null!=r&&"N/A"!==r?u.a.createElement("span",{className:"change__field__value"},["true","false"].includes(r.toString())?r.toString().replace("t","T").replace("f","F"):r.toString()):u.a.createElement("span",{className:"change__field__value empty-value"},c.c);return u.a.createElement("div",{className:"change__field"},u.a.createElement("strong",{className:"change__field__name"},t),": ",s)}function s(e){var t=e.data,r=e.is_expanded,n=e.toggle_expando_cb;return u.a.createElement("tr",{className:r?"changelog__entry__header is-expanded":"changelog__entry__header",onClick:function(){return n(t.id)}},u.a.createElement("td",{className:"text-nowrap text-action"},u.a.createElement(o.a,{icon:r?"caret-down":"caret-right"}),"",u.a.createElement("strong",null,t.date)),u.a.createElement("td",{className:"text-nowrap"},t.admin_user),u.a.createElement("td",{className:"text-nowrap"},t.pretty_change_type),u.a.createElement("td",null),u.a.createElement("td",null))}function d(e){return u.a.createElement("tr",{key:e.id,className:"changelog__entry__row"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null,u.a.createElement("div",{className:"changelog__change--prev"},e.previous)),u.a.createElement("td",null,u.a.createElement("div",{className:"changelog__change--new"},e.new)))}function m(e){var t,r,o,i,n,a=e.data,s=[],c=u.a.createElement(d,{previous:gettext("No differences found"),new:null,id:1,key:1});return Array.isArray(a.diff_list)&&0===a.diff_list.length||0===Object.keys(a.diff_list||{}).length?s.push(c):("user_programs_updated"===a.change_type?(a.diff_list.base_country&&(t=u.a.createElement(f,{name:a.diff_list.base_country.pretty_name,data:a.diff_list.base_country.prev}),r=u.a.createElement(f,{name:a.diff_list.base_country.pretty_name,data:a.diff_list.base_country.new}),s.push(u.a.createElement(d,{previous:t,new:r,id:"base_country",key:"base_country"}))),Object.entries(a.diff_list.countries).forEach(function(e){var t=l(e,2),r=t[0],n=t[1],a="".concat(r,"_").concat(n),o=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{name:gettext("Country"),data:n.prev.country}),u.a.createElement(f,{name:gettext("Role"),data:n.prev.role})),i=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{name:gettext("Country"),data:n.new.country}),u.a.createElement(f,{name:gettext("Role"),data:n.new.role}));s.push(u.a.createElement(d,{previous:o,new:i,id:a,key:a}))}),Object.entries(a.diff_list.programs).forEach(function(e){var t=l(e,2),r=t[0],n=t[1],a="".concat(r,"_").concat(n),o=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{name:gettext("Program"),data:n.prev.program}),u.a.createElement(f,{name:gettext("Country"),data:n.prev.country}),u.a.createElement(f,{name:gettext("Role"),data:n.prev.role})),i=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{name:gettext("Program"),data:n.new.program}),u.a.createElement(f,{name:gettext("Country"),data:n.new.country}),u.a.createElement(f,{name:gettext("Role"),data:n.new.role}));s.push(u.a.createElement(d,{previous:o,new:i,id:a,key:a}))})):(o=null,i=!1,"Country disaggregation updated"!==a.pretty_change_type||(n=a.diff_list.filter(function(e){return"disaggregation_type"===e.name}))[0].prev===n[0].new&&(o=n[0].prev,i=!0),a.diff_list.forEach(function(e,t){var r,n,a="".concat(t,"_").concat(e.pretty_name);"disaggregation_type"===e.name&&i||(r=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{key:t,name:e.pretty_name,data:e.prev,id:t,extraTitleText:o})),n=u.a.createElement(u.a.Fragment,null,u.a.createElement(f,{key:t,name:e.pretty_name,data:e.new,id:t,extraTitleText:o})),s.push(u.a.createElement(d,{previous:r,new:n,id:a,key:a})))})),0===s.length&&s.push(c)),s}function g(e){var t=e.data,r=e.is_expanded,n=e.toggle_expando_cb;return u.a.createElement("tbody",{className:"changelog__entry",key:t.id},u.a.createElement(s,{data:t,is_expanded:r,toggle_expando_cb:n}),r&&u.a.createElement(m,{data:t}))}var h=Object(a.c)(function(e){var t=e.data,r=e.expanded_rows,n=e.toggle_expando_cb;return u.a.createElement("table",{className:"table table-sm bg-white table-bordered text-small changelog"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",{className:"text-nowrap"},gettext("Date")),u.a.createElement("th",{className:"text-nowrap"},gettext("Admin")),u.a.createElement("th",{className:"text-nowrap"},gettext("Change Type")),u.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("Previous Entry")),u.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("New Entry")))),t.map(function(e){var t=!0;return r&&(t=r.has(e.id)),u.a.createElement(g,{key:e.id,data:e,is_expanded:t,toggle_expando_cb:n})}))});t.a=h},RCjz:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),o=r("I+5a"),i=r.n(o);r("okNM");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}t.a=function(e){return a.a.createElement(i.a,s({previousLabel:"",previousClassName:"page-item previous",previousLinkClassName:"page-link",nextLabel:"",nextClassName:"page-item next",nextLinkClassName:"page-link",breakLabel:"...",disabledClassName:"disabled",breakClassName:"page-item disabled",breakLinkClassName:"page-link",pageClassName:"page-item",pageLinkClassName:"page-link",marginPagesDisplayed:2,pageRangeDisplayed:5,containerClassName:"pagination",activeClassName:"active"},e))}},TGVD:function(e,t,r){"use strict";var i=r("okNM"),n=r("q1tI"),s=r.n(n),a=r("TSYQ"),c=r.n(a);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function o(e){var t=e.className,r=(e.size,l(e,["className","size"]));return s.a.createElement("td",u({className:["mgmt-table__col",t].join(" ")},r),r.children)}function p(e){var t=e.className,r=e.size,n=l(e,["className","size"]);return s.a.createElement("th",u({className:["mgmt-table__col","mgmt-table__col__width-".concat(r),t].join(" ")},n),n.children)}function f(e){var t=e.className,r=l(e,["className"]);return s.a.createElement("tr",u({className:["mgmt-table__row",t].join(" ")},r),r.children)}function d(e){var t=e.className,r=l(e,["className"]);return s.a.createElement("tr",u({className:["mgmt-table__row table-header",t].join(" ")},r),r.children)}var m=Object(i.c)(function(e){var t=e.className,r=e.expanded,n=e.Expando,a=l(e,["className","expanded","Expando"]);if(n){var o=Object(i.c)(n);return s.a.createElement("tbody",u({className:c()(["mgmt-table__body",t].join(" "),{"is-expanded":r})},a),s.a.createElement(f,null,a.children),r&&s.a.createElement(o,{Wrapper:g}))}return s.a.createElement("tbody",u({className:["mgmt-table__body",t].join(" ")},a),s.a.createElement(f,null,a.children))}),g=function(e){var t=e.className,r=l(e,["className"]);return s.a.createElement("tr",u({className:["mgmt-table__row--expanded",t].join(" ")},r),s.a.createElement("td",{colSpan:"5"},r.children))},h=Object(i.c)(function(e){var t=e.data,r=e.Row,n=e.keyField,a=(l(e,["data","Row","keyField"]),Object(i.c)(r));return t.map(function(e){return s.a.createElement(a,{key:e[n],data:e,Col:o,Row:m})})}),y=Object(i.c)(function(e){var t=e.HeaderRow,r=e.className,n=l(e,["HeaderRow","className"]),a=Object(i.c)(t);return s.a.createElement("table",{className:["table bg-white",r].join(" ")},s.a.createElement("thead",null,s.a.createElement(a,{Col:p,Row:d})),s.a.createElement(h,n))});t.a=y},"WtQ/":function(e,t,r){"use strict";r.d(t,"c",function(){return n}),r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o}),r.d(t,"d",function(){return i});function n(){$(function(){var e=0===window.performance.getEntriesByType("navigation")[0].transferSize,t="reload"===window.performance.getEntriesByType("navigation")[0].type;e&&!t&&window.location.reload()})}var a=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t,r=e.toString(),n=null;switch(e.toString().includes(",")?(r=e.toString().split(",")[0],n=1<e.toString().split(",").length?e.toString().split(",")[1]:null):e.toString().includes(".")&&(r=e.toString().split(".")[0],n=1<e.toString().split(".").length?e.toString().split(".")[1]:null),n=n&&0<n.length?n:null,window.userLang){case"es":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,"."),n&&(t+=",".concat(n));break;case"fr":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,String.fromCharCode(160)),n&&(t+=",".concat(n));break;case"en":default:t=r.replace(/\B(?=(\d{3})+(?!\d))/g,","),n&&(t+=".".concat(n))}return t},o=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t=a(Math.round(1e4*e)/100);return null===t?null:"".concat(t,"%")},i=function(e,t){var r=1<arguments.length&&void 0!==t?t:"label";return e.sort(function(e,t){return e[r].toUpperCase()>t[r].toUpperCase()?1:-1})}},XoI5:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("vDqi"),a=r.n(n).a.create({withCredentials:!0,baseURL:"/api/",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")}})},Z2Y6:function(e,t,r){"use strict";var n=r("q1tI"),s=r.n(n),c=r("c7k8");r("Cs6D");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=p(o);return t=i?(e=p(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var a,f=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(a,s.a.PureComponent);var e,t,r,n=l(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e)).cache=new c.c({fixedWidth:!0,defaultHeight:35}),t.filter_val="",t}return e=a,(t=[{key:"render",value:function(){var o=this,e=this.props,i=(e.options,e.children),t=e.maxHeight,r=(e.getValue,e.selectProps),n=i.length||0;return r.inputValue!==this.filter_val&&(this.filter_val=r.inputValue,this.cache.clearAll()),s.a.createElement("div",{style:{display:"flex",height:"100vh",maxHeight:t+"px"}},s.a.createElement("div",{style:{flex:"1 1 auto"}},s.a.createElement(c.a,null,function(e){var t=e.width,r=e.height;return s.a.createElement(c.e,{height:r,width:t,deferredMeasurementCache:o.cache,rowCount:n,rowHeight:o.cache.rowHeight,noRowsRenderer:function(){return s.a.createElement("div",null,"No selections available")},rowRenderer:function(e){var t=e.index,r=e.parent,n=e.key,a=e.style;return s.a.createElement(c.b,{key:n,cache:o.cache,parent:r,columnIndex:0,rowIndex:t},s.a.createElement("div",{style:a},i[t]))}})})))}}])&&o(e.prototype,t),r&&o(e,r),a}(),d=r("VCnP"),m=r.n(d),g=r("oary"),h=r.n(g),y=r("PAeb"),_=r("okNM");function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=j(o);return t=i?(e=j(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==b(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function k(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?x(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):x(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}var S=function(e){return s.a.createElement("div",{className:"count__label"},e.children,e.clearable&&s.a.createElement("div",{onClick:e.clearSelect},s.a.createElement("i",{className:"fa fa-times","aria-hidden":"true"})))};function P(e){if(!1!==e.data.selectable)return!0===e.data.divider?s.a.createElement(s.a.Fragment,null,s.a.createElement("hr",{style:{margin:"3px 0px 0px 0px"}}),s.a.createElement(h.a,e)):s.a.createElement(h.a,e);e.children;var t=e.className,r=e.cx,n=e.getStyles,a=(e.Heading,e.setValue,e.data,e.label,e.getValue,e.theme),o=(e.selectProps.getOptionValue,{getStyles:n,cx:r,theme:a,indeterminate:!1,checked:!1});return s.a.createElement("div",{className:r(Object(y.css)(n("group",e)),{group:!0},t)},s.a.createElement("div",{className:r(Object(y.css)(n("groupHeading",k({},o))),{"group-heading":!0},t)},e.data.label),s.a.createElement("div",null,e.children))}var C=Object(_.c)(a=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(o,s.a.Component);var e,t,r,n=w(o);function o(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=n.call(this,e)).clearSelect=function(e){e.stopPropagation(),a.props.onChange([])},a.makeLabel=function(e){var t=e.placeholderButtonLabel,r=e.value;if(!r)return s.a.createElement(S,{clearable:!1},t);if(Array.isArray(r)){var n=r.filter(function(e){return!e.noList});return 0===n.length?s.a.createElement(S,{clearable:!1},t):1===n.length?s.a.createElement(S,{clearable:!0,clearSelect:a.clearSelect},n[0].label):s.a.createElement(S,{clearable:!0,clearSelect:a.clearSelect},"".concat(n.length," ",gettext("selected")))}return s.a.createElement(S,{clearable:!1},r.label)},a}return e=o,(t=[{key:"render",value:function(){return s.a.createElement(m.a,v({},this.props,{placeholder:gettext("Search"),placeholderButtonLabel:this.props.placeholder,getDropdownButtonLabel:this.makeLabel,components:{MenuList:f,Group:P}}))}}])&&E(e.prototype,t),r&&E(e,r),o}())||a;t.a=C},tnXs:function(e,t,r){"use strict";var n=r("q1tI"),s=r.n(n);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(o){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,a=f(o);return t=i?(e=f(this).constructor,Reflect.construct(a,arguments,e)):a.apply(this,arguments),r=this,!(n=t)||"object"!==c(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var a=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(a,s.a.Component);var e,t,r,n=p(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e)).updateDimensions=function(){t.state.folded||t.state.folding||t.setState(function(){return{resize:!0}},function(){t.contentWidth=t.contentsContainer.current.offsetWidth,t.setState({resize:!1})})},t.state={folding:!1,folded:!1,resize:!1},t.contentsContainer=s.a.createRef(),t}return e=a,(t=[{key:"componentDidMount",value:function(){this.contentWidth=this.contentsContainer.current.offsetWidth,window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"toggleFolded",value:function(){this.state.folding?this.foldComplete():this.setState({folding:!0,folded:!this.state.folded})}},{key:"foldComplete",value:function(){this.setState(function(){return{folding:!1}},this.updateDimensions)}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,n=l(t,["className"]),a=this.state.folded?this.state.folding?"fa-angle-double-left":"fa-chevron-right":this.state.folding?"fa-angle-double-right":"fa-chevron-left",o=this.state.folded?"0px":this.state.resize?"auto":this.contentWidth+"px",i=this.state.folded||this.state.folding?"hidden":"visible";return s.a.createElement("div",u({className:"folding-sidebar "+(r||"")},n),s.a.createElement("div",{className:"folding-sidebar__contents",onTransitionEnd:function(){return e.foldComplete()},ref:this.contentsContainer,style:{width:o,overflow:i}},s.a.createElement(s.a.Fragment,null,this.props.children)),s.a.createElement("div",{className:"folding-sidebar__trigger",onClick:function(){return e.toggleFolded()}},s.a.createElement("i",{key:a},s.a.createElement("span",{className:"fa "+a}))))}}])&&o(e.prototype,t),r&&o(e,r),a}();t.a=a},v38i:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return a}),r.d(t,"b",function(){return i}),r.d(t,"c",function(){return o}),r.d(t,"l",function(){return s}),r.d(t,"i",function(){return c}),r.d(t,"k",function(){return u}),r.d(t,"f",function(){return l}),r.d(t,"m",function(){return p}),r.d(t,"j",function(){return f}),r.d(t,"d",function(){return d}),r.d(t,"e",function(){return m}),r.d(t,"g",function(){return h}),r.d(t,"h",function(){return y});var a={value:null,label:"---------"},o="",i=o,s=1,c=2,u=[3,4,5,6,7],l=[1,2],p=Object.freeze({1:gettext("Life of Program (LoP) only"),2:gettext("Midline and endline"),3:gettext("Annual"),4:gettext("Semi-annual"),5:gettext("Tri-annual"),6:gettext("Quarterly"),7:gettext("Monthly")}),f=Object.freeze({3:gettext("Years"),4:gettext("Semi-annual periods"),5:gettext("Tri-annual periods"),6:gettext("Quarters"),7:gettext("Months")}),d=1,m=2;var g,h=Object.freeze({noFilter:0,missingTarget:1,missingResults:2,missingEvidence:3,aboveTarget:5,belowTarget:6,onTarget:7,nonReporting:8}),y=null!==(g="reason_for_change_options",n="undefined"!=typeof JS_GLOBALS&&JS_GLOBALS.hasOwnProperty(g)?JS_GLOBALS[g]:null)&&void 0!==n?n:[]}},[["9KAa",0,1]]]);
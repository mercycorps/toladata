(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"1d5Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return p}));var n=r("2vnA"),a=r("5/4V");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l="undefined"!=typeof gettext?gettext:function(e){return e},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pk:parseInt(e.pk),name:e.name,resultsFramework:Boolean(e.results_framework),_resultChainFilterLabel:e.by_result_chain||l("by Outcome chain"),get resultChainFilterLabel(){return this.resultsFramework?this._resultChainFilterLabel:null}}},s=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[c].concat(t).reduce((function(t,r){return Object(n.i)(t,r(e))}),{})}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{reportingPeriodStart:new Date(e.reporting_period_start_iso),reportingPeriodEnd:new Date(e.reporting_period_end_iso)}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_indicatorsLevelOrder:Object(n.n)(e.indicator_pks_level_order||[]),_indicatorsChainOrder:Object(n.n)(e.indicator_pks_chain_order||[]),_applyOrderUpdate:function(e){var t=this;Object(n.p)((function(){return t._indicatorsLevelOrder=e.indicator_pks_level_order||[],t._indicatorsChainOrder=e.indicator_pks_chain_order||[],Object.entries(e.indicators||{}).forEach((function(e){var r=i(e,2),n=r[0],a=r[1];!isNaN(parseInt(n))&&t.indicators.has(parseInt(n))&&t.indicators.get(parseInt(n)).updateData(a)})),e}))},updateOrder:function(){return a.a.programLevelOrdering(this.pk).then(this._applyOrderUpdate.bind(this))},get indicatorsInLevelOrder(){var e=this;return this._indicatorsLevelOrder.map((function(t){return e.indicators.get(t)}))},get indicatorsInChainOrder(){var e=this;return this.hasOwnProperty("resultsFramework")&&!1===this.resultsFramework?this.indicatorsInLevelOrder:this._indicatorsChainOrder.map((function(t){return e.indicators.get(t)}))}}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_levelsLevelOrder:Object(n.n)(e.level_pks_level_order||[]),_levelsChainOrder:Object(n.n)(e.level_pks_chain_order||[]),_unassignedIndicators:Object(n.n)(e.unassigned_indicator_pks||[]),levelIndicators:Object(n.n)(new Map((e.indicator_pks_for_level||[]).map((function(e){return[e.pk,e.indicator_pks]})))),updateOrder:function(){var e=this;return a.a.rfLevelOrdering(this.pk).then((function(t){Object(n.p)((function(){return e._levelsLevelOrder=t.level_pks_level_order||[],e._levelsChainOrder=t.level_pks_chain_order||[],e._unassignedIndicators=t.unassigned_indicator_pks||[],e._updateLevelIndicatorsOrder(t.indicator_pks_for_level),!0}))}))},get levelsInLevelOrder(){var e=this;return this._levelsLevelOrder.map((function(t){return e.levels.get(t)}))||[]},get levelsInChainOrder(){var e=this;return this.hasOwnProperty("resultsFramework")&&!1===this.resultsFramework?this.levelsInLevelOrder:this._levelsChainOrder.map((function(t){return e.levels.get(t)}))||[]},get unassignedIndicators(){var e=this;return this._unassignedIndicators.map((function(t){return e.indicators.get(t)}))||[]},get indicatorsInLevelOrder(){var e=this;return this.resultsFramework?Array.prototype.concat.apply([],this.levelsInLevelOrder.map((function(t){return e.levelIndicators.get(t.pk).filter((function(t){return e.indicators.has(t)})).map((function(t){return e.indicators.get(t)}))}))).concat(this.unassignedIndicators):this.unassignedIndicators},get indicatorsInChainOrder(){var e=this;return this.resultsFramework?Array.prototype.concat.apply([],this.levelsInChainOrder.map((function(t){return e.levelIndicators.get(t.pk).filter((function(t){return e.indicators.has(t)})).map((function(t){return e.indicators.get(t)}))}))).concat(this.unassignedIndicators):this.unassignedIndicators},_updateLevelIndicatorsOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(n.p)((function(){e.levelIndicators.clear(),t.forEach((function(t){var r=t.pk,n=t.indicator_pks;e.levelIndicators.set(r,n)}))}))}}}},"5/4V":function(e,t,r){"use strict";var n=r("vDqi"),a=r.n(n),i=r("Qyje"),o=r.n(i),l={apiInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"json",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")}}),documentInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"document",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")},transformResponse:[function(e){return(new XMLSerializer).serializeToString(e)}]}),formPostInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"json",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),"content-type":"application/x-www-form-urlencoded"}}),logFailure:function(e){console.log("api call failed:",e)},getProgramPageUrl:function(e){return!isNaN(parseInt(e))&&"/program/".concat(e,"/")},programLevelOrdering:function(e){return this.apiInstance.get("/program/ordering/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},rfLevelOrdering:function(e){return this.apiInstance.get("/program/level_ordering/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},indicatorResultsTable:function(e,t){return this.documentInstance.get("/result_table/".concat(e,"/"),{params:{raw:!0,edit:t}}).then((function(e){return e.data})).catch(this.logFailure)},updateProgramPageIndicator:function(e){return this.apiInstance.get("/program_page/indicator/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},updateAllProgramPageIndicators:function(e){return this.apiInstance.get("/program_page/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},ipttFilterData:function(e){return this.apiInstance.get("/iptt/".concat(e,"/filter_data/")).then((function(e){return e.data})).catch(this.logFailure)},getIPTTReportData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.programPk,r=e.frequency,n=e.reportType;return this.apiInstance.get("/iptt/".concat(t,"/report_data/"),{params:{frequency:r,report_type:n}}).then((function(e){return e.data})).catch(this.logFailure)},savePinnedReport:function(e){return this.formPostInstance.post("/pinned_report/",o.a.stringify(e)).catch(this.logFailure)},updateIPTTIndicator:function(e){return this.apiInstance.get("/iptt/indicator/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)}};t.a=l},LBcr:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l}));var n=window.userLang,a="numeric",i={year:a,month:"short",day:a};function o(e){return new Date(e)}function l(e){return new Intl.DateTimeFormat(n,i).format(e)}},"My+N":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r("2vnA"),a=r("NHe6"),i=r("v38i"),o=("undefined"!=typeof gettext&&gettext,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pk:parseInt(e.pk),name:e.name,levelPk:!isNaN(parseInt(e.level_pk))&&parseInt(e.level_pk),oldLevelDisplay:e.old_level_name||!1,meansOfVerification:e.means_of_verification||!1}}),l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return[o].concat(t).reduce((function(t,r){return Object(n.i)(t,r(e))}),{})}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_formatDecimal:a.a,frequency:parseInt(e.target_frequency),get timeAware(){return i.k.includes(this.frequency)},unitOfMeasure:e.unit_of_measure||!1,isPercent:Boolean(e.is_percent),isCumulative:Boolean(e.is_cumulative),directionOfChange:e.direction_of_change||!1,baseline:e.baseline||null,_lopTarget:e.lop_target||null,_lopActual:e.lop_actual||null,_lopMet:e.lop_met||null,_lopTargetProgress:e.lop_target_progress||null,_lopActualProgress:e.lop_actual_progress||null,_lopMetProgress:e.lop_met_progress||null,get lopTarget(){return this._formatDecimal(this._lopTarget)},get lopActual(){return this._formatDecimal(this._lopActual)},get lopMet(){return this._formatDecimal(this._lopMet)},get lopTargetProgress(){return this._formatDecimal(this._lopTargetProgress)},get lopActualProgress(){return this._formatDecimal(this._lopActualProgress)},get lopMetProgress(){return this._formatDecimal(this._lopMetProgress)}}}},NHe6:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return!isNaN(parseFloat(e))&&(e=parseFloat(e),Number.isInteger(e)?parseInt(e):e)}},"WtQ/":function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return o}));function n(){$((function(){var e=0===window.performance.getEntriesByType("navigation")[0].transferSize,t="reload"===window.performance.getEntriesByType("navigation")[0].type;e&&!t&&window.location.reload()}))}var a=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t,r=e.toString(),n=null;switch(e.toString().includes(",")?(r=e.toString().split(",")[0],n=e.toString().split(",").length>1?e.toString().split(",")[1]:null):e.toString().includes(".")&&(r=e.toString().split(".")[0],n=e.toString().split(".").length>1?e.toString().split(".")[1]:null),n=n&&n.length>0?n:null,window.userLang){case"es":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,"."),n&&(t+=",".concat(n));break;case"fr":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,String.fromCharCode(160)),n&&(t+=",".concat(n));break;case"en":default:t=r.replace(/\B(?=(\d{3})+(?!\d))/g,","),n&&(t+=".".concat(n))}return t},i=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t=a(Math.round(1e4*e)/100);return null===t?null:"".concat(t,"%")},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label";return e.sort((function(e,r){return e[t].toUpperCase()>r[t].toUpperCase()?1:-1}))}},aJgA:function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),a=r.n(n),i=r("i8i4"),o=r.n(i),l=r("qtBC"),c=r("wgi2"),s=r("0pHI"),u=r("TSYQ"),d=r.n(u),p=r("okNM"),g=r("hzyr"),f=r("IP2g"),m=r("wHSu"),h=r("WtQ/"),v=r("v38i");function b(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e,t,r){return t&&E(e.prototype,t),r&&E(e,r),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=x(e);if(t){var a=x(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return N(this,r)}}function N(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S,T,j,C=gettext("N/A"),P=a.a.createContext(h.a),R=function(e){O(r,e);var t=w(r);function r(){return _(this,r),t.apply(this,arguments)}return I(r,[{key:"componentDidMount",value:function(){$('*[data-toggle="popover"]').popover({html:!0})}},{key:"render",value:function(){var e,t,r,n=Object(h.b)(this.props.val);r=interpolate(gettext("<p><strong>The actual value is %(percent)s of the target value.</strong> An indicator is on track if the result is no less than 85% of the target and no more than 115% of the target.</p><p><em>Remember to consider your direction of change when thinking about whether the indicator is on track.</em></p>"),{percent:n},!0),n&&this.props.val>.85&&this.props.val<1.15?(e="badge-success-light",t=gettext("On track")):(e="badge-warning-light",t=gettext("Not on track"));var i='<h4 class="badge '.concat(e,'">').concat(t,"</h4>").concat(r);return a.a.createElement("strong",null,a.a.createElement("span",{tabIndex:"0",className:"badge ".concat(e),"data-toggle":"popover","data-placement":"right","data-trigger":"focus","data-content":i},n))}}]),r}(a.a.Component),F=function(e){var t=e.result,r=e.noTarget,i=(b(e,["result","noTarget"]),Object(n.useContext)(P)),o=r?" bg-danger-lighter":"";return a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"results__result--date ".concat(o)},a.a.createElement("a",{href:"/indicators/result_update/".concat(t.pk,"/"),className:"results__link"},t.dateCollected)),a.a.createElement("td",{className:"results__result--value ".concat(o)},i(t.achieved)),a.a.createElement("td",{className:"td--stretch results__result--url"},t.evidenceUrl&&a.a.createElement("a",{href:t.evidenceUrl,target:"_blank"},t.recordName||t.evidenceUrl)))},L=function(e){var t=e.target,r=e.indicator,i=(b(e,["target","indicator"]),Object(n.useContext)(P)),o=t.results.length||1;return a.a.createElement(a.a.Fragment,null,a.a.createElement("tr",{className:r.timeAware&&t.completed?"results__row--main pt-ended":"results__row--main"},a.a.createElement("td",{rowSpan:o,className:"results__row__target-period"},a.a.createElement("div",null,a.a.createElement("strong",{className:"text-uppercase"},t.periodName)),t.dateRange&&a.a.createElement("div",{className:"text-nowrap"},a.a.createElement("small",null,t.dateRange))),a.a.createElement("td",{rowSpan:o,className:"text-right"},i(t.target)||v.c),a.a.createElement("td",{rowSpan:o,className:"text-right"},i(t.actual)||v.c),a.a.createElement("td",{rowSpan:o,className:"text-right td--pad"},t.percentMet&&t.completed?a.a.createElement(R,{val:t.percentMet}):a.a.createElement("span",{className:"badge"},Object(h.b)(t.percentMet)||C)),t.results&&t.results.length>0?a.a.createElement(F,{result:t.results[0],noTarget:!1}):a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"results__result--nodata",colSpan:"2"},gettext("No results reported")),a.a.createElement("td",null))),t.results.length>1&&t.results.slice(1).map((function(e,n){return a.a.createElement("tr",{key:n,className:r.timeAware&&t.completed?"results__row--supplemental pt-ended":"results__row--supplemental"},a.a.createElement(F,{result:e,noTarget:!1}))})),t.mostRecentlyCompleted&&a.a.createElement("tr",{className:"results__row--subtotal"},a.a.createElement("td",null,a.a.createElement("div",null,a.a.createElement("em",null,a.a.createElement("strong",null,gettext("Program to date")))),a.a.createElement("div",{className:"text-nowrap"},a.a.createElement("small",null,r.reportingPeriod))),a.a.createElement("td",{className:"text-right"},a.a.createElement("strong",null,i(r.lopTargetProgress)||v.c)),a.a.createElement("td",{className:"text-right"},a.a.createElement("strong",null,i(r.lopActualProgress)||v.c)),a.a.createElement("td",{className:"text-right"},r.lopMetProgress?a.a.createElement(R,{val:r.lopMetProgress}):a.a.createElement("span",{className:"badge"},C)),a.a.createElement("td",{colSpan:"3",className:"bg-medium"})))},A=function(e){var t=e.result;b(e,["result"]);return a.a.createElement("tr",null,a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement(F,{result:t,noTarget:!0}))},D=function(e){var t,r=e.indicator,i=(b(e,["indicator"]),Object(n.useContext)(P));return t=r.noTargets?"":r.isPercent||r.isCumulative?gettext("Results are cumulative. The Life of Program result mirrors the latest period result."):gettext("Results are non-cumulative. The Life of Program result is the sum of target period results."),a.a.createElement("tr",{className:"bg-white"},a.a.createElement("td",null,a.a.createElement("strong",null,gettext("Life of Program"))),a.a.createElement("td",{className:"text-right"},a.a.createElement("strong",null,i(r.lopTarget)||v.c)),a.a.createElement("td",{className:"text-right"},a.a.createElement("strong",null,i(r.lopActual)||v.c)),a.a.createElement("td",{className:"text-right"},a.a.createElement("span",{className:"badge"},Object(h.b)(r.lopMet)||C)),a.a.createElement("td",{colSpan:"3"},a.a.createElement("div",{className:"help-text"},t)))},M=function(e){var t=e.indicator;e.editable,b(e,["indicator","editable"]);return a.a.createElement(P.Provider,{value:function(e){var r=Object(h.a)(e);return r&&t.isPercent?"".concat(r,"%"):r}},a.a.createElement("table",{className:"table results-table"},a.a.createElement("thead",null,a.a.createElement("tr",{className:"table-header"},a.a.createElement("th",null,gettext("Target period")),a.a.createElement("th",{className:"text-right"},gettext("Target")),a.a.createElement("th",{className:"text-right"},pgettext("table (short) header","Actual")),a.a.createElement("th",{className:"td--pad text-right"},gettext("% Met")),a.a.createElement("th",{colSpan:"2"},gettext("Results")),a.a.createElement("th",{className:"td--stretch"},gettext("Evidence")))),a.a.createElement("tbody",null,t.periodicTargets.map((function(e,r){return a.a.createElement(L,{key:"targetrow-".concat(r),target:e,indicator:t})})),t.noTargetResults.map((function(e,t){return a.a.createElement(A,{key:"notarget-".concat(t),result:e})})),a.a.createElement(D,{indicator:t}))))},B=function(e){var t=e.indicator,r=e.editable,n=e.resultEditable;b(e,["indicator","editable","resultEditable"]);return a.a.createElement("div",{className:"results-table__actions"},a.a.createElement("div",{className:"cd-actions__message"},t.noTargets&&a.a.createElement("div",{className:"text-danger"},r&&a.a.createElement("a",{href:"/indicators/indicator_update/".concat(t.pk,"/"),"data-tab":"#targets",className:"indicator-link btn btn-success"},a.a.createElement(f.a,{icon:m.e}),gettext("Add targets")))),n&&a.a.createElement("div",{className:t.noTargets?"cd-actions__button disable-span":"cd-actions__button"},a.a.createElement("a",{href:"/indicators/result_add/".concat(t.pk,"/"),className:"btn-link btn-add results__link"},a.a.createElement(f.a,{icon:m.e}),gettext("Add result"))))},U=function(e){O(r,e);var t=w(r);function r(){return _(this,r),t.apply(this,arguments)}return I(r,[{key:"render",value:function(){var e=!this.props.indicator.noTargets||this.props.indicator.noTargetResults.length>0;return a.a.createElement("div",{className:"results-table__wrapper"},e&&a.a.createElement(M,{indicator:this.props.indicator,editable:this.props.editable}),a.a.createElement(B,{indicator:this.props.indicator,editable:this.props.editable,resultEditable:this.props.resultEditable}))}}]),r}(a.a.Component),z=r("7O5W"),q=r("Cs6D");function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Q(e,t,r){return t&&W(e.prototype,t),r&&W(e,r),e}function V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ee(e);if(t){var a=ee(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Y(this,r)}}function Y(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?Z(e):t}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}z.b.add(m.b,m.c);var te,re,ne=Object(p.c)(S=function(e){V(r,e);var t=K(r);function r(e){var n;return J(this,r),(n=t.call(this,e)).onShowAllClick=function(e){e.preventDefault(),l.a.emit("nav-clear-all-indicator-filters")},n}return Q(r,[{key:"render",value:function(){var e=this.props,t=e.indicatorCount,r=(e.programId,e.currentIndicatorFilter),n=e.filterApplied;return a.a.createElement("div",{className:"indicators-list__header"},a.a.createElement("h3",{className:"no-bold"},a.a.createElement("span",{id:"indicators-list-title"},function(e,t){var r;switch(e){case v.g.missingTarget:return r=ngettext("%s indicator has missing targets","%s indicators have missing targets",t),interpolate(r,[t]);case v.g.missingResults:return r=ngettext("%s indicator has missing results","%s indicators have missing results",t),interpolate(r,[t]);case v.g.missingEvidence:return r=ngettext("%s indicator has missing evidence","%s indicators have missing evidence",t),interpolate(r,[t]);case v.g.aboveTarget:return r=ngettext("%s indicator is >15% above target","%s indicators are >15% above target",t),interpolate(r,[t]);case v.g.belowTarget:return r=ngettext("%s indicator is >15% below target","%s indicators are >15% below target",t),interpolate(r,[t]);case v.g.onTarget:return r=ngettext("%s indicator is on track","%s indicators are on track",t),interpolate(r,[t]);case v.g.nonReporting:return r=ngettext("%s indicator is unavailable","%s indicators are unavailable",t),interpolate(r,[t]);default:return r=ngettext("%s indicator","%s indicators",t),interpolate(r,[t])}}(r,t)),n&&a.a.createElement("small",{className:"ml-2 text-medium-dark text-nowrap"},"|",a.a.createElement("a",{className:"btn btn-sm btn-link btn-inline ml-2",href:"#",id:"show-all-indicators",onClick:this.onShowAllClick},gettext("Show all indicators")))))}}]),r}(a.a.Component))||S,ae=Object(p.c)(T=function(e){V(r,e);var t=K(r);function r(){var e;J(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onIndicatorSelection=function(e){var t=e?e.value:null;t&&l.a.emit("nav-select-indicator-to-filter",t)},e.onGroupingSelection=function(t){e.props.uiStore.setGroupBy(t.value)},e}return Q(r,[{key:"render",value:function(){var e=this,t=this.props.rootStore.allIndicators.map((function(e){return{value:e.pk,label:e.name}})),r=this.props.uiStore.selectedIndicatorId?t.find((function(t){return t.value===e.props.uiStore.selectedIndicatorId})):null,n=this.props.uiStore.groupByOptions,i=this.props.uiStore.selectedGroupByOption;return a.a.createElement("nav",{className:"list__filters list__filters--block-label",id:"id_div_indicators"},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:""},gettext("Find an indicator:")),a.a.createElement("div",{className:""},a.a.createElement(q.a,{options:t,value:r,isClearable:!1,placeholder:gettext("None"),onChange:this.onIndicatorSelection}))),this.props.uiStore.resultChainFilterLabel&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:""},gettext("Group indicators:")),a.a.createElement("div",{className:""},a.a.createElement(q.a,{options:n,value:i,isClearable:!1,onChange:this.onGroupingSelection})))))}}]),r}(a.a.Component))||T,ie=Object(p.c)(j=function(e){V(r,e);var t=K(r);function r(e){var n;return J(this,r),(n=t.call(this,e)).onIndicatorUpdateClick=n.onIndicatorUpdateClick.bind(Z(n)),n.onIndicatorResultsToggleClick=n.onIndicatorResultsToggleClick.bind(Z(n)),n}return Q(r,[{key:"onIndicatorUpdateClick",value:function(e,t){e.preventDefault(),l.a.emit("open-indicator-update-modal",t)}},{key:"onIndicatorResultsToggleClick",value:function(e,t){e.preventDefault(),this.props.program.isExpanded(t)?this.props.program.collapse(t):this.props.program.expand(t)}},{key:"render",value:function(){var e=this,t=this.props.indicators,r=this.props.program,n=!this.props.readOnly,i=!this.props.resultReadOnly;return a.a.createElement("table",{className:"table indicators-list"},a.a.createElement("thead",null,a.a.createElement("tr",{className:"table-header"},a.a.createElement("th",{className:"",id:"id_indicator_name_col_header"},gettext("Indicator")),a.a.createElement("th",{className:"",id:"id_indicator_buttons_col_header"}," "),a.a.createElement("th",{className:"",id:"id_indicator_unit_col_header"},gettext("Unit of measure")),a.a.createElement("th",{className:"text-right",id:"id_indicator_baseline_col_header"},gettext("Baseline")),a.a.createElement("th",{className:"text-right",id:"id_indicator_target_col_header"},gettext("Target")))),a.a.createElement("tbody",null,t.map((function(t){var o=t.targetPeriodLastEndDate,l=window.localizeNumber,c=t.isPercent?function(e){return e?"".concat(l(e),"%"):""}:function(e){return e?"".concat(l(e)):""},s=function(e){return""==e||isNaN(parseFloat(e))?"":"00"==(e=parseFloat(e).toFixed(2)).slice(-2)?c(e.slice(0,-3)):"0"==e.slice(-1)?c(e.slice(0,-1)):c(e)},u=t.noTargetResults.length>0&&t.periodicTargets.length>0,p=0===t.periodicTargets.length;return a.a.createElement(a.a.Fragment,{key:t.pk},a.a.createElement("tr",{className:d()("indicators-list__row","indicators-list__indicator-header",{"is-highlighted":t.wasJustCreated,"is-expanded":r.isExpanded(t.pk)})},a.a.createElement("td",null,a.a.createElement("a",{href:"#",className:"indicator_results_toggle btn text-action text-left",tabIndex:"0",onClick:function(r){return e.onIndicatorResultsToggleClick(r,t.pk)}},a.a.createElement(f.a,{icon:r.isExpanded(t.pk)?"caret-down":"caret-right"}),a.a.createElement("strong",null,t.number?t.number+":":"")," ",a.a.createElement("span",{className:"indicator_name"},t.name)),u&&a.a.createElement("span",{className:"text-danger ml-3"},a.a.createElement("i",{className:"fas fa-bullseye"})," ",gettext("Results unassigned to targets")),p&&a.a.createElement("span",{className:"text-danger ml-3"},a.a.createElement("i",{className:"fas fa-bullseye"})," ",gettext("Indicator missing targets")),t.isKeyPerformanceIndicator&&a.a.createElement("span",{className:"badge"},"KPI"),o&&r.reportingPeriodEnd>o&&a.a.createElement("a",{href:"/indicators/indicator_update/".concat(t.pk,"/"),className:"indicator-link color-red missing_targets","data-toggle":"modal","data-target":"#indicator_modal_div","data-tab":"targets"},a.a.createElement("i",{className:"fas fa-bullseye"})," ",gettext("Missing targets"))),a.a.createElement("td",null,a.a.createElement("a",{href:"#",className:"indicator-link",onClick:function(r){return e.onIndicatorUpdateClick(r,t.pk)}},a.a.createElement("i",{className:"fas fa-cog"}))),a.a.createElement("td",null,t.unitOfMeasure),a.a.createElement("td",{className:"text-right"},null===t.baseline?gettext("N/A"):s(t.baseline)),a.a.createElement("td",{className:"text-right"},s(t.lopTarget))),r.isExpanded(t.pk)&&a.a.createElement("tr",{className:"indicators-list__row indicators-list__indicator-body"},a.a.createElement("td",{colSpan:"6"},a.a.createElement(U,{indicator:t,editable:n,resultEditable:i}))))}))))}}]),r}(a.a.Component))||j,oe=Object(p.c)((function(e){var t=e.program,r=e.rootStore;G(e,["program","rootStore"]);return a.a.createElement("div",{className:"indicator-list__buttons-row"},a.a.createElement("div",{className:"expand-collapse-buttons"},a.a.createElement(g.c,{clickHandler:function(){t.expandAll()},disabled:r.allExpanded}),a.a.createElement(g.b,{clickHandler:function(){t.collapseAll()},disabled:r.allCollapsed})),a.a.createElement("div",{className:"indicator-list__add-indicator-button"},!r.readOnly&&a.a.createElement(g.a,{readonly:r.readOnly,programId:t.pk})))})),le=Object(p.c)((function(e){var t=e.rootStore.program;return a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,{indicatorCount:e.rootStore.indicators.length,programId:t.pk,currentIndicatorFilter:e.uiStore.currentIndicatorFilter,filterApplied:e.uiStore.filterApplied}),a.a.createElement(ae,{uiStore:e.uiStore,rootStore:e.rootStore}),a.a.createElement(oe,{program:t,rootStore:e.rootStore}),t.needsAdditionalTargetPeriods&&a.a.createElement("div",{id:"id_missing_targets_msg",className:"color-red"},a.a.createElement("i",{className:"fas fa-bullseye"})," ",gettext("Some indicators have missing targets. To enter these values, click the target icon near the indicator name.")),a.a.createElement(ie,{indicators:e.rootStore.indicators,program:t,readOnly:e.rootStore.readOnly,resultReadOnly:e.rootStore.resultReadOnly}))}));r("LBcr");function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return de(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e,t,r){return t&&ge(e.prototype,t),r&&ge(e,r),e}function me(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var a=ye(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return be(this,r)}}function be(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e,Ee,Ie,Oe,ke=Object(p.c)(te=function(e){me(r,e);var t=ve(r);function r(){var e;pe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleClick=function(t){t.preventDefault(),e.props.disabled||0==e.unfilledPercent||l.a.emit("nav-apply-gauge-tank-filter",e.props.filterType)},e}return fe(r,[{key:"render",value:function(){var e=this.props,t=e.allIndicatorsLength,r=e.filteredIndicatorsLength,n=e.title,i=e.filledLabel,o=e.unfilledLabel,l=e.cta,c=e.emptyLabel,s=e.disabled,u=this.props.filterType===this.props.currentIndicatorFilter,p=t<=0||t==r?100:0==r?0:Math.max(1,Math.min(Math.round(r/t*100),99));this.unfilledPercent=p;var g=100-p;return a.a.createElement("div",{className:d()("gauge",{"filter-trigger":p>0&&!s,"is-highlighted":u}),onClick:this.handleClick},a.a.createElement("h6",{className:"gauge__title"},n),a.a.createElement("div",{className:"gauge__overview"},a.a.createElement("div",{className:"gauge__graphic gauge__graphic--tank ".concat(0==g?"gauge__graphic--empty":"")},a.a.createElement("div",{className:"graphic__tick-marks"},ue(Array(10)).map((function(e,t){return a.a.createElement("div",{key:t,className:"graphic__tick"})}))),a.a.createElement("div",{className:"graphic__tank--unfilled",style:{height:"".concat(p,"%")}}),a.a.createElement("div",{className:"graphic__tank--filled",style:{height:"".concat(g,"%")}})),a.a.createElement("div",{className:"gauge__labels"},g>0?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"gauge__label text-muted"},p,"% ",o),a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"gauge__value"},g,"% ",i))):a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"text-danger"},a.a.createElement("strong",null,c))))),p>0&&!s&&a.a.createElement("div",{className:"gauge__cta"},a.a.createElement("span",{className:"btn-link btn-inline"},a.a.createElement("i",{className:"fas fa-exclamation-triangle text-warning"})," ",l)," "))}}]),r}(a.a.Component))||te,we=Object(p.c)(re=function(e){me(r,e);var t=ve(r);function r(e){var n;return pe(this,r),(n=t.call(this,e)).onFilterLinkClick=function(e,t){e.preventDefault(),l.a.emit("nav-apply-gauge-tank-filter",t)},n.handledFilterTypes=new Set([v.g.aboveTarget,v.g.belowTarget,v.g.onTarget,v.g.nonReporting]),n}return fe(r,[{key:"componentDidUpdate",value:function(){$(this.el).find('[data-toggle="popover"]').popover({html:!0})}},{key:"render",value:function(){var e=this,t=this.props,r=t.rootStore,n=t.currentIndicatorFilter,i=t.program,o=this.handledFilterTypes.has(n),l=r.allIndicators.length,c=r.getIndicatorsNotReporting.length,s=r.getIndicatorsAboveTarget.length,u=r.getIndicatorsBelowTarget.length,p=r.getIndicatorsOnTarget.length,g=l>0?function(e){return e==l?100:0==e?0:Math.max(1,Math.min(Math.round(e/l*100),99))}:function(e){return 0},f=g(s),m=g(p),h=g(u),b=g(c),y=100*this.props.rootStore.onScopeMargin,_=(i.reportingPeriodStart,0===r.getIndicatorsReporting.length||0===r.getTotalResultsCount),E=function(t){return a.a.createElement("div",{className:d()("gauge",{"is-highlighted":o}),ref:function(t){return e.el=t}},a.a.createElement("h6",{className:"gauge__title"},gettext("Indicators on track")),a.a.createElement("div",{className:"gauge__overview"},t.children))},I=function(t){return a.a.createElement("div",{className:"gauge__labels"},a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"text-muted filter-trigger--band",onClick:function(t){return e.onFilterLinkClick(t,v.g.nonReporting)}},interpolate(gettext("%(percentNonReporting)s% unavailable"),{percentNonReporting:b},!0))," ",a.a.createElement("a",{href:"#",tabIndex:"0","data-toggle":"popover","data-placement":"right","data-trigger":"focus","data-content":gettext("The indicator has no targets, no completed target periods, or no results reported."),onClick:function(e){return e.preventDefault()}},a.a.createElement("i",{className:"far fa-question-circle"}))),a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"gauge__value--above filter-trigger--band",onClick:function(t){return e.onFilterLinkClick(t,v.g.aboveTarget)},dangerouslySetInnerHTML:O()})),a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"gauge__value filter-trigger--band",onClick:function(t){return e.onFilterLinkClick(t,v.g.onTarget)},dangerouslySetInnerHTML:k()})," ",a.a.createElement("a",{href:"#",tabIndex:"0","data-toggle":"popover","data-placement":"right","data-trigger":"focus","data-content":gettext("The actual value matches the target value, plus or minus 15%. So if your target is 100 and your result is 110, the indicator is 10% above target and on track.  <br><br>Please note that if your indicator has a decreasing direction of change, then “above” and “below” are switched. In that case, if your target is 100 and your result is 200, your indicator is 50% below target and not on track.<br><br><a href='https://docs.google.com/document/d/1Gl9bxJJ6hdhCXeoOCoR1mnVKZa2FlEOhaJcjexiHzY0' target='_blank'>See our documentation for more information.</a>"),onClick:function(e){return e.preventDefault()}},a.a.createElement("i",{className:"far fa-question-circle"}))),a.a.createElement("div",{className:"gauge__label"},a.a.createElement("span",{className:"gauge__value--below filter-trigger--band",onClick:function(t){return e.onFilterLinkClick(t,v.g.belowTarget)},dangerouslySetInnerHTML:w()})))},O=function(){var e=gettext("<strong>%(percentHigh)s%</strong> are >%(marginPercent)s% above target");return{__html:interpolate(e,{percentHigh:f,marginPercent:y},!0)}},k=function(){var e=gettext("<strong>%s%</strong> are on track");return{__html:interpolate(e,[m])}},w=function(){var e=gettext("<strong>%(percentBelow)s%</strong> are >%(marginPercent)s% below target");return{__html:interpolate(e,{percentBelow:h,marginPercent:y},!0)}};return a.a.createElement(E,null,a.a.createElement("div",{className:"gauge__graphic gauge__graphic--performance-band ".concat(_?"gauge__graphic--empty":"")},a.a.createElement("div",{className:"graphic__tick-marks"},ue(Array(10)).map((function(e,t){return a.a.createElement("div",{key:t,className:"graphic__tick"})}))),a.a.createElement("div",{className:"graphic__performance-band--above-target",style:{height:"".concat(f,"%")}}),a.a.createElement("div",{className:"graphic__performance-band--on-target",style:{height:"".concat(m,"%")}}),a.a.createElement("div",{className:"graphic__performance-band--below-target",style:{height:"".concat(h,"%")}})),_?a.a.createElement("div",{className:"gauge__labels"},a.a.createElement("div",{className:"gauge__label"},a.a.createElement("p",{className:"text-muted"},gettext("Unavailable until the first target period ends with results reported.")))):a.a.createElement(I,null))}}]),r}(a.a.Component))||re,Ne=Object(p.c)((function(e){var t=e.rootStore.program,r=e.rootStore.allIndicators,n=e.uiStore.currentIndicatorFilter,i=e.rootStore.indicatorOnScopeMargin,o={title:gettext("Indicators with targets"),filledLabel:gettext("have targets"),unfilledLabel:gettext("no targets"),cta:gettext("Indicators missing targets"),emptyLabel:gettext("No targets")},l={title:gettext("Indicators with results"),filledLabel:gettext("have results"),unfilledLabel:gettext("no results"),cta:gettext("Indicators missing results"),emptyLabel:gettext("No results")},c={title:gettext("Results with evidence"),filledLabel:gettext("have evidence"),unfilledLabel:gettext("no evidence"),cta:gettext("Indicators missing evidence"),emptyLabel:gettext("No evidence")},s=r.map((function(e){return e.hasAllTargetsDefined})).some((function(e){return e})),u=r.map((function(e){return e.resultsCount})).some((function(e){return e>0}));return 0===r.length?null:a.a.createElement("div",{className:"status__gauges"},a.a.createElement(we,{currentIndicatorFilter:n,indicatorOnScopeMargin:i,rootStore:e.rootStore,program:t}),a.a.createElement(ke,ce({filterType:v.g.missingTarget,currentIndicatorFilter:n,allIndicatorsLength:r.length,filteredIndicatorsLength:e.rootStore.getIndicatorsNeedingTargets.length},o)),a.a.createElement(ke,ce({filterType:v.g.missingResults,currentIndicatorFilter:n,allIndicatorsLength:r.length,filteredIndicatorsLength:e.rootStore.getIndicatorsNeedingResults.length,disabled:!s},l)),a.a.createElement(ke,ce({filterType:v.g.missingEvidence,currentIndicatorFilter:n,allIndicatorsLength:e.rootStore.getTotalResultsCount,filteredIndicatorsLength:e.rootStore.getTotalResultsCount-e.rootStore.getTotalResultsWithEvidenceCount,disabled:!s||!u},c)))})),xe=r("2vnA"),Se=r("5/4V"),Te=r("1d5Q"),je=r("My+N"),Ce=r("NHe6"),Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(xe.n)({_formatDecimal:Ce.a,pk:e.pk,dateCollected:e.date_collected,_achieved:e.achieved,evidenceUrl:e.evidence_url||!1,recordName:e.record_name||!1,get achieved(){return this._formatDecimal(this._achieved)}})},Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(xe.n)({_formatDecimal:Ce.a,periodName:e.period_name,dateRange:e.date_range||null,completed:Boolean(e.completed),mostRecentlyCompleted:Boolean(e.most_recently_completed),_target:e.target,_actual:e.actual,_percentMet:e.percent_met,results:(e.results||[]).map((function(e){return Pe(e)})),get target(){return this._formatDecimal(this._target)},get actual(){return this._formatDecimal(this._actual)},get percentMet(){return this._formatDecimal(this._percentMet)}})},Fe=Object(je.a)(je.b,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{number:e.number||!1,wasJustCreated:Boolean(e.was_just_created),isKeyPerformanceIndicator:Boolean(e.is_key_performance_indicator),isReporting:Boolean(e.is_reporting),hasAllTargetsDefined:Boolean(e.has_all_targets_defined),resultsCount:!isNaN(parseInt(e.results_count))&&parseInt(e.results_count),hasResults:Boolean(e.has_results),resultsWithEvidenceCount:!isNaN(parseInt(e.results_with_evidence_count))&&parseInt(e.results_with_evidence_count),missingEvidence:Boolean(e.missing_evidence),mostRecentlyCompletedTargetEndDate:e.target_frequency&&e.most_recent_completed_target_end_date?new Date(e.most_recent_completed_target_end_date):null,targetPeriodLastEndDate:e.target_frequency&&e.target_period_last_end_date?new Date(e.target_period_last_end_date):null,_overUnder:!isNaN(parseInt(e.over_under))&&parseInt(e.over_under),get belowTarget(){return this.isReporting&&!1!==this._overUnder&&this._overUnder<0},get aboveTarget(){return this.isReporting&&!1!==this._overUnder&&this._overUnder>0},get inScope(){return this.isReporting&&!1!==this._overUnder&&0==this._overUnder},reportingPeriod:e.reporting_period||!1,periodicTargets:(e.periodic_targets||[]).map((function(e){return Re(e)})),noTargetResults:(e.no_target_results||[]).map((function(e){return Pe(e)})),get noTargets(){return!(this.frequency&&this.periodicTargets&&this.periodicTargets.length>0)},updateData:function(e){e.pk&&!isNaN(parseInt(e.pk))&&parseInt(e.pk)===this.pk&&(this.number=e.number||!1)}}})),Le=Object(Te.a)(Te.d,Te.b,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{indicators:e.indicators?new Map(Object.values(e.indicators).map((function(e){return new Fe(e)})).map((function(e){return[e.pk,e]}))):new Map,needsAdditionalTargetPeriods:Boolean(e.needs_additional_target_periods),_expandedIndicators:new Set,isExpanded:function(e){return this._expandedIndicators.has(parseInt(e))},expand:Object(xe.d)((function(e){this._expandedIndicators.add(parseInt(e))})),collapse:Object(xe.d)((function(e){this._expandedIndicators.delete(parseInt(e))})),expandAll:Object(xe.d)((function(){this._expandedIndicators=new Set(this.indicators.keys())})),collapseAll:Object(xe.d)((function(){this._expandedIndicators.clear()})),updateIndicator:Object(xe.d)((function(e){var t=this,r=parseInt(e);return Se.a.updateProgramPageIndicator(r).then((function(e){if(e.indicator){var r=Fe(e.indicator);t.indicators.set(r.pk,r)}return e})).then(this._applyOrderUpdate.bind(this))})),reloadIndicators:Object(xe.d)((function(){var e=this;return Se.a.updateAllProgramPageIndicators(this.pk).then((function(t){return e.indicators=new Map((t.indicators||[]).map(Fe).map((function(e){return[e.pk,e]}))),t})).then(this._applyOrderUpdate.bind(this))})),deleteIndicator:Object(xe.d)((function(e){var t=this;return this.updateOrder().then((function(r){return t.indicators.delete(parseInt(e))}))}))}}));function Ae(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Me(e,t,r,n,a){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Be,$e,Ue,ze=(Ee=Me((_e=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ae(this,"currentIndicatorFilter",Ee,this),Ae(this,"selectedIndicatorId",Ie,this),Ae(this,"groupByChain",Oe,this),this.setIndicatorFilter=this.setIndicatorFilter.bind(this),this.clearIndicatorFilter=this.clearIndicatorFilter.bind(this),this.setSelectedIndicatorId=this.setSelectedIndicatorId.bind(this),this.rootStore=t}var t,r,n;return t=e,(r=[{key:"setIndicatorFilter",value:function(e){this.currentIndicatorFilter=e}},{key:"clearIndicatorFilter",value:function(){this.currentIndicatorFilter=null,this.selectedIndicatorId=null,this.rootStore.program.collapseAll()}},{key:"setSelectedIndicatorId",value:function(e){this.clearIndicatorFilter(),this.selectedIndicatorId=e,this.rootStore.program.expand(e)}},{key:"setGroupBy",value:function(e){this.groupByChain=1==e}},{key:"filterApplied",get:function(){return!(!this.currentIndicatorFilter&&!this.selectedIndicatorId)}},{key:"resultChainFilterLabel",get:function(){return this.rootStore.program.resultChainFilterLabel}},{key:"groupByOptions",get:function(){return[{value:1,label:this.resultChainFilterLabel},{value:2,label:gettext("by Level")}]}},{key:"selectedGroupByOption",get:function(){return this.groupByChain?this.groupByOptions[0]:this.groupByOptions[1]}}])&&De(t.prototype,r),n&&De(t,n),e}()).prototype,"currentIndicatorFilter",[xe.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=Me(_e.prototype,"selectedIndicatorId",[xe.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Me(_e.prototype,"groupByChain",[xe.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Me(_e.prototype,"setIndicatorFilter",[xe.d],Object.getOwnPropertyDescriptor(_e.prototype,"setIndicatorFilter"),_e.prototype),Me(_e.prototype,"clearIndicatorFilter",[xe.d],Object.getOwnPropertyDescriptor(_e.prototype,"clearIndicatorFilter"),_e.prototype),Me(_e.prototype,"setSelectedIndicatorId",[xe.d],Object.getOwnPropertyDescriptor(_e.prototype,"setSelectedIndicatorId"),_e.prototype),Me(_e.prototype,"filterApplied",[xe.f],Object.getOwnPropertyDescriptor(_e.prototype,"filterApplied"),_e.prototype),Me(_e.prototype,"resultChainFilterLabel",[xe.f],Object.getOwnPropertyDescriptor(_e.prototype,"resultChainFilterLabel"),_e.prototype),Me(_e.prototype,"groupByOptions",[xe.f],Object.getOwnPropertyDescriptor(_e.prototype,"groupByOptions"),_e.prototype),Me(_e.prototype,"selectedGroupByOption",[xe.f],Object.getOwnPropertyDescriptor(_e.prototype,"selectedGroupByOption"),_e.prototype),Me(_e.prototype,"setGroupBy",[xe.d],Object.getOwnPropertyDescriptor(_e.prototype,"setGroupBy"),_e.prototype),_e);function qe(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Je(e,t,r,n,a){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var We,Qe=($e=Je((Be=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.programJSON,n=void 0===r?{}:r,a=t.onScopeMargin,i=void 0===a?.15:a,o=t.deletePinnedReportURL,l=void 0===o?null:o,c=t.readOnly,s=void 0===c||c,u=t.resultReadOnly,d=void 0===u||u;He(this,e),qe(this,"program",$e,this),qe(this,"uiStore",Ue,this),this.readOnly=s,this.resultReadOnly=d,this.onScopeMargin=i,this.deletePinnedReportURL=l,this.program=Le(n),this.uiStore=new ze(this)}var t,r,n;return t=e,(r=[{key:"filterIndicators",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case v.g.missingTarget:t=this.getIndicatorsNeedingTargets;break;case v.g.missingResults:t=this.getIndicatorsNeedingResults;break;case v.g.missingEvidence:t=this.getIndicatorsNeedingEvidence;break;case v.g.aboveTarget:t=this.getIndicatorsAboveTarget;break;case v.g.belowTarget:t=this.getIndicatorsBelowTarget;break;case v.g.onTarget:t=this.getIndicatorsOnTarget;break;case v.g.nonReporting:t=this.getIndicatorsNotReporting;break;case v.g.noFilter:default:t=this._sortedIndicators}return r&&!isNaN(parseInt(r))&&(t=t.filter((function(e){return e.pk==parseInt(r)}))),t}},{key:"_sortedIndicators",get:function(){return this.program.resultsFramework&&this.uiStore.groupByChain?this.program.indicatorsInChainOrder:this.program.indicatorsInLevelOrder}},{key:"getIndicatorsNeedingTargets",get:function(){return this._sortedIndicators.filter((function(e){return!e.hasAllTargetsDefined}))}},{key:"getIndicatorsNeedingResults",get:function(){return this._sortedIndicators.filter((function(e){return!e.hasResults}))}},{key:"getIndicatorsNeedingEvidence",get:function(){return this._sortedIndicators.filter((function(e){return e.missingEvidence}))}},{key:"getIndicatorsNotReporting",get:function(){return this._sortedIndicators.filter((function(e){return!e.isReporting}))}},{key:"getIndicatorsAboveTarget",get:function(){return this._sortedIndicators.filter((function(e){return e.aboveTarget}))}},{key:"getIndicatorsBelowTarget",get:function(){return this._sortedIndicators.filter((function(e){return e.belowTarget}))}},{key:"getIndicatorsOnTarget",get:function(){return this._sortedIndicators.filter((function(e){return e.inScope}))}},{key:"getIndicatorsReporting",get:function(){return this._sortedIndicators.filter((function(e){return e.isReporting}))}},{key:"getTotalResultsCount",get:function(){return this.allIndicators.reduce((function(e,t){return e+t.resultsCount}),0)}},{key:"getTotalResultsWithEvidenceCount",get:function(){return this.allIndicators.reduce((function(e,t){return e+t.resultsWithEvidenceCount}),0)}},{key:"indicators",get:function(){return this.filterIndicators(this.uiStore.currentIndicatorFilter,this.uiStore.selectedIndicatorId)}},{key:"allExpanded",get:function(){var e=this;return this.indicators.every((function(t){return e.program.isExpanded(t.pk)}))}},{key:"allCollapsed",get:function(){var e=this;return this.indicators.every((function(t){return!e.program.isExpanded(t.pk)}))}},{key:"allIndicators",get:function(){return this._sortedIndicators}}])&&Ge(t.prototype,r),n&&Ge(t,n),e}()).prototype,"program",[xe.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=Je(Be.prototype,"uiStore",[xe.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je(Be.prototype,"_sortedIndicators",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"_sortedIndicators"),Be.prototype),Je(Be.prototype,"getIndicatorsNeedingTargets",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsNeedingTargets"),Be.prototype),Je(Be.prototype,"getIndicatorsNeedingResults",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsNeedingResults"),Be.prototype),Je(Be.prototype,"getIndicatorsNeedingEvidence",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsNeedingEvidence"),Be.prototype),Je(Be.prototype,"getIndicatorsNotReporting",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsNotReporting"),Be.prototype),Je(Be.prototype,"getIndicatorsAboveTarget",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsAboveTarget"),Be.prototype),Je(Be.prototype,"getIndicatorsBelowTarget",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsBelowTarget"),Be.prototype),Je(Be.prototype,"getIndicatorsOnTarget",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsOnTarget"),Be.prototype),Je(Be.prototype,"getIndicatorsReporting",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getIndicatorsReporting"),Be.prototype),Je(Be.prototype,"getTotalResultsCount",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getTotalResultsCount"),Be.prototype),Je(Be.prototype,"getTotalResultsWithEvidenceCount",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"getTotalResultsWithEvidenceCount"),Be.prototype),Je(Be.prototype,"indicators",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"indicators"),Be.prototype),Je(Be.prototype,"allExpanded",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"allExpanded"),Be.prototype),Je(Be.prototype,"allCollapsed",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"allCollapsed"),Be.prototype),Je(Be.prototype,"allIndicators",[xe.f],Object.getOwnPropertyDescriptor(Be.prototype,"allIndicators"),Be.prototype),Be);reactContext.deletePinnedReportURL&&(We=reactContext.deletePinnedReportURL,$("[data-delete-pinned-report]").click((function(e){e.preventDefault();var t=$(this).data("deletePinnedReport"),r=$(this).closest(".pinned-report");We&&window.confirm(gettext("Warning: This action cannot be undone. Are you sure you want to delete this pinned report?"))&&$.ajax({type:"POST",url:We,data:{pinned_report_id:t},success:function(){r.remove()}})})));var Ve=new Qe(reactContext),Xe=Ve.uiStore;function Ke(e){e+="?modal=1",$("#indicator_modal_content").empty(),$("#modalmessages").empty(),$("#indicator_results_modal_content").load(e),$("#indicator_results_div").modal("show")}l.a.on("open-indicator-update-modal",(function(e){var t="/indicators/indicator_update/".concat(e,"/");$("#indicator_modal_content").empty(),$("#modalmessages").empty(),$("#indicator_modal_content").load(t),$("#indicator_modal_div").modal("show")})),l.a.on("apply-gauge-tank-filter",(function(e){l.a.emit("clear-all-indicator-filters"),Xe.setIndicatorFilter(e)})),l.a.on("clear-all-indicator-filters",(function(){Xe.clearIndicatorFilter(),Ve.program.collapseAll()})),l.a.on("select-indicator-to-filter",(function(e){Xe.clearIndicatorFilter(),Xe.setSelectedIndicatorId(e)})),o.a.render(a.a.createElement(le,{rootStore:Ve,uiStore:Xe}),document.querySelector("#indicator-list-react-component")),o.a.render(a.a.createElement(Ne,{rootStore:Ve,uiStore:Xe}),document.querySelector("#program-metrics-react-component")),$("#indicator-list-react-component").on("click",".results__link",(function(e){e.preventDefault(),Ke($(this).attr("href"))})),$("#indicator_results_div").on("review.tola.results.warning",(function(e,t){Ke(t.url)})),$("#indicator-list-react-component").on("click",".indicator-link[data-tab]",(function(e){e.preventDefault();var t=$(this).attr("href");t+="?modal=1";var r=$(this).data("tab");r&&""!=r&&null!=r&&"undefined"!=r&&(t+="&targetsactive=true"),$("#indicator_modal_content").empty(),$("#modalmessages").empty(),$("#indicator_modal_content").load(t),$("#indicator_modal_div").modal("show")})),$("#indicator_modal_div").on("created.tola.indicator.save",(function(e,t){Ve.program.updateIndicator(parseInt(t.indicatorId))})),$("#indicator_modal_div").on("updated.tola.indicator.save",(function(e,t){var r=parseInt(t.indicatorId);Ve.program.updateIndicator(r)})),$("#indicator_modal_div").on("deleted.tola.indicator.save",(function(e,t){Ve.program.deleteIndicator(t.indicatorId)})),$("#indicator_results_div").on("save.tola.result_form",(function(e){var t=parseInt($(this).find("form #id_indicator").val());Ve.program.updateIndicator(t)}));var Ye=[{name:"all",path:"/",filterType:v.g.noFilter},{name:"targets",path:"/targets",filterType:v.g.missingTarget},{name:"results",path:"/results",filterType:v.g.missingResults},{name:"evidence",path:"/evidence",filterType:v.g.missingEvidence},{name:"scope",path:"/scope",forwardTo:"scope.on"},{name:"scope.on",path:"/on",filterType:v.g.onTarget},{name:"scope.above",path:"/above",filterType:v.g.aboveTarget},{name:"scope.below",path:"/below",filterType:v.g.belowTarget},{name:"scope.nonreporting",path:"/nonreporting",filterType:v.g.nonReporting},{name:"indicator",path:"/indicator/:indicator_id<\\d+>",filterType:v.g.noFilter}],Ze=Object(c.b)(Ye,{defaultRoute:"all",defaultParams:{},trailingSlashMode:"always"});Ze.usePlugin(Object(s.a)({useHash:!0,base:"/program/"+Ve.program.pk+"/"})),Ze.subscribe((function(e){var t=e.route.name,r=e.route.params;if("indicator"!==t){var n=Ye.find((function(e){return e.name===t}));l.a.emit("apply-gauge-tank-filter",n.filterType)}else l.a.emit("select-indicator-to-filter",parseInt(r.indicator_id))})),Ze.start(),l.a.on("nav-apply-gauge-tank-filter",(function(e){var t=Ye.find((function(t){return t.filterType===e}));Ze.navigate(t.name)})),l.a.on("nav-clear-all-indicator-filters",(function(){Ze.navigate("all")})),l.a.on("nav-select-indicator-to-filter",(function(e){Ze.navigate("indicator",{indicator_id:e})})),Object(h.c)()},hzyr:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r("q1tI"),a=r.n(n),i=r("okNM");function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=Object(i.c)((function(e){var t=e.readonly,r=o(e,["readonly"]);return a.a.createElement("button",{type:"button",disabled:t,className:"btn btn-sm btn-link px-0 btn-add text-nowrap",onClick:function(e){openCreateIndicatorFormModal(r)}},a.a.createElement("i",{className:"fas fa-plus-circle"})," ",gettext("Add indicator"))})),c=Object(i.c)((function(e){var t=e.readonly,r=e.label,n=void 0===r?null:r,i=o(e,["readonly","label"]);return a.a.createElement("button",{type:"button",disabled:t,className:"btn btn-link",onClick:function(e){openUpdateIndicatorFormModal(i)}},a.a.createElement("i",{className:"fas fa-cog"}),n)})),s=Object(i.c)((function(e){var t=e.clickHandler,r=e.disabled;return a.a.createElement("button",{className:"btn btn-medium text-action btn-sm",onClick:t,disabled:r},a.a.createElement("i",{className:"fas fa-plus-square"}),gettext("Expand all"))})),u=Object(i.c)((function(e){var t=e.clickHandler,r=e.disabled;return a.a.createElement("button",{className:"btn btn-medium text-action btn-sm",onClick:t,disabled:r},a.a.createElement("i",{className:"fas fa-minus-square"}),gettext("Collapse all"))}))},qtBC:function(e,t,r){"use strict";var n=r("7+Rn"),a=r.n(n)()();t.a=a},v38i:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"l",(function(){return l})),r.d(t,"i",(function(){return c})),r.d(t,"k",(function(){return s})),r.d(t,"f",(function(){return u})),r.d(t,"m",(function(){return d})),r.d(t,"j",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return f})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return v}));var a={value:null,label:"---------"},i="—",o=i,l=1,c=2,s=[3,4,5,6,7],u=[1,2],d=Object.freeze({1:gettext("Life of Program (LoP) only"),2:gettext("Midline and endline"),3:gettext("Annual"),4:gettext("Semi-annual"),5:gettext("Tri-annual"),6:gettext("Quarterly"),7:gettext("Monthly")}),p=Object.freeze({3:gettext("Years"),4:gettext("Semi-annual periods"),5:gettext("Tri-annual periods"),6:gettext("Quarters"),7:gettext("Months")}),g=1,f=2;"undefined"!=typeof gettext&&gettext;var m,h=Object.freeze({noFilter:0,missingTarget:1,missingResults:2,missingEvidence:3,aboveTarget:5,belowTarget:6,onTarget:7,nonReporting:8}),v=null!==(m="reason_for_change_options",n="undefined"!=typeof JS_GLOBALS&&JS_GLOBALS.hasOwnProperty(m)?JS_GLOBALS[m]:null)&&void 0!==n?n:[]}},[["aJgA",0,1]]]);
//# sourceMappingURL=program_page-051cb739499e45c4219b.js.map
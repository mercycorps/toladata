(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"9KAa":function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),a=r.n(n),o=r("i8i4"),i=r.n(o),s=r("2vnA"),c=r("XoI5");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f,d,m,g,h,y,_,b,v,E,O,w,j,x,k,S,P,C,N,A,D,R,z,F,I,U,T,L,H,M,B,q,V,G,W,J,$,K,Y,Q=function(e,t){return c.a.get("/tola_management/user/",{params:l({page:e},t)}).then((function(e){var t=e.data,r=t.count,n=(t.results.length,t.page_count);return{users:t.results,total_pages:n,total_users:r,next_page:t.next,prev_page:t.previous}}))},X=function(e){return c.a.get("/tola_management/user/".concat(e,"/")).then((function(e){return e.data}))},Z=function(e,t){return c.a.put("/tola_management/user/".concat(e,"/"),t).then((function(e){return e.data}))},ee=function(e){return c.a.get("/tola_management/user/".concat(e,"/program_access/")).then((function(e){return e.data}))},te=function(e,t){return c.a.put("/tola_management/user/".concat(e,"/program_access/"),t).then((function(e){}))},re=function(e){return c.a.get("/tola_management/user/".concat(e,"/history/")).then((function(e){return e.data}))},ne=function(e){return c.a.post("/tola_management/user/",e).then((function(e){return e.data}))},ae=function(e){return c.a.post("/tola_management/user/".concat(e,"/resend_registration_email/"),{}).then((function(e){return e.data}))},oe=function(e,t){return c.a.post("/tola_management/user/bulk_update_status/",{user_ids:e,new_status:t}).then((function(e){return e.data}))},ie=function(e,t){return c.a.post("/tola_management/user/bulk_add_programs/",{user_ids:e,added_programs:t}).then((function(e){return e.data}))},se=function(e,t){return c.a.post("/tola_management/user/bulk_remove_programs/",{user_ids:e,removed_programs:t}).then((function(e){return e.data}))},ce=function(e){return c.a.get("/tola_management/user/".concat(e,"/aggregate_data/")).then((function(e){return e.data}))},ue=function(e,t){return c.a.put("/tola_management/user/".concat(e,"/is_active/"),t).then((function(e){return e.data}))},le=r("WtQ/");function pe(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||de(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||de(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){if(e){if("string"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(e,t):void 0}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ge(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _e(e,t,r){return t&&ye(e.prototype,t),r&&ye(e,r),e}function be(e,t,r,n,a){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var we,je={profile:Ee({},{id:null,first_name:"",last_name:"",username:"",email:"",phone_number:"",organization_id:null,mode_of_contact:"",title:"",user_programs:0,user:{is_active:!0}}),access:{country:{},programs:[]},history:[]},xe=(d=be((f=function(){function e(t){var r=this,n=t.regions,a=t.countries,o=t.organizations,i=t.programs,s=t.users,c=t.access,u=t.is_superuser,l=t.programs_filter,p=t.country_filter,f=t.organizations_filter,W=t.program_role_choices,J=t.country_role_choices;he(this,e),ge(this,"users",d,this),ge(this,"users_listing",m,this),ge(this,"users_count",g,this),ge(this,"fetching_users_listing",h,this),ge(this,"current_page",y,this),ge(this,"total_pages",_,this),ge(this,"bulk_targets",b,this),ge(this,"bulk_targets_all",v,this),ge(this,"applying_bulk_updates",E,this),ge(this,"saving_user_profile",O,this),ge(this,"saving_user_programs",w,this),ge(this,"access",j,this),ge(this,"is_superuser",x,this),ge(this,"fetching_editing_target",k,this),ge(this,"editing_target",S,this),ge(this,"editing_target_data",P,this),ge(this,"editing_errors",C,this),ge(this,"new_user",N,this),ge(this,"countries",A,this),ge(this,"ordered_country_ids",D,this),ge(this,"organizations",R,this),ge(this,"programs",z,this),ge(this,"available_users",F,this),ge(this,"countries_selections",I,this),ge(this,"organization_selections",U,this),ge(this,"program_selections",T,this),ge(this,"user_selections",L,this),ge(this,"program_bulk_selections",H,this),ge(this,"unsaved_changes_actions",M,this),ge(this,"active_editor_pane",B,this),this.active_pane_is_dirty=!1,this.country_role_choices=[],this.program_role_choices=[],this.user_status_options=[{value:1,label:gettext("Active")},{value:0,label:gettext("Inactive")}],this.admin_role_options=[{value:1,label:gettext("Yes")},{value:0,label:gettext("No")}],ge(this,"filters",q,this),ge(this,"appliedFilters",V,this),ge(this,"changelog_expanded_rows",G,this),this.regions=n,this.countries=a,this.ordered_country_ids=Object.values(a).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return e.id})),this.organizations=o,this.programs=i,this.available_users=s.filter((function(e){return e.name})),this.countries_selections=Object(le.d)(this.ordered_country_ids.map((function(e){return r.countries[e]})).map((function(e){return{value:e.id,label:e.name}}))),this.organization_selections=Object(le.d)(Object.values(o).map((function(e){return{value:e.id,label:e.name}}))),this.program_selections=this.createProgramSelections(this.programs),this.user_selections=this.available_users.map((function(e){return{value:e.id,label:e.name}})),this.program_bulk_selections=this.ordered_country_ids.map((function(e){return r.countries[e]})).map((function(e){return{label:e.name,options:e.programs.map((function(t){return{label:e.name+": "+i[t].name,value:e.id+"_"+t}}))}})),this.access=c,this.is_superuser=u,this.filters.programs=l.map((function(e){return r.programs[e]})).map((function(e){return{label:e.name,value:e.id}})),this.filters.organizations=f.map((function(e){return r.organizations[e]})).map((function(e){return{label:e.name,value:e.id}})),this.filters.countries=p.map((function(e){return r.countries[e]})).map((function(e){return{label:e.name,value:e.id}})),this.country_role_choices=J.map((function(e){var t=fe(e,2),r=t[0];return{label:t[1],value:r}})),this.program_role_choices=W.map((function(e){var t=fe(e,2),r=t[0];return{label:t[1],value:r}})),this.appliedFilters=Ee({},this.filters),this.fetchUsers()}return _e(e,[{key:"marshalFilters",value:function(e){return Object.entries(e).reduce((function(e,t){return Array.isArray(t[1])?e[t[0]]=t[1].map((function(e){return e.value})):e[t[0]]=t[1].value,e}),{})}},{key:"dirtyConfirm",value:function(){return!this.active_pane_is_dirty||this.active_pane_is_dirty&&confirm(gettext("You have unsaved changes. Are you sure you want to discard them?"))}},{key:"getSelectedBulkTargetIDs",value:function(){return pe(this.bulk_targets.entries()).filter((function(e){var t=fe(e,2);t[0];return t[1]})).map((function(e){var t=fe(e,2),r=t[0];t[1];return r}))}},{key:"onSaveErrorHandler",value:function(e){PNotify.error({text:e||gettext("Saving Failed"),delay:5e3})}},{key:"onSaveSuccessHandler",value:function(e){PNotify.success({text:e||gettext("Successfully Saved"),delay:5e3})}},{key:"createProgramSelections",value:function(e){return Object(le.d)(Object.values(e).map((function(e){return{value:e.id,label:e.name}})))}},{key:"onProfilePaneChange",value:function(e){this.dirtyConfirm()&&(this.active_editor_pane=e,this.active_pane_is_dirty=!1)}},{key:"setActiveFormIsDirty",value:function(e){this.active_pane_is_dirty=e}},{key:"fetchUsers",value:function(){var e=this;this.dirtyConfirm()&&(this.fetching_users_listing=!0,Q(this.current_page+1,this.marshalFilters(this.appliedFilters)).then((function(t){Object(s.p)((function(){e.active_editor_pane="profile",e.active_pane_is_dirty=!1,e.fetching_users_listing=!1,e.users=t.users.reduce((function(e,t){return e[t.id]=t,e}),{}),e.users_listing=t.users.map((function(e){return e.id})),e.bulk_targets_all=!1,e.bulk_targets=new Map,e.users_count=t.total_users,e.total_pages=t.total_pages,e.next_page=t.next_page,e.previous_page=t.previous_page}))})))}},{key:"applyFilters",value:function(){this.appliedFilters=Ee({},this.filters),this.current_page=0,this.fetchUsers()}},{key:"changePage",value:function(e){e.selected!=this.current_page&&(this.current_page=e.selected,this.fetchUsers())}},{key:"toggleBulkTargetsAll",value:function(){var e=this;this.bulk_targets_all=!this.bulk_targets_all;var t=Object.values(this.users_listing);this.bulk_targets=new Map(t.map((function(t){return[t,e.bulk_targets_all]})))}},{key:"toggleBulkTarget",value:function(e){this.bulk_targets.set(e,!this.bulk_targets.get(e))}},{key:"changeCountryFilter",value:function(e){var t=this;if(this.filters.countries=e,0==e.length)this.program_selections=this.createProgramSelections(this.programs);else{var r=e.map((function(e){return e.value})).map((function(e){return t.countries[e]})).flatMap((function(e){return e.programs})),n=new Set(r);this.program_selections=this.createProgramSelections(Array.from(n).map((function(e){return t.programs[e]})))}}},{key:"changeBaseCountryFilter",value:function(e){this.filters.base_countries=e}},{key:"changeOrganizationFilter",value:function(e){this.filters.organizations=e}},{key:"changeProgramFilter",value:function(e){this.filters.programs=e}},{key:"changeUserStatusFilter",value:function(e){this.filters.user_status=e}},{key:"changeAdminRoleFilter",value:function(e){this.filters.admin_role=e}},{key:"changeUserFilter",value:function(e){this.filters.users=e,this.applyFilters()}},{key:"toggleEditingTarget",value:function(e){var t=this;this.dirtyConfirm()&&(this.editing_errors={},this.editing_target_data=Ee({},je),this.active_pane_is_dirty=!1,"new"==this.editing_target&&this.users_listing.shift(),this.active_editor_pane="profile",this.editing_target==e?this.editing_target=null:(this.editing_target=e,this.fetching_editing_target=!0,Promise.all([X(e),ee(e),re(e)]).then((function(e){var r=fe(e,3),n=r[0],a=r[1],o=r[2];Object(s.p)((function(){t.fetching_editing_target=!1,t.editing_target_data={profile:n,access:a,history:o}}))}))))}},{key:"updateActiveEditPage",value:function(e){this.active_edit_page=e,this.active_pane_is_dirty=!1}},{key:"createUser",value:function(){this.dirtyConfirm()&&(this.editing_errors={},this.active_pane_is_dirty=!1,this.active_editor_pane="profile","new"==this.editing_target&&this.users_listing.shift(),this.editing_target_data=Ee({},je),this.users.new={id:"new",name:"",organization_name:"",user_programs:0,is_active:!1},this.users_listing.unshift("new"),this.editing_target="new")}},{key:"updateUserProfile",value:function(e,t){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,Z(e,t).then((function(e){return Promise.all([ce(e.id),re(e.id)]).then((function(t){var n=fe(t,2),a=n[0],o=n[1];r.onSaveSuccessHandler(),Object(s.p)((function(){r.saving_user_profile=!1,r.users[e.id]={id:e.id,name:e.name,organization_name:r.organizations[e.organization_id].name,user_programs:a.program_count,is_active:e.user.is_active},r.active_pane_is_dirty=!1,r.editing_target_data.profile=e,r.editing_target_data.history=o}))}))})).catch((function(e){r.onSaveErrorHandler(e.response.data.detail),Object(s.p)((function(){r.saving_user_profile=!1,r.editing_errors=e.response.data}))}))}},{key:"updateUserIsActive",value:function(e,t){var r=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,ue(e,t).then((function(t){return Promise.all([ce(e),re(e)]).then((function(e){var n=fe(e,2),a=n[0],o=n[1];r.onSaveSuccessHandler(),Object(s.p)((function(){r.saving_user_profile=!1,r.users[t.id]={id:t.id,name:t.name,organization_name:r.organizations[t.organization_id].name,user_programs:a.program_count,is_active:t.user.is_active},r.active_pane_is_dirty=!1,r.editing_target_data.profile=t,r.editing_target_data.history=o}))}))})).catch((function(e){r.onSaveErrorHandler(e.response.data.detail),Object(s.p)((function(){r.saving_user_profile=!1,r.editing_errors=e.response.data}))}))}},{key:"resendRegistrationEmail",value:function(e){var t=this;this.saving_user_profile=!0,ae(e).then((function(e){Object(s.p)((function(){t.saving_user_profile=!1,t.onSaveSuccessHandler(gettext("Verification email sent"))}))})).catch((function(){t.onSaveSuccessHandler(gettext("Verification email send failed"))}))}},{key:"saveNewUser",value:function(e){var t=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,ne(e).then((function(e){return ce(e.id).then((function(r){t.onSaveSuccessHandler(),Object(s.p)((function(){t.saving_user_profile=!1,t.users[e.id]={id:e.id,name:e.name,organization_name:t.organizations[e.organization_id].name,user_programs:r.program_count,is_active:e.user.is_active},t.active_pane_is_dirty=!1,t.user_selections.push({value:e.id,label:e.name}),t.users_listing[0]=e.id,t.editing_target=null,t.toggleEditingTarget(e.id),delete t.users.new}))}))})).catch((function(e){t.onSaveErrorHandler(e.response.data.detail),Object(s.p)((function(){t.saving_user_profile=!1,t.editing_errors=e.response.data}))}))}},{key:"saveNewUserAndAddAnother",value:function(e){var t=this;this.saving_user_profile=!0,this.editing_errors={},this.active_pane_is_dirty=!1,ne(e).then((function(e){return ce(e.id).then((function(r){t.onSaveSuccessHandler(),Object(s.p)((function(){t.saving_user_profile=!1,t.users[e.id]={id:e.id,name:e.name,organization_name:t.organizations[e.organization_id].name,user_programs:r.program_count,is_active:e.user.is_active},t.active_pane_is_dirty=!1,t.user_selections.push({value:e.id,label:e.name}),t.users_listing[0]=e.id,delete t.users.new,t.createUser()}))}))})).catch((function(e){t.onSaveErrorHandler(e.response.data.detail),Object(s.p)((function(){t.saving_user_profile=!1,t.editing_errors=e.response.data}))}))}},{key:"saveUserPrograms",value:function(e,t){var r=this;this.saving_user_programs=!0,this.active_pane_is_dirty=!1,te(e,t).then((function(t){return Promise.all([ce(e),re(e),ee(e)]).then((function(t){var n=fe(t,3),a=n[0],o=n[1],i=n[2];Object(s.p)((function(){r.saving_user_programs=!1,r.users[e].user_programs=a.program_count,r.editing_target_data.history=o,r.editing_target_data.access=i,r.active_pane_is_dirty=!1})),r.onSaveSuccessHandler()}))})).catch((function(e){r.onSaveErrorHandler(e.response.data.detail),Object(s.p)((function(){r.saving_user_programs=!1}))}))}},{key:"bulkUpdateUserStatus",value:function(e){var t=this;this.applying_bulk_updates=!0,oe(this.getSelectedBulkTargetIDs(),e).then((function(e){Object(s.p)((function(){e.forEach((function(e){var r=Object.assign(t.users[e.id],e);t.users[r.id]=r})),t.applying_bulk_updates=!1})),t.onSaveSuccessHandler()})).catch((function(e){Object(s.p)((function(){t.applying_bulk_updates=!1})),t.onSaveErrorHandler()}))}},{key:"bulkAddPrograms",value:function(e){var t=this;this.applying_bulk_updates=!0,ie(this.getSelectedBulkTargetIDs(),e.map((function(e){var t=fe(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}}))).then((function(e){t.getSelectedBulkTargetIDs().forEach((function(e){t.editing_target==e&&ee(e).then((function(e){Object(s.p)((function(){t.editing_target_data.access=e}))}))})),Object(s.p)((function(){Object.entries(e).forEach((function(e){var r=fe(e,2),n=r[0],a=r[1];t.users[n].user_programs=a})),t.applying_bulk_updates=!1})),t.onSaveSuccessHandler()})).catch((function(e){Object(s.p)((function(){t.applying_bulk_updates=!1})),t.onSaveErrorHandler()}))}},{key:"bulkRemovePrograms",value:function(e){var t=this;this.applying_bulk_updates=!0,se(this.getSelectedBulkTargetIDs(),e.map((function(e){var t=fe(e.split("_"),2);return{country:t[0],program:t[1],role:"low"}}))).then((function(e){t.getSelectedBulkTargetIDs().forEach((function(e){t.editing_target==e&&ee(e).then((function(e){Object(s.p)((function(){t.editing_target_data.access=e}))}))})),Object(s.p)((function(){Object.entries(e).forEach((function(e){var r=fe(e,2),n=r[0],a=r[1];t.users[n].user_programs=a})),t.applying_bulk_updates=!1})),t.onSaveSuccessHandler()})).catch((function(e){Object(s.p)((function(){t.applying_bulk_updates=!1})),t.onSaveErrorHandler()}))}},{key:"clearFilters",value:function(){this.filters={countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:this.filters.users||[]}}},{key:"toggleChangeLogRowExpando",value:function(e){this.changelog_expanded_rows.has(e)?this.changelog_expanded_rows.delete(e):this.changelog_expanded_rows.add(e)}},{key:"countriesByRegion",get:function(){var e=this;return Object.values(this.regions||{}).map((function(t){return{id:t.id,name:gettext(t.name),countries:Object.values(e.countries).filter((function(e){return e.region==t.id}))}})).filter((function(e){return e.countries.length>0})).sort((function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1}))}}]),e}()).prototype,"users",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),m=be(f.prototype,"users_listing",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=be(f.prototype,"users_count",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=be(f.prototype,"fetching_users_listing",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=be(f.prototype,"current_page",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=be(f.prototype,"total_pages",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=be(f.prototype,"bulk_targets",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),v=be(f.prototype,"bulk_targets_all",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=be(f.prototype,"applying_bulk_updates",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=be(f.prototype,"saving_user_profile",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=be(f.prototype,"saving_user_programs",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=be(f.prototype,"access",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:{},programs:{}}}}),x=be(f.prototype,"is_superuser",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=be(f.prototype,"fetching_editing_target",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=be(f.prototype,"editing_target",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=be(f.prototype,"editing_target_data",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ee({},je)}}),C=be(f.prototype,"editing_errors",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),N=be(f.prototype,"new_user",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=be(f.prototype,"countries",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),D=be(f.prototype,"ordered_country_ids",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=be(f.prototype,"organizations",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),z=be(f.prototype,"programs",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),F=be(f.prototype,"available_users",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=be(f.prototype,"countries_selections",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=be(f.prototype,"organization_selections",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=be(f.prototype,"program_selections",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=be(f.prototype,"user_selections",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=be(f.prototype,"program_bulk_selections",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=be(f.prototype,"unsaved_changes_actions",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{save:function(){},discard:function(){}}}}),B=be(f.prototype,"active_editor_pane",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"profile"}}),q=be(f.prototype,"filters",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{countries:[],base_countries:[],organizations:[],programs:[],user_status:"",admin_role:"",users:[]}}}),V=be(f.prototype,"appliedFilters",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),G=be(f.prototype,"changelog_expanded_rows",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),be(f.prototype,"countriesByRegion",[s.f],Object.getOwnPropertyDescriptor(f.prototype,"countriesByRegion"),f.prototype),be(f.prototype,"onProfilePaneChange",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"onProfilePaneChange"),f.prototype),be(f.prototype,"fetchUsers",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"fetchUsers"),f.prototype),be(f.prototype,"applyFilters",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"applyFilters"),f.prototype),be(f.prototype,"changePage",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changePage"),f.prototype),be(f.prototype,"toggleBulkTargetsAll",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"toggleBulkTargetsAll"),f.prototype),be(f.prototype,"toggleBulkTarget",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"toggleBulkTarget"),f.prototype),be(f.prototype,"changeCountryFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeCountryFilter"),f.prototype),be(f.prototype,"changeBaseCountryFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeBaseCountryFilter"),f.prototype),be(f.prototype,"changeOrganizationFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeOrganizationFilter"),f.prototype),be(f.prototype,"changeProgramFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeProgramFilter"),f.prototype),be(f.prototype,"changeUserStatusFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeUserStatusFilter"),f.prototype),be(f.prototype,"changeAdminRoleFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeAdminRoleFilter"),f.prototype),be(f.prototype,"changeUserFilter",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"changeUserFilter"),f.prototype),be(f.prototype,"toggleEditingTarget",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"toggleEditingTarget"),f.prototype),be(f.prototype,"updateActiveEditPage",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"updateActiveEditPage"),f.prototype),be(f.prototype,"createUser",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"createUser"),f.prototype),be(f.prototype,"updateUserProfile",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"updateUserProfile"),f.prototype),be(f.prototype,"updateUserIsActive",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"updateUserIsActive"),f.prototype),be(f.prototype,"resendRegistrationEmail",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"resendRegistrationEmail"),f.prototype),be(f.prototype,"saveNewUser",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"saveNewUser"),f.prototype),be(f.prototype,"saveNewUserAndAddAnother",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"saveNewUserAndAddAnother"),f.prototype),be(f.prototype,"saveUserPrograms",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"saveUserPrograms"),f.prototype),be(f.prototype,"bulkUpdateUserStatus",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"bulkUpdateUserStatus"),f.prototype),be(f.prototype,"bulkAddPrograms",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"bulkAddPrograms"),f.prototype),be(f.prototype,"bulkRemovePrograms",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"bulkRemovePrograms"),f.prototype),be(f.prototype,"clearFilters",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"clearFilters"),f.prototype),be(f.prototype,"toggleChangeLogRowExpando",[s.d],Object.getOwnPropertyDescriptor(f.prototype,"toggleChangeLogRowExpando"),f.prototype),f),ke=(J=be((W=function(){function e(t,r){he(this,e),ge(this,"regions",J,this),ge(this,"countries",$,this),ge(this,"_selectedCountryIds",K,this),ge(this,"_expandedCountryIds",Y,this),this.regions=t,this.countries=r,this._selectedCountryIds=[],this._expandedCountryIds=new Set(pe(Object.keys(this.countries).map((function(e){return parseInt(e)})))),this.nameSort=function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1}}return _e(e,[{key:"isExpanded",value:function(e){return this._expandedCountryIds.has(parseInt(e))}},{key:"toggleExpanded",value:function(e){this._expandedCountryIds.has(parseInt(e))?this._expandedCountryIds.delete(parseInt(e)):this._expandedCountryIds.add(parseInt(e))}},{key:"setExpanded",value:function(e){this._expandedCountryIds.add(parseInt(e))}},{key:"removeRegion",value:function(e){var t=Object.values(this.countries).filter((function(t){return t.region==e})).map((function(e){return e.id}));this._selectedCountryIds=this._selectedCountryIds.filter((function(e){return!t.includes(e)}))}},{key:"addRegion",value:function(e){var t=Object.values(this.countries).filter((function(t){return t.region==e})).map((function(e){return e.id}));this._selectedCountryIds=pe(new Set([].concat(pe(this._selectedCountryIds),pe(t))))}},{key:"removeCountry",value:function(e){this._selectedCountryIds=this._selectedCountryIds.filter((function(t){return t!==e})),this._expandedCountryIds.delete(parseInt(e))}},{key:"addCountry",value:function(e){this._selectedCountryIds=pe(new Set([].concat(pe(this._selectedCountryIds),[e]))),this._expandedCountryIds.add(parseInt(e))}},{key:"updateSelected",value:function(e){var t=this;if(0==e.length)this._selectedCountryIds=[],this._expandedCountryIds=new Set(pe(Object.keys(this.countries).map((function(e){return parseInt(e)}))));else if(e.length<this.selectedOptions.length){this.selectedOptions.filter((function(t){return!e.map((function(e){return e.value})).includes(t.value)})).forEach((function(e){e.value&&"".concat(e.value).includes("r")?t.removeRegion(e.value.slice(2)):e.value&&t.removeCountry(e.value)})),0==this.selectedOptions.length&&(this._expandedCountryIds=new Set(pe(Object.keys(this.countries).map((function(e){return parseInt(e)})))))}else{0==this.selectedOptions.length&&(this._expandedCountryIds=new Set([]));e.filter((function(e){return!t.selectedOptions.map((function(e){return e.value})).includes(e.value)})).forEach((function(e){e.value&&"".concat(e.value).includes("r")?t.addRegion(e.value.slice(2)):e.value&&t.addCountry(e.value)}))}}},{key:"orderedRegions",get:function(){var e=this;return Object.values(this.regions||{}).map((function(t){return{id:t.id,name:gettext(t.name),countries:Object.values(e.countries).filter((function(e){return e.region==t.id})).sort(e.nameSort)}})).filter((function(e){return e.countries.length>0})).sort(this.nameSort)}},{key:"groupedOptions",get:function(){return[{label:gettext("Regions"),value:null,selectable:!1,options:this.orderedRegions.map((function(e){return{label:e.name,value:"r-".concat(e.id)}}))}].concat(pe(this.orderedRegions.map((function(e){return{label:e.name,value:null,divider:!0,options:e.countries.map((function(e){return{label:e.name,value:e.id}}))}}))))}},{key:"selectedCountries",get:function(){return this._selectedCountryIds.map((function(e){return parseInt(e)}))}},{key:"selectedOptions",get:function(){var e=this,t=function(t){return e.selectedCountries.includes(t.id)};return[].concat(pe(this.orderedRegions.filter((function(e){return e.countries.every(t)})).map((function(e){return{value:"r-".concat(e.id),label:e.name,noList:!0}}))),pe(this.selectedCountries.map((function(t){return{label:e.countries[t].name,value:e.countries[t].id}}))))}}]),e}()).prototype,"regions",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=be(W.prototype,"countries",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=be(W.prototype,"_selectedCountryIds",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=be(W.prototype,"_expandedCountryIds",[s.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be(W.prototype,"orderedRegions",[s.f],Object.getOwnPropertyDescriptor(W.prototype,"orderedRegions"),W.prototype),be(W.prototype,"groupedOptions",[s.f],Object.getOwnPropertyDescriptor(W.prototype,"groupedOptions"),W.prototype),be(W.prototype,"selectedCountries",[s.f],Object.getOwnPropertyDescriptor(W.prototype,"selectedCountries"),W.prototype),be(W.prototype,"selectedOptions",[s.f],Object.getOwnPropertyDescriptor(W.prototype,"selectedOptions"),W.prototype),be(W.prototype,"toggleExpanded",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"toggleExpanded"),W.prototype),be(W.prototype,"setExpanded",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"setExpanded"),W.prototype),be(W.prototype,"removeRegion",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"removeRegion"),W.prototype),be(W.prototype,"addRegion",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"addRegion"),W.prototype),be(W.prototype,"removeCountry",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"removeCountry"),W.prototype),be(W.prototype,"addCountry",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"addCountry"),W.prototype),be(W.prototype,"updateSelected",[s.d],Object.getOwnPropertyDescriptor(W.prototype,"updateSelected"),W.prototype),W),Se=r("okNM"),Pe=r("Cs6D"),Ce=r("Z2Y6"),Ne=r("TGVD");function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ue(e);if(t){var a=Ue(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Ie(this,r)}}function Ie(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te,Le=Object(Se.c)(we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(i,e);var t,r,n,o=Fe(i);function i(){return De(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"updateActivePage",value:function(e){this.props.new||this.props.notifyPaneChange(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.ProfileSection,n=t.ProgramSection,o=t.HistorySection,i=t.active_pane,s="profile"==i?"active":"",c="programs_and_roles"==i?"active":"",u="status_and_history"==i?"active":"",l=this.props.new?"disabled":"";return a.a.createElement("div",{className:"tab-set--vertical"},a.a.createElement("ul",{className:"nav nav-tabs"},a.a.createElement("li",{className:"nav-item"},a.a.createElement("a",{href:"#",className:"nav-link ".concat(s),onClick:function(t){t.preventDefault(),e.updateActivePage("profile")}},gettext("Profile"))),a.a.createElement("li",{className:"nav-item"},a.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(c," ").concat(l),onClick:function(t){t.preventDefault(),e.updateActivePage("programs_and_roles")}},gettext("Programs and Roles"))),a.a.createElement("li",{className:"nav-item"},a.a.createElement("a",{href:"#",className:"nav-link text-nowrap ".concat(u," ").concat(l),onClick:function(t){t.preventDefault(),e.updateActivePage("status_and_history")}},gettext("Status and History")))),a.a.createElement("div",{className:"tab-content"},"profile"==i&&a.a.createElement(r,null),"programs_and_roles"==i&&a.a.createElement(n,null),"status_and_history"==i&&a.a.createElement(o,null)))}}])&&Re(t.prototype,r),n&&Re(t,n),i}(a.a.Component))||we;function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach((function(t){qe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ve(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ge(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ye(e);if(t){var a=Ye(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Ke(this,r)}}function Ke(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe,Xe=Object(Se.c)(Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(i,e);var t,r,n,o=$e(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this,e);var r,n=e.userData,a=[],c=Ve(e.organizations.filter((function(t){return 1!=t.value||e.is_superuser})));try{for(c.s();!(r=c.n()).done;){var u=r.value,l=Object(s.r)(u);"Mercy Corps"===l.label&&(l.label=gettext("Mercy Corps -- managed by Okta"),l.isDisabled=!0),a.push(l)}}catch(e){c.e(e)}finally{c.f()}var p=a.find((function(e){return e.value==n.organization_id}));return t.hasMCEmail=n.email.endsWith("@mercycorps.org"),t.state={original_user_data:Be({},n),managed_user_data:Be({},n),selected_organization:p,organization_listing:a},t}return t=i,(r=[{key:"save",value:function(){this.props.onUpdate(this.state.managed_user_data)}},{key:"saveNew",value:function(e){e.preventDefault(),this.props.onCreate(this.state.managed_user_data)}},{key:"saveNewAndAddAnother",value:function(e){e.preventDefault(),this.props.onCreateAndAddAnother(this.state.managed_user_data)}},{key:"updateFirstName",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{first_name:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateLastName",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{last_name:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateUsername",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{username:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateOrganization",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{organization_id:e.value}),selected_organization:e},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateTitle",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{title:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateEmail",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{email:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updatePhone",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{phone_number:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"updateModeOfContact",value:function(e){var t=this;this.setState({managed_user_data:Be(Be({},this.state.managed_user_data),{},{mode_of_contact:e})},(function(){return t.hasUnsavedDataAction()}))}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(JSON.stringify(this.state.managed_user_data)!=JSON.stringify(this.state.original_user_data))}},{key:"resetForm",value:function(){var e=this,t=this.state.organization_listing.find((function(t){return t.value==e.state.original_user_data.organization_id}));this.setState({managed_user_data:this.state.original_user_data,selected_organization:t},(function(){return e.hasUnsavedDataAction()}))}},{key:"render",value:function(){var e=this,t=this.state.managed_user_data,r=this.props.errors,n=this.props.disabled,o=r.first_name?"is-invalid":"",i=r.last_name?"is-invalid":"",s=r.username?"is-invalid":"",c=r.email?"is-invalid":"",u=r.organization_id?"is-invalid":"";return a.a.createElement("div",{className:"tab-pane--react"},a.a.createElement("h2",{className:"no-bold"},t.name?t.name+": ":"",gettext("Profile")),a.a.createElement("form",{className:"form"},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-first-name-input"},gettext("Preferred First Name")),a.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+o,type:"text",value:t.first_name||"",onChange:function(t){return e.updateFirstName(t.target.value)},id:"user-first-name-input",required:!0}),r.first_name&&a.a.createElement("div",{className:"invalid-feedback"},r.first_name)),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-last-name-input"},gettext("Preferred Last Name")),a.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+i,type:"text",value:t.last_name||"",onChange:function(t){return e.updateLastName(t.target.value)},id:"user-last-name-input",required:!0}),r.last_name&&a.a.createElement("div",{className:"invalid-feedback"},r.last_name)),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-username-input"},gettext("Username")),a.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+s,type:"text",value:t.username||"",onChange:function(t){return e.updateUsername(t.target.value)},id:"user-username-input",required:!0}),r.username&&a.a.createElement("div",{className:"invalid-feedback"},r.username)),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-organization-input"},gettext("Organization")),a.a.createElement(Pe.a,{isDisabled:n||this.hasMCEmail,className:"react-select "+u,value:this.state.selected_organization,options:this.state.organization_listing,onChange:function(t){return e.updateOrganization(t)},placeholder:gettext("None Selected"),id:"user-organization-input"}),r.organization_id&&a.a.createElement("div",{className:"invalid-feedback feedback--react-select"},r.organization_id)),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"user-title-input"},gettext("Title")),a.a.createElement("input",{disabled:n,maxLength:"50",type:"text",value:t.title||"",onChange:function(t){return e.updateTitle(t.target.value)},className:"form-control",id:"user-title-input"})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-email-input"},gettext("Email")),a.a.createElement("input",{disabled:n||this.hasMCEmail,className:"form-control "+c,type:"email",value:t.email||"",onChange:function(t){return e.updateEmail(t.target.value)},id:"user-email-input"}),r.email&&a.a.createElement("div",{className:"invalid-feedback"},r.email)),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"user-phone-input"},gettext("Phone")),a.a.createElement("input",{disabled:n,type:"tel",value:t.phone_number||"",onChange:function(t){return e.updatePhone(t.target.value)},className:"form-control",id:"user-phone-input"})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"user-mode-of-contact-input"},gettext("Preferred Mode of Contact")),a.a.createElement("input",{disabled:n,type:"text",value:t.mode_of_contact||"",onChange:function(t){return e.updateModeOfContact(t.target.value)},className:"form-control",id:"user-mode-of-contact-input"})),this.props.new&&!n&&a.a.createElement("div",{className:"form-group btn-row"},a.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(t){return e.saveNew(t)}},gettext("Save changes")),a.a.createElement("button",{className:"btn btn-secondary",onClick:function(t){return e.saveNewAndAddAnother(t)}},gettext("Save And Add Another")),a.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return e.resetForm()}},gettext("Reset"))),!this.props.new&&!n&&a.a.createElement("div",{className:"form-group btn-row"},a.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(t){return e.save()}},gettext("Save changes")),a.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return e.resetForm()}},gettext("Reset")))))}}])&&We(t.prototype,r),n&&We(t,n),i}(a.a.Component))||Te,Ze=r("c7k8"),et=r("IP2g");function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=st(e);if(t){var a=st(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ot(this,r)}}function ot(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?it(e):t}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e){return function(e){if(Array.isArray(e))return mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||dt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(r),!0).forEach((function(t){pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||dt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){if(e){if("string"==typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gt,ht=function(e,t,r){return e.flatMap((function(e){return[e].concat(ct(r(e.id)?Array.from(e.programs).filter((function(e){return t[e]})).map((function(r){return lt(lt({},t[r]),{},{id:"".concat(e.id,"_").concat(r),country_id:e.id})})):[]))}))},yt=function(e,t,r){if(!r)return{programs:e,countries:t};var n=Object.entries(e).filter((function(e){var t=ft(e,2);t[0];return t[1].name.toLowerCase().includes(r.toLowerCase())})).map((function(e){var t=ft(e,2);t[0];return t[1]}));return{countries:Object.entries(t).filter((function(e){var t=ft(e,2),r=(t[0],t[1]);return n.some((function(e){return r.programs.has(e.id)}))})).map((function(e){var t=ft(e,2);t[0];return t[1]})).reduce((function(e,t){return lt(lt({},e),{},pt({},t.id,t))}),{}),programs:n.reduce((function(e,t){return lt(lt({},e),{},pt({},t.id,t))}),{})}},_t=function(e,t){return t.length>0?t.filter((function(t){return e[t]})).map((function(t){return e[t]})).reduce((function(e,t){return lt(lt({},e),{},pt({},t.id,t))}),{}):e},bt=function(e){return{countries:Object.entries(e.countries).reduce((function(e,t){var r=ft(t,2),n=r[0],a=r[1];return lt(lt({},e),{},pt({},n,lt(lt({},a),{},{has_access:!0})))}),{}),programs:e.programs.reduce((function(e,t){return lt(lt({},e),{},pt({},"".concat(t.country,"_").concat(t.program),lt(lt({},t),{},{has_access:!0})))}),{})}},vt=function(e,t,r){return Array.from(e.programs).filter((function(e){return!!t[e]})).every((function(t){return r.programs["".concat(e.id,"_").concat(t)]&&r.programs["".concat(e.id,"_").concat(t)].has_access}))},Et=Object(Se.c)(Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(i,e);var t,r,n,o=at(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this,e);var r=e.store,n=function(e,t){return Object.entries(e).reduce((function(e,r){var n=ft(r,2),a=n[0],o=n[1];return lt(lt({},e),{},pt({},a,lt(lt({},o),{},{type:"country",options:[{label:gettext("Individual programs only"),value:"none"}].concat(ct(t.country_role_choices)),admin_access:t.is_superuser,programs:new Set(o.programs)})))}),{})}(r.countries,r),a=function(e,t){return Object.entries(e).reduce((function(e,r){var n=ft(r,2),a=n[0],o=n[1];return lt(lt({},e),{},pt({},a,lt(lt({},o),{},{type:"program",options:t.program_role_choices})))}),{})}(r.programs,r);t.countryStore=new ke(r.regions,r.countries);var s=t.isExpanded.bind(it(t),"");return t.state={program_filter:"",countries:n,programs:a,filtered_countries:n,filtered_programs:a,ordered_country_ids:r.ordered_country_ids,flattened_programs:ht(r.ordered_country_ids.filter((function(e){return e in n})).map((function(e){return n[e]})),a,s),original_user_program_access:bt(r.editing_target_data.access),user_program_access:bt(r.editing_target_data.access)},t}return t=i,(r=[{key:"saveForm",value:function(){var e=this,t=this.state.user_program_access;this.props.onSave({countries:Object.entries(t.countries).filter((function(t){var r=ft(t,2);return r[0],r[1],e.props.store.is_superuser})).filter((function(e){var t=ft(e,2);return t[0],t[1].has_access})).reduce((function(e,t){var r=ft(t,2),n=r[0],a=r[1];return lt(lt({},e),{},pt({},n,a))}),{}),programs:Object.entries(t.programs).filter((function(e){var t=ft(e,2);return t[0],t[1].has_access})).map((function(e){var t=ft(e,2);return t[0],t[1]}))}),this.hasUnsavedDataAction()}},{key:"hasUnsavedDataAction",value:function(){var e={countries:Object.entries(this.state.user_program_access.countries).filter((function(e){var t=ft(e,2);return t[0],t[1].has_access})).reduce((function(e,t){var r=ft(t,2),n=r[0],a=r[1];return lt(lt({},e),{},pt({},n,a))}),{}),programs:Object.entries(this.state.user_program_access.programs).filter((function(e){var t=ft(e,2);return t[0],t[1].has_access})).reduce((function(e,t){var r=ft(t,2),n=r[0],a=r[1];return lt(lt({},e),{},pt({},n,a))}),{})};this.props.onIsDirtyChange(JSON.stringify(e)!=JSON.stringify(this.state.original_user_program_access))}},{key:"resetForm",value:function(){var e=this;this.setState({user_program_access:{countries:lt({},this.state.original_user_program_access.countries),programs:lt({},this.state.original_user_program_access.programs)}},(function(){return e.hasUnsavedDataAction()}))}},{key:"toggleProgramAccess",value:function(e){var t=this,r=this.state.user_program_access.programs,n=function(){if(r[e])return lt(lt({},r[e]),{},{has_access:!r[e].has_access});var t=ft(e.split("_"),2);return{country:t[0],program:t[1],role:"low",has_access:!0}}();this.setState({user_program_access:lt(lt({},this.state.user_program_access),{},{programs:lt(lt({},r),{},pt({},e,n))})},(function(){return t.hasUnsavedDataAction()}))}},{key:"toggleAllProgramsForCountry",value:function(e){var t=this,r=this.state.countries[e],n=vt(r,t.state.filtered_programs,t.state.user_program_access)?Array.from(r.programs).filter((function(e){return!!t.state.filtered_programs[e]})).reduce((function(e,n){var a="".concat(r.id,"_").concat(n),o=t.state.user_program_access.programs[a];return o?lt(lt({},e),{},pt({},a,lt(lt({},o),{},{has_access:!1}))):e}),{}):Array.from(r.programs).filter((function(e){return!!t.state.filtered_programs[e]})).reduce((function(e,n){var a="".concat(r.id,"_").concat(n),o=t.state.user_program_access.programs[a];return lt(lt({},e),{},pt({},a,o?lt(lt({},o),{},{has_access:!0}):{program:n,country:r.id,role:"low",has_access:!0}))}),{});this.setState({user_program_access:lt(lt({},this.state.user_program_access),{},{programs:lt(lt({},this.state.user_program_access.programs),n)})},(function(){return t.hasUnsavedDataAction()}))}},{key:"changeCountryRole",value:function(e,t){var r=this,n=lt({},this.state.user_program_access.countries[e]),a=lt(lt({},n),{},"none"!=t?{role:t,has_access:!0}:{role:t,has_access:!1});this.setState({user_program_access:lt(lt({},this.state.user_program_access),{},{countries:lt(lt({},this.state.user_program_access.countries),{},pt({},e,a))})},(function(){return r.hasUnsavedDataAction()}))}},{key:"changeProgramRole",value:function(e,t){var r=this,n=ft(e.split("_"),2),a=n[0],o=n[1],i=this.state.user_program_access,s=i[a]&&i[a].has_access&&"low"==t?{program:o,country:a,role:t,has_access:!1}:{program:o,country:a,role:t,has_access:!0};this.setState({user_program_access:lt(lt({},this.state.user_program_access),{},{programs:lt(lt({},this.state.user_program_access.programs),{},pt({},e,s))})},(function(){return r.hasUnsavedDataAction()}))}},{key:"clearFilter",value:function(){var e=_t(this.state.countries,this.countryStore.selectedCountries),t=yt(this.state.programs,e,""),r=t.countries,n=t.programs,a=this.isExpanded.bind(this,"");this.setState({program_filter:"",filtered_programs:n,filtered_countries:r,flattened_programs:ht(this.state.ordered_country_ids.filter((function(e){return e in r})).map((function(e){return r[e]})),n,a)})}},{key:"updateProgramFilter",value:function(e){var t=_t(this.state.countries,this.countryStore.selectedCountries),r=yt(this.state.programs,t,e),n=r.countries,a=r.programs,o=this.isExpanded.bind(this,e);this.setState({program_filter:e,filtered_programs:a,filtered_countries:n,flattened_programs:ht(this.state.ordered_country_ids.filter((function(e){return e in n})).map((function(e){return n[e]})),a,o)})}},{key:"changeCountryFilter",value:function(e){this.countryStore.updateSelected(e);var t=_t(this.state.countries,this.countryStore.selectedCountries),r=yt(this.state.programs,t,this.state.program_filter),n=r.countries,a=(r.programs,this.isExpanded.bind(this,this.state.program_filter));this.setState({filtered_countries:n,flattened_programs:ht(this.state.ordered_country_ids.filter((function(e){return e in n})).map((function(e){return n[e]})),this.state.filtered_programs,a)})}},{key:"toggleCountryExpanded",value:function(e){this.countryStore.toggleExpanded(e);var t=_t(this.state.countries,this.countryStore.selectedCountries),r=yt(this.state.programs,t,this.state.program_filter),n=r.countries,a=(r.programs,this.isExpanded.bind(this,this.state.program_filter));this.setState({filtered_countries:n,flattened_programs:ht(this.state.ordered_country_ids.filter((function(e){return e in n})).map((function(e){return n[e]})),this.state.filtered_programs,a)})}},{key:"isExpanded",value:function(e,t){return!!(e&&e.length>0)||this.countryStore.isExpanded(t)}},{key:"render",value:function(){var e=this,t=this.props,r=t.user,n=(t.onSave,function(t){if("country"==t.type){var r=e.state.user_program_access.countries;return r[t.id]?r[t.id].role:"none"}var n=e.state.user_program_access.programs;return n[t.id]?n[t.id].role:e.props.store.program_role_choices[0].value});return a.a.createElement("div",{className:"tab-pane--react edit-user-programs"},a.a.createElement("h2",{className:"no-bold"},r.name?r.name+": ":"",gettext("Programs and Roles"),a.a.createElement("sup",null,"   ",a.a.createElement("a",{target:"_blank",href:"https://learn.mercycorps.org/index.php/TOLA:Section_05/en#5.4_User_Roles_Matrix_.28Program_Permissions.29"},a.a.createElement("i",{"aria-label":gettext("More information on Program Roles"),className:"far fa-question-circle"})))),a.a.createElement("div",{className:"edit-user-programs__filter-form"},a.a.createElement("div",{className:"edit-user-programs__country-filter form-group react-multiselect-checkbox"},a.a.createElement(Ce.a,{placeholder:gettext("Filter countries"),isMulti:!0,value:this.countryStore.selectedOptions,options:this.countryStore.groupedOptions,onChange:function(t){return e.changeCountryFilter(t)}})),a.a.createElement("div",{className:"form-group edit-user-programs__program-filter"},a.a.createElement("div",{className:"input-group"},a.a.createElement("input",{placeholder:gettext("Filter programs"),type:"text",value:this.state.program_filter,className:"form-control",onChange:function(t){return e.updateProgramFilter(t.target.value)}}),a.a.createElement("div",{className:"input-group-append"},a.a.createElement("a",{onClick:function(t){t.preventDefault(),e.clearFilter()}},a.a.createElement("span",{className:"input-group-text"},a.a.createElement("i",{className:"fa fa-times-circle"}))))))),a.a.createElement("div",{className:"virtualized-table__wrapper"},a.a.createElement(Ze.a,null,(function(r){var o=r.height,i=r.width;return a.a.createElement(Ze.f,{height:o,headerHeight:50,width:i,rowGetter:function(t){var r=t.index;return e.state.flattened_programs[r]},rowHeight:50,rowCount:e.state.flattened_programs.length},a.a.createElement(Ze.d,{dataKey:"not_applicable_but_required",label:gettext("Has access?"),width:100,cellDataGetter:function(r){var n,a,o=r.rowData;return{checked:(n=o,a=e.state.user_program_access,"country"==n.type?a.countries[n.id]&&a.countries[n.id].has_access||!1:!(!e.state.user_program_access.countries[n.country_id]||!e.state.user_program_access.countries[n.country_id].has_access)||a.programs[n.id]&&a.programs[n.id].has_access||!1),disabled:(t.onSave,function(t){return"country"==t.type?!(e.state.countries[t.id].programs.size>0)||!(e.props.store.access.countries[t.id]&&"basic_admin"==e.props.store.access.countries[t.id].role)||e.state.user_program_access.countries[t.id]&&e.state.user_program_access.countries[t.id].has_access:!(!e.state.user_program_access.countries[t.country_id]||!e.state.user_program_access.countries[t.country_id].has_access)||(!e.props.store.access.countries[t.country_id]||"basic_admin"!=e.props.store.access.countries[t.country_id].role)})(o),id:o.id,type:o.type,expanded:"country"==o.type&&(e.state.program_filter||e.countryStore.isExpanded(o.id)),programsCount:"country"==o.type?o.programs.size:null,action:"country"==o.type?e.toggleAllProgramsForCountry.bind(e):e.toggleProgramAccess.bind(e)}},cellRenderer:function(t){var r=t.cellData;if("country"==r.type){var n=vt(e.state.countries[r.id],e.state.filtered_programs,e.state.user_program_access)?gettext("Deselect All"):gettext("Select All"),o=r.disabled||!r.expanded?null:a.a.createElement("a",{className:"edit-user-programs__select-all",onClick:function(e){return r.action(r.id)}},n);return a.a.createElement("div",{className:"check-column"},o)}return a.a.createElement("div",{className:"check-column"},a.a.createElement("input",{type:"checkbox",checked:r.checked,disabled:r.disabled,onChange:function(){return r.action(r.id)}}))}}),a.a.createElement(Ze.d,{dataKey:"not_applicable_but_required",label:gettext("Countries and Programs"),width:200,flexGrow:2,className:"pl-0",cellDataGetter:function(t){var r=t.rowData;return{expanded:"country"==r.type&&(e.state.program_filter||e.countryStore.isExpanded(r.id)),programsCount:"country"==r.type?r.programs.size:null,expandoAction:"country"==r.type?e.toggleCountryExpanded.bind(e,r.id):null,bold:"country"==r.type,name:r.name}},cellRenderer:function(e){var t=e.cellData;if(t.bold){var r=t.programsCount?a.a.createElement(et.a,{icon:t.expanded?"caret-down":"caret-right"}):null,n=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"expando-toggle__icon"},r),a.a.createElement("div",{className:"expando-toggle__label"},a.a.createElement("strong",null,t.name)));return t.programsCount?a.a.createElement("div",{className:"edit-user-programs__expando expando-toggle icon__clickable",onClick:t.expandoAction},n):a.a.createElement("div",{className:"edit-user-programs__expando expando-toggle"},n)}return a.a.createElement("span",null,t.name)}}),a.a.createElement(Ze.d,{width:100,flexGrow:1,className:"pl-0",dataKey:"not_applicable_but_required",label:gettext("Roles and Permissions"),cellDataGetter:function(t){var r,n=t.rowData;return{id:n.id,disabled:(r=n,"country"==r.type?!e.props.store.is_superuser:!(e.props.store.access.countries[r.country_id]&&"basic_admin"==e.props.store.access.countries[r.country_id].role&&(e.state.user_program_access.programs[r.id]&&e.state.user_program_access.programs[r.id].has_access||e.state.user_program_access.countries[r.country_id]&&e.state.user_program_access.countries[r.country_id].has_access))),type:n.type,options:n.options,action:"country"==n.type?e.changeCountryRole.bind(e):e.changeProgramRole.bind(e)}},cellRenderer:function(e){var t=e.cellData;return a.a.createElement("select",{disabled:t.disabled,value:n(t),onChange:function(e){return t.action(t.id,e.target.value)}},t.options.map((function(e){return a.a.createElement("option",{key:e.value,value:e.value},e.label)})))}}))}))),a.a.createElement("div",{className:"form-group btn-row"},a.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return e.saveForm()}},"Save Changes"),a.a.createElement("button",{type:"button",className:"btn btn-reset",onClick:function(){return e.resetForm()}},"Reset")))}}])&&rt(t.prototype,r),n&&rt(t,n),i}(a.a.Component))||Qe,Ot=r("KnAV");function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Pt(e);if(t){var a=Pt(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return St(this,r)}}function St(e,t){return!t||"object"!==wt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pt(e){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ct=[{value:!0,label:gettext("Active")},{value:!1,label:gettext("Inactive")}],Nt=Object(Se.c)(gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xt(e,t)}(i,e);var t,r,n,o=kt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).toggleChangeLogRowExpando=function(e){t.props.store.toggleChangeLogRowExpando(e)},t.state={original_user_data:{user:{is_active:e.userData.user.is_active}},user_data:{user:{is_active:e.userData.user.is_active}}},t}return t=i,(r=[{key:"save",value:function(){this.props.onSave(this.state.user_data)}},{key:"onChange",value:function(e){var t=this;this.setState({user_data:{user:{is_active:e.value}}},(function(){return t.hasUnsavedDataAction()}))}},{key:"onResendRegistrationEmail",value:function(){this.props.onResendRegistrationEmail()}},{key:"hasUnsavedDataAction",value:function(){this.props.onIsDirtyChange(this.state.user_data.user.is_active==this.state.user_data.user.is_active)}},{key:"onReset",value:function(){var e=this;this.setState({user_data:this.state.original_user_data},(function(){return e.hasUnsavedDataAction()}))}},{key:"render",value:function(){var e=this,t=Ct.find((function(t){return t.value==e.state.user_data.user.is_active})),r=this.props,n=r.history,o=r.store,i=o.changelog_expanded_rows;return a.a.createElement("div",{className:"edit-user-history"},a.a.createElement("h2",{className:"no-bold"},this.state.user_data.name?this.state.user_data.name+": ":"",gettext("Status and History")),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-secondary",onClick:function(){return e.onResendRegistrationEmail()}},gettext("Resend Registration Email"))),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{className:"label--required",htmlFor:"user-status-input"},gettext("Status")),a.a.createElement(Pe.a,{isDisabled:this.props.disabled,options:Ct,value:t,id:"user-status-input",onChange:function(t){return e.onChange(t)}})),!this.props.disabled&&a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return e.save()}},gettext("Save Changes")),a.a.createElement("button",{className:"btn btn-reset",type:"button",onClick:function(){return e.onReset()}},gettext("Reset"))),a.a.createElement(Ot.a,{data:n,expanded_rows:i,toggle_expando_cb:function(e){return o.toggleChangeLogRowExpando(e)}}))}}])&&jt(t.prototype,r),n&&jt(t,n),i}(a.a.Component))||gt,At=r("RCjz"),Dt=r("DDFe"),Rt=r("tnXs");function zt(){return(zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tt(e,t,r){return t&&Ut(e.prototype,t),r&&Ut(e,r),e}function Lt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=qt(e);if(t){var a=qt(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Bt(this,r)}}function Bt(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vt=gettext("None Selected"),Gt=Object(Se.c)((function(e){var t=e.store,r=e.selections;return a.a.createElement("div",{className:"form-group react-multiselect-checkbox"},a.a.createElement("label",{htmlFor:"users_filter"},gettext("Find a User")),a.a.createElement(Ce.a,{value:t.filters.users,options:r,onChange:function(e){return t.changeUserFilter(e)},placeholder:Vt,id:"users_filter"}))})),Wt=Object(Se.c)((function(e){var t=e.store,r=e.selections;return a.a.createElement("div",{className:"form-group react-multiselect-checkbox"},a.a.createElement("label",{htmlFor:"countries_permitted_filter"},gettext("Countries Permitted")),a.a.createElement(Ce.a,{value:t.filters.countries,options:r,onChange:function(e){return t.changeCountryFilter(e)},placeholder:Vt,id:"countries_permitted_filter"}))})),Jt=Object(Se.c)((function(e){var t=e.store,r=e.selections;return a.a.createElement("div",{className:"form-group react-multiselect-checkbox"},a.a.createElement("label",{htmlFor:"base_country_filter"},gettext("Base Country")),a.a.createElement(Ce.a,{value:t.filters.base_countries,options:r,onChange:function(e){return t.changeBaseCountryFilter(e)},placeholder:Vt,id:"base_country_filter"}))})),$t=Object(Se.c)((function(e){var t=e.store,r=e.selections;return a.a.createElement("div",{className:"form-group react-multiselect-checkbox"},a.a.createElement("label",{htmlFor:"programs_filter"},gettext("Programs")),a.a.createElement(Ce.a,{value:t.filters.programs,options:r,onChange:function(e){return t.changeProgramFilter(e)},placeholder:Vt,id:"programs_filter"}))})),Kt=(a.a.Component,a.a.Component,function(e){Lt(r,e);var t=Mt(r);function r(e){var n;return It(this,r),(n=t.call(this,e)).active_child=a.a.createRef(),n.state={current_action:null,current_vals:[]},n}return Tt(r,[{key:"onActionChanged",value:function(e){this.setState({current_action:e.value,current_vals:[]})}},{key:"onChange",value:function(e){this.setState({current_vals:e})}},{key:"onApply",value:function(){var e=this.props.secondaryOptions[this.state.current_action];e&&e.onApply(this.state.current_vals)}},{key:"render",value:function(){var e=this,t=this.props.secondaryOptions[this.state.current_action],r=t&&t.component,n=!this.state.current_action||Array.isArray(this.state.current_vals)&&!this.state.current_vals.length||!this.state.current_vals;return a.a.createElement("div",{className:"controls__bulk-actions"},a.a.createElement("div",{className:"bulk__select"},a.a.createElement(Pe.a,{placeholder:gettext("Bulk Actions"),value:this.props.primaryOptions.find((function(t){return t.value==e.state.current_action})),options:this.props.primaryOptions,onChange:function(t){return e.onActionChanged(t)}})),t&&a.a.createElement("div",{className:"bulk__select"},a.a.createElement(r,{placeholder:gettext("Select..."),value:this.state.current_vals,onChange:function(t){return e.onChange(t)}})),!t&&a.a.createElement("div",{className:"bulk__select"},a.a.createElement(Pe.a,{placeholder:"---",noOptionsMessage:function(){return gettext("No options")}})),a.a.createElement("button",{className:"btn btn-secondary",disabled:n,onClick:function(){return e.onApply()}},gettext("Apply")))}}]),r}(a.a.Component)),Yt=Object(Se.c)((function(e){var t=e.store,r=(t.program_selections,{primary_options:[{label:gettext("Set account status"),value:"set_account_status"},{label:gettext("Add to program"),value:"add_to_program"},{label:gettext("Remove from program"),value:"remove_from_program"}],secondary_options:{set_account_status:{component:function(e){return a.a.createElement(Pe.a,zt({options:t.user_status_options},e))},onApply:function(e){return t.bulkUpdateUserStatus(e.value)}},add_to_program:{component:function(e){return a.a.createElement(Ce.a,zt({options:t.program_bulk_selections},e))},onApply:function(e){return t.bulkAddPrograms(e.map((function(e){return e.value})))}},remove_from_program:{component:function(e){return a.a.createElement(Ce.a,zt({options:t.program_bulk_selections},e))},onApply:function(e){return t.bulkRemovePrograms(e.map((function(e){return e.value})))}}}});return a.a.createElement("div",{id:"user-management-index-view",className:"row"},a.a.createElement(Rt.a,null,a.a.createElement("div",{className:"filter-section"},a.a.createElement(Wt,{store:t,selections:t.countries_selections}),a.a.createElement(Jt,{store:t,selections:t.countries_selections}),a.a.createElement($t,{store:t,selections:t.program_selections}),a.a.createElement("div",{className:"form-group react-multiselect-checkbox"},a.a.createElement("label",{htmlFor:"organization_filter"},gettext("Organization")),a.a.createElement(Ce.a,{value:t.filters.organizations,options:t.organization_selections,onChange:function(e){return t.changeOrganizationFilter(e)},placeholder:Vt,id:"organization_filter"})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"status_filter"},gettext("Status")),a.a.createElement(Pe.a,{value:t.filters.user_status,options:t.user_status_options,onChange:function(e){return t.changeUserStatusFilter(e)},placeholder:Vt,id:"status_filter"})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"admin_role_filter"},gettext("Administrator?")),a.a.createElement(Pe.a,{value:t.filters.admin_role,options:t.admin_role_options,onChange:function(e){return t.changeAdminRoleFilter(e)},placeholder:Vt,id:"admin_role_filter"}))),a.a.createElement("div",{className:"filter-section filter-buttons"},a.a.createElement("button",{className:"btn btn-primary",onClick:function(){return t.applyFilters()}},gettext("Apply")),a.a.createElement("button",{className:"btn btn-reset",onClick:function(){return t.clearFilters()}},gettext("Reset")))),a.a.createElement("div",{className:"col admin-list"},a.a.createElement("header",{className:"page-title"},a.a.createElement("h1",null,gettext("Admin:")," ",a.a.createElement("small",null,gettext("Users")))),a.a.createElement("div",{className:"admin-list__controls"},a.a.createElement(Kt,{primaryOptions:r.primary_options,secondaryOptions:r.secondary_options}),a.a.createElement("div",{className:"controls__buttons"},a.a.createElement("a",{href:"#",tabIndex:"0",className:"btn btn-link btn-add",onClick:function(){return t.createUser()}},a.a.createElement("i",{className:"fas fa-plus-circle"}),gettext("Add user")))),a.a.createElement("div",{className:"admin-list__top-filter"},a.a.createElement(Gt,{store:t,selections:t.user_selections})),a.a.createElement(Dt.a,{isLoading:t.fetching_users_listing||t.applying_bulk_updates},a.a.createElement("div",{className:"admin-list__table"},a.a.createElement(Ne.a,{data:t.users_listing.map((function(e){return t.users[e]})),keyField:"id",HeaderRow:function(e){var r=e.Col,n=e.Row;return a.a.createElement(n,null,a.a.createElement(r,{size:"0.5"},a.a.createElement("input",{type:"checkbox",checked:t.bulk_targets_all,onChange:function(){return t.toggleBulkTargetsAll()}})),a.a.createElement(r,{size:"2",className:"td--stretch"},gettext("User")),a.a.createElement(r,null,gettext("Organization")),a.a.createElement(r,null,gettext("Programs")),a.a.createElement(r,{size:"0.25"},gettext("Status")))},Row:function(e){var r=e.Col,n=e.Row,o=e.data;return a.a.createElement(n,{expanded:o.id==t.editing_target,Expando:Object(Se.c)((function(e){var r=e.Wrapper;return a.a.createElement(r,null,a.a.createElement(Le,{notifyPaneChange:function(e){return t.onProfilePaneChange(e)},new:"new"==o.id,active_pane:t.active_editor_pane,ProfileSection:Object(Se.c)((function(){return a.a.createElement(Dt.a,{isLoading:t.fetching_editing_target||t.saving_user_profile||t.saving_user_programs},a.a.createElement(Xe,{disabled:1==o.organization_id&&!t.is_superuser&&"new"!=o.id,is_superuser:t.is_superuser,new:"new"==o.id,userData:t.editing_target_data.profile,errors:t.editing_errors,key:t.editing_target_data.profile.id,onUpdate:function(e){return t.updateUserProfile(o.id,e)},onCreate:function(e){return t.saveNewUser(e)},onCreateAndAddAnother:function(e){return t.saveNewUserAndAddAnother(e)},organizations:t.organization_selections,onIsDirtyChange:function(e){return t.setActiveFormIsDirty(e)}}))})),ProgramSection:Object(Se.c)((function(){return a.a.createElement(Dt.a,{isLoading:t.fetching_editing_target||t.saving_user_profile||t.saving_user_programs},a.a.createElement(Et,{store:t,user:o,adminUserProgramRoles:t.access.program,adminUserCountryRoles:t.access.countries,onSave:function(e){return t.saveUserPrograms(o.id,e)},onIsDirtyChange:function(e){return t.setActiveFormIsDirty(e)}}))})),HistorySection:Object(Se.c)((function(){return a.a.createElement(Dt.a,{isLoading:t.fetching_editing_target||t.saving_user_profile||t.saving_user_programs},a.a.createElement(Nt,{store:t,disabled:1==o.organization_id&&!t.is_superuser,userData:t.editing_target_data.profile,history:t.editing_target_data.history,onResendRegistrationEmail:function(){return t.resendRegistrationEmail(o.id)},onSave:function(e){return t.updateUserIsActive(o.id,e)},onIsDirtyChange:function(e){return t.setActiveFormIsDirty(e)}}))}))}))}))},a.a.createElement(r,{size:"0.5"},a.a.createElement("input",{type:"checkbox",checked:t.bulk_targets.get(o.id)||!1,onChange:function(){return t.toggleBulkTarget(o.id)}})),a.a.createElement(r,{size:"2",className:"td--stretch"},a.a.createElement("div",{className:"expando-toggle icon__clickable",onClick:function(){return t.toggleEditingTarget(o.id)}},a.a.createElement("div",{className:"expando-toggle__icon"},a.a.createElement(et.a,{icon:t.editing_target==o.id?"caret-down":"caret-right"})),a.a.createElement("div",{className:"expando-toggle__label"},a.a.createElement("i",{className:"fas fa-user"}),"",o.name||"---"," ",o.is_super&&a.a.createElement("span",{className:"badge badge-danger"},gettext("Super Admin"))))),a.a.createElement(r,null,a.a.createElement("i",{className:"fas fa-building"}),"",o.organization_name||"---"),a.a.createElement(r,{className:"text-nowrap"},o.user_programs?a.a.createElement("a",{href:"/tola_management/program/?users[]=".concat(o.id)},a.a.createElement("i",{className:"fas fa-cubes"}),"",interpolate(ngettext("%s program","%s programs",o.user_programs),[o.user_programs])):a.a.createElement("span",null,a.a.createElement("i",{className:"fas fa-cubes"}),"",gettext("0 programs"))),a.a.createElement(r,{size:"0.25"},o.is_active?gettext("Active"):gettext("Inactive")))}}))),a.a.createElement("div",{className:"admin-list__metadata"},a.a.createElement("div",{className:"metadata__count text-muted text-small"},t.users_count?"".concat(t.users_count," ").concat(gettext("users")):"--"),a.a.createElement("div",{className:"metadata__controls"},t.total_pages&&a.a.createElement(At.a,{pageCount:t.total_pages,initialPage:t.current_page,onPageChange:function(e){return t.changePage(e)}})))))})),Qt=new xe(jsContext);i.a.render(a.a.createElement(Yt,{store:Qt}),document.querySelector("#app_root"))},DDFe:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}t.a=function(e){var t=e.children,r=e.isLoading,n=e.className,s=i(e,["children","isLoading","className"]),c=r?"loading":"";return a.a.createElement("div",o({className:"loading-spinner__container "+c+" "+(n||"")},s),a.a.createElement("div",{className:"loading-spinner__overlay"},a.a.createElement("div",{className:"loading-spinner__spinner"})),t)}},KnAV:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),o=r("okNM"),i=r("IP2g"),s=(r("2vnA"),r("v38i"));function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=function(e){var t,r=e.name,n=e.data,o=e.extraTitleText,i=void 0===o?null:o,c=i?a.a.createElement("h4",{className:"disagg-type__title, text-small"},i):null;if("Disaggregation categories"===r&&"object"===l(n)&&null!==n){var u=Object.values(n).sort((function(e,t){return e.custom_sort-t.custom_sort}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("strong",null,r,": "),c,a.a.createElement("ul",{className:"no-list-style"},u.map((function(e,t){return a.a.createElement("li",{key:t},void 0!==e.label&&null!==e.label?e.label:"")}))))}return t=null!=n&&"N/A"!==n?a.a.createElement("span",{className:"change__field__value"},["true","false"].includes(n.toString())?n.toString().replace("t","T").replace("f","F"):n.toString()):a.a.createElement("span",{className:"change__field__value empty-value"},s.c),a.a.createElement("div",{className:"change__field"},a.a.createElement("strong",{className:"change__field__name"},r),": ",t)},f=function(e){var t=e.data,r=e.is_expanded,n=e.toggle_expando_cb;return a.a.createElement("tr",{className:r?"changelog__entry__header is-expanded":"changelog__entry__header",onClick:function(){return n(t.id)}},a.a.createElement("td",{className:"text-nowrap text-action"},a.a.createElement(i.a,{icon:r?"caret-down":"caret-right"}),"",a.a.createElement("strong",null,t.date)),a.a.createElement("td",{className:"text-nowrap"},t.admin_user),a.a.createElement("td",{className:"text-nowrap"},t.pretty_change_type),a.a.createElement("td",null),a.a.createElement("td",null))},d=function(e){return a.a.createElement("tr",{key:e.id,className:"changelog__entry__row"},a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--prev"},e.previous)),a.a.createElement("td",null,a.a.createElement("div",{className:"changelog__change--new"},e.new)))},m=function(e){var t=e.data,r=[],n=a.a.createElement(d,{previous:gettext("No differences found"),new:null,id:1,key:1});if(Array.isArray(t.diff_list)&&0===t.diff_list.length||0===Object.keys(t.diff_list||{}).length)return r.push(n),r;if("user_programs_updated"===t.change_type){if(t.diff_list.base_country){var o=a.a.createElement(p,{name:t.diff_list.base_country.pretty_name,data:t.diff_list.base_country.prev}),i=a.a.createElement(p,{name:t.diff_list.base_country.pretty_name,data:t.diff_list.base_country.new});r.push(a.a.createElement(d,{previous:o,new:i,id:"base_country",key:"base_country"}))}Object.entries(t.diff_list.countries).forEach((function(e){var t=c(e,2),n=t[0],o=t[1],i="".concat(n,"_").concat(o),s=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{name:gettext("Country"),data:o.prev.country}),a.a.createElement(p,{name:gettext("Role"),data:o.prev.role})),u=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{name:gettext("Country"),data:o.new.country}),a.a.createElement(p,{name:gettext("Role"),data:o.new.role}));r.push(a.a.createElement(d,{previous:s,new:u,id:i,key:i}))})),Object.entries(t.diff_list.programs).forEach((function(e){var t=c(e,2),n=t[0],o=t[1],i="".concat(n,"_").concat(o),s=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{name:gettext("Program"),data:o.prev.program}),a.a.createElement(p,{name:gettext("Country"),data:o.prev.country}),a.a.createElement(p,{name:gettext("Role"),data:o.prev.role})),u=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{name:gettext("Program"),data:o.new.program}),a.a.createElement(p,{name:gettext("Country"),data:o.new.country}),a.a.createElement(p,{name:gettext("Role"),data:o.new.role}));r.push(a.a.createElement(d,{previous:s,new:u,id:i,key:i}))}))}else{var s=null,u=!1;if("Country disaggregation updated"===t.pretty_change_type){var l=t.diff_list.filter((function(e){return"disaggregation_type"===e.name}));l[0].prev===l[0].new&&(s=l[0].prev,u=!0)}t.diff_list.forEach((function(e,t){var n="".concat(t,"_").concat(e.pretty_name);if("disaggregation_type"!==e.name||!u){var o=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{key:t,name:e.pretty_name,data:e.prev,id:t,extraTitleText:s})),i=a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{key:t,name:e.pretty_name,data:e.new,id:t,extraTitleText:s}));r.push(a.a.createElement(d,{previous:o,new:i,id:n,key:n}))}}))}return 0===r.length&&r.push(n),r},g=function(e){var t=e.data,r=e.is_expanded,n=e.toggle_expando_cb;return a.a.createElement("tbody",{className:"changelog__entry",key:t.id},a.a.createElement(f,{data:t,is_expanded:r,toggle_expando_cb:n}),r&&a.a.createElement(m,{data:t}))},h=Object(o.c)((function(e){var t=e.data,r=e.expanded_rows,n=e.toggle_expando_cb;return a.a.createElement("table",{className:"table table-sm bg-white table-bordered text-small changelog"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{className:"text-nowrap"},gettext("Date")),a.a.createElement("th",{className:"text-nowrap"},gettext("Admin")),a.a.createElement("th",{className:"text-nowrap"},gettext("Change Type")),a.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("Previous Entry")),a.a.createElement("th",{className:"text-nowrap td--half-stretch"},gettext("New Entry")))),t.map((function(e){var t=!0;return r&&(t=r.has(e.id)),a.a.createElement(g,{key:e.id,data:e,is_expanded:t,toggle_expando_cb:n})})))}));t.a=h},RCjz:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),o=r("I+5a"),i=r.n(o);r("okNM");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}t.a=function(e){return a.a.createElement(i.a,s({previousLabel:"",previousClassName:"page-item previous",previousLinkClassName:"page-link",nextLabel:"",nextClassName:"page-item next",nextLinkClassName:"page-link",breakLabel:"...",disabledClassName:"disabled",breakClassName:"page-item disabled",breakLinkClassName:"page-link",pageClassName:"page-item",pageLinkClassName:"page-link",marginPagesDisplayed:2,pageRangeDisplayed:5,containerClassName:"pagination",activeClassName:"active"},e))}},TGVD:function(e,t,r){"use strict";var n=r("okNM"),a=r("q1tI"),o=r.n(a),i=r("TSYQ"),s=r.n(i);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=function(e){var t=e.className,r=(e.size,u(e,["className","size"]));return o.a.createElement("td",c({className:["mgmt-table__col",t].join(" ")},r),r.children)},p=function(e){var t=e.className,r=e.size,n=u(e,["className","size"]);return o.a.createElement("th",c({className:["mgmt-table__col","mgmt-table__col__width-".concat(r),t].join(" ")},n),n.children)},f=function(e){var t=e.className,r=u(e,["className"]);return o.a.createElement("tr",c({className:["mgmt-table__row",t].join(" ")},r),r.children)},d=function(e){var t=e.className,r=u(e,["className"]);return o.a.createElement("tr",c({className:["mgmt-table__row table-header",t].join(" ")},r),r.children)},m=Object(n.c)((function(e){var t=e.className,r=e.expanded,a=e.Expando,i=u(e,["className","expanded","Expando"]);if(a){var l=Object(n.c)(a);return o.a.createElement("tbody",c({className:s()(["mgmt-table__body",t].join(" "),{"is-expanded":r})},i),o.a.createElement(f,null,i.children),r&&o.a.createElement(l,{Wrapper:g}))}return o.a.createElement("tbody",c({className:["mgmt-table__body",t].join(" ")},i),o.a.createElement(f,null,i.children))})),g=function(e){var t=e.className,r=u(e,["className"]);return o.a.createElement("tr",c({className:["mgmt-table__row--expanded",t].join(" ")},r),o.a.createElement("td",{colSpan:"5"},r.children))},h=Object(n.c)((function(e){var t=e.data,r=e.Row,a=e.keyField,i=(u(e,["data","Row","keyField"]),Object(n.c)(r));return t.map((function(e){return o.a.createElement(i,{key:e[a],data:e,Col:l,Row:m})}))})),y=Object(n.c)((function(e){var t=e.HeaderRow,r=e.className,a=u(e,["HeaderRow","className"]),i=Object(n.c)(t);return o.a.createElement("table",{className:["table bg-white",r].join(" ")},o.a.createElement("thead",null,o.a.createElement(i,{Col:p,Row:d})),o.a.createElement(h,a))}));t.a=y},"WtQ/":function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return i}));function n(){$((function(){var e=0===window.performance.getEntriesByType("navigation")[0].transferSize,t="reload"===window.performance.getEntriesByType("navigation")[0].type;e&&!t&&window.location.reload()}))}var a=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t,r=e.toString(),n=null;switch(e.toString().includes(",")?(r=e.toString().split(",")[0],n=e.toString().split(",").length>1?e.toString().split(",")[1]:null):e.toString().includes(".")&&(r=e.toString().split(".")[0],n=e.toString().split(".").length>1?e.toString().split(".")[1]:null),n=n&&n.length>0?n:null,window.userLang){case"es":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,"."),n&&(t+=",".concat(n));break;case"fr":t=r.replace(/\B(?=(\d{3})+(?!\d))/g,String.fromCharCode(160)),n&&(t+=",".concat(n));break;case"en":default:t=r.replace(/\B(?=(\d{3})+(?!\d))/g,","),n&&(t+=".".concat(n))}return t},o=function(e){if(null==e||isNaN(parseFloat(e)))return null;var t=a(Math.round(1e4*e)/100);return null===t?null:"".concat(t,"%")},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label";return e.sort((function(e,r){return e[t].toUpperCase()>r[t].toUpperCase()?1:-1}))}},XoI5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("vDqi"),a=r.n(n).a.create({withCredentials:!0,baseURL:"/api/",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")}})},Z2Y6:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n),o=r("c7k8");r("Cs6D");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var a=p(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f,d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(l,e);var t,r,n,i=u(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).cache=new o.c({fixedWidth:!0,defaultHeight:35}),t.filter_val="",t}return t=l,(r=[{key:"render",value:function(){var e=this,t=this.props,r=(t.options,t.children),n=t.maxHeight,i=(t.getValue,t.selectProps),s=r.length||0;return i.inputValue!==this.filter_val&&(this.filter_val=i.inputValue,this.cache.clearAll()),a.a.createElement("div",{style:{display:"flex",height:"100vh",maxHeight:n+"px"}},a.a.createElement("div",{style:{flex:"1 1 auto"}},a.a.createElement(o.a,null,(function(t){var n=t.width,i=t.height;return a.a.createElement(o.e,{height:i,width:n,deferredMeasurementCache:e.cache,rowCount:s,rowHeight:e.cache.rowHeight,noRowsRenderer:function(){return a.a.createElement("div",null,"No selections available")},rowRenderer:function(t){var n=t.index,i=t.parent,s=t.key,c=t.style;return a.a.createElement(o.b,{key:s,cache:e.cache,parent:i,columnIndex:0,rowIndex:n},a.a.createElement("div",{style:c},r[n]))}})}))))}}])&&s(t.prototype,r),n&&s(t,n),l}(a.a.PureComponent),m=r("VCnP"),g=r.n(m),h=r("oary"),y=r.n(h),_=r("PAeb"),b=r("okNM");function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k(e);if(t){var a=k(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var N=function(e){return a.a.createElement("div",{className:"count__label"},e.children,e.clearable&&a.a.createElement("div",{onClick:e.clearSelect},a.a.createElement("i",{className:"fa fa-times","aria-hidden":"true"})))};function A(e){if(!1===e.data.selectable){e.children;var t=e.className,r=e.cx,n=e.getStyles,o=(e.Heading,e.setValue,e.data,e.label,e.getValue,e.theme),i=(e.selectProps.getOptionValue,{getStyles:n,cx:r,theme:o,indeterminate:!1,checked:!1});return a.a.createElement("div",{className:r(Object(_.css)(n("group",e)),{group:!0},t)},a.a.createElement("div",{className:r(Object(_.css)(n("groupHeading",P({},i))),{"group-heading":!0},t)},e.data.label),a.a.createElement("div",null,e.children))}return!0===e.data.divider?a.a.createElement(a.a.Fragment,null,a.a.createElement("hr",{style:{margin:"3px 0px 0px 0px"}}),a.a.createElement(y.a,e)):a.a.createElement(y.a,e)}var D=Object(b.c)(f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(i,e);var t,r,n,o=j(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).clearSelect=function(e){e.stopPropagation(),t.props.onChange([])},t.makeLabel=function(e){var r=e.placeholderButtonLabel,n=e.value;if(!n)return a.a.createElement(N,{clearable:!1},r);if(Array.isArray(n)){var o=n.filter((function(e){return!e.noList}));return 0===o.length?a.a.createElement(N,{clearable:!1},r):1===o.length?a.a.createElement(N,{clearable:!0,clearSelect:t.clearSelect},o[0].label):a.a.createElement(N,{clearable:!0,clearSelect:t.clearSelect},"".concat(o.length," ",gettext("selected")))}return a.a.createElement(N,{clearable:!1},n.label)},t}return t=i,(r=[{key:"render",value:function(){return a.a.createElement(g.a,E({},this.props,{placeholder:gettext("Search"),placeholderButtonLabel:this.props.placeholder,getDropdownButtonLabel:this.makeLabel,components:{MenuList:d,Group:A}}))}}])&&O(t.prototype,r),n&&O(t,n),i}(a.a.Component))||f;t.a=D},tnXs:function(e,t,r){"use strict";var n=r("q1tI"),a=r.n(n);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var a=f(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(p,e);var t,r,n,o=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=o.call(this,e)).updateDimensions=function(){t.state.folded||t.state.folding||t.setState((function(){return{resize:!0}}),(function(){t.contentWidth=t.contentsContainer.current.offsetWidth,t.setState({resize:!1})}))},t.state={folding:!1,folded:!1,resize:!1},t.contentsContainer=a.a.createRef(),t}return t=p,(r=[{key:"componentDidMount",value:function(){this.contentWidth=this.contentsContainer.current.offsetWidth,window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"toggleFolded",value:function(){this.state.folding?this.foldComplete():this.setState({folding:!0,folded:!this.state.folded})}},{key:"foldComplete",value:function(){this.setState((function(){return{folding:!1}}),this.updateDimensions)}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,n=s(t,["className"]),o=this.state.folded?this.state.folding?"fa-angle-double-left":"fa-chevron-right":this.state.folding?"fa-angle-double-right":"fa-chevron-left",c=this.state.folded?"0px":this.state.resize?"auto":this.contentWidth+"px",u=this.state.folded||this.state.folding?"hidden":"visible";return a.a.createElement("div",i({className:"folding-sidebar "+(r||"")},n),a.a.createElement("div",{className:"folding-sidebar__contents",onTransitionEnd:function(){return e.foldComplete()},ref:this.contentsContainer,style:{width:c,overflow:u}},a.a.createElement(a.a.Fragment,null,this.props.children)),a.a.createElement("div",{className:"folding-sidebar__trigger",onClick:function(){return e.toggleFolded()}},a.a.createElement("i",{key:o},a.a.createElement("span",{className:"fa "+o}))))}}])&&c(t.prototype,r),n&&c(t,n),p}(a.a.Component);t.a=d},v38i:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"l",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"k",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"m",(function(){return p})),r.d(t,"j",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return m})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return y}));var a={value:null,label:"---------"},o="",i=o,s=1,c=2,u=[3,4,5,6,7],l=[1,2],p=Object.freeze({1:gettext("Life of Program (LoP) only"),2:gettext("Midline and endline"),3:gettext("Annual"),4:gettext("Semi-annual"),5:gettext("Tri-annual"),6:gettext("Quarterly"),7:gettext("Monthly")}),f=Object.freeze({3:gettext("Years"),4:gettext("Semi-annual periods"),5:gettext("Tri-annual periods"),6:gettext("Quarters"),7:gettext("Months")}),d=1,m=2;"undefined"!=typeof gettext&&gettext;var g,h=Object.freeze({noFilter:0,missingTarget:1,missingResults:2,missingEvidence:3,aboveTarget:5,belowTarget:6,onTarget:7,nonReporting:8}),y=null!==(g="reason_for_change_options",n="undefined"!=typeof JS_GLOBALS&&JS_GLOBALS.hasOwnProperty(g)?JS_GLOBALS[g]:null)&&void 0!==n?n:[]}},[["9KAa",0,1]]]);
//# sourceMappingURL=tola_management_user-0f6cf0ba17607a1fb703.js.map
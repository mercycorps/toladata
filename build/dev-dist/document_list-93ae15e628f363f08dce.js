(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{LBcr:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return i}));var n=window.userLang,o="numeric",a={year:o,month:"short",day:o};function c(e){return new Date(e)}function i(e){return new Intl.DateTimeFormat(n,a).format(e)}},Wr7D:function(e,t,r){"use strict";r.r(t);var n,o,a,c=r("q1tI"),i=r.n(c),l=r("i8i4"),u=r.n(l),s=r("wgi2"),d=r("0pHI"),m=r("qtBC"),p=(r("TSYQ"),r("okNM")),f=r("QL2g"),b=r.n(f),g=r("FoaG"),y=r.n(g),h=r("Cs6D"),v=r("LBcr");function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return t&&j(e.prototype,t),r&&j(e,r),e}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=x(e);if(t){var o=x(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?_(e):t}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){var r=e.documents;return t.selectedProgramId&&(r=r.filter((function(e){return e.program===t.selectedProgramId}))),t.selectedProjectId&&(r=r.filter((function(e){return e.project&&e.project.id===t.selectedProjectId}))),r}var C,z,N,F,T,R,A,q,B=Object(p.c)(n=function(e){I(r,e);var t=D(r);function r(e){var n;return P(this,r),(n=t.call(this,e)).onSelection=n.onSelection.bind(_(n)),n}return w(r,[{key:"onSelection",value:function(e){var t=e?e.value:null;m.a.emit("program-id-filter-selected",t)}},{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=t.programs,o=r.selectedProgramId,a=n.map((function(e){return{value:e.id,label:e.name}})),c=null;return o&&(c=a.find((function(e){return e.value===o}))),i.a.createElement(h.a,{options:a,value:c,isClearable:!0,placeholder:gettext("Filter by program"),onChange:this.onSelection})}}]),r}(i.a.Component))||n,L=Object(p.c)(o=function(e){I(r,e);var t=D(r);function r(e){var n;return P(this,r),(n=t.call(this,e)).onSelection=n.onSelection.bind(_(n)),n}return w(r,[{key:"onSelection",value:function(e){var t=e?e.value:null;m.a.emit("document-id-filter-selected",t)}},{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=k(t,r),o=r.selectedDocumentId,a=n.map((function(e){return{value:e.id,label:e.name}})),c=null;return o&&(c=a.find((function(e){return e.value===o}))),i.a.createElement(h.a,{options:a,value:c,isClearable:!0,placeholder:gettext("Find a document"),onChange:this.onSelection})}}]),r}(i.a.Component))||o,H=Object(p.c)(a=function(e){I(r,e);var t=D(r);function r(){return P(this,r),t.apply(this,arguments)}return w(r,[{key:"render",value:function(){var e=this.props,t=e.rootStore,r=e.uiStore,n=e.readonly;return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},i.a.createElement(B,{rootStore:t,uiStore:r})),i.a.createElement("div",{className:"col-3"},i.a.createElement(L,{rootStore:t,uiStore:r})),i.a.createElement("div",{className:"col-3 text-right"},!n&&i.a.createElement("a",{href:"/workflow/documentation_add",className:"btn btn-link btn-add"},i.a.createElement("i",{className:"fas fa-plus-circle"})," ",gettext("Add document"))))}}]),r}(i.a.Component))||a,J=Object(p.c)((function(e){var t=e.rootStore,r=e.uiStore,n=e.access,o=k(t,r);if(r.selectedDocumentId&&(o=o.filter((function(e){return e.id===r.selectedDocumentId}))),0===o.length)return i.a.createElement("div",null,i.a.createElement("span",null,"No documents available"));var a=[{dataField:"name",text:gettext("Document"),sort:!0,formatter:function(e,t){return i.a.createElement("a",{href:t.url,target:"_blank"},t.name)}},{dataField:"create_date",text:gettext("Date added"),sort:!0,formatter:function(e,t){return i.a.createElement("span",null,Object(v.b)(Object(v.a)(t.create_date)))}},{dataField:"project.project_name",text:gettext("Project"),hidden:!t.allowProjectsAccess},{dataField:"actions",isDummyField:!0,text:"",align:"right",formatter:function(e,t){return!n[t.program]||"high"!=n[t.program].role&&"medium"!=n[t.program].role?null:i.a.createElement("div",{className:"text-nowrap"},i.a.createElement("a",{href:"/workflow/documentation_delete/"+t.id,className:"btn p-0 pr-4 btn-sm btn-text text-danger"},i.a.createElement("i",{className:"fas fa-trash-alt"})," ",gettext("Delete")),i.a.createElement("a",{href:"/workflow/documentation_update/"+t.id,className:"btn p-0 btn-sm btn-text"},i.a.createElement("i",{className:"fas fa-edit"})," ",gettext("Edit")))}}],c={prePageText:"‹",nextPageText:"›",firstPageText:"«",lastPageText:"»",sizePerPage:50,showTotal:!0,paginationTotalRenderer:function(e,t,r){var n=interpolate(gettext("Showing rows %(fromCount)s to %(toCount)s of %(totalCount)s"),{fromCount:e,toCount:t,totalCount:r},!0);return i.a.createElement("span",{className:"metadata__count text-muted text-small"}," ",n)}};return i.a.createElement(b.a,{keyField:"id",data:o,columns:a,bootstrap4:!0,pagination:y()(c),defaultSorted:[{dataField:"create_date",order:"desc"}]})})),Q=Object(p.c)((function(e){var t=e.rootStore,r=e.uiStore,n=e.readonly,o=e.access;return i.a.createElement(i.a.Fragment,null,i.a.createElement(H,{rootStore:t,uiStore:r,readonly:n}),i.a.createElement("br",null),i.a.createElement(J,{rootStore:t,uiStore:r,access:o}))})),W=r("2vnA");function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t,r,n,o){var a={};return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var U=(z=K((C=function e(t,r,n){Y(this,e),M(this,"documents",z,this),M(this,"programs",N,this),M(this,"allowProjectsAccess",F,this),this.documents=t,this.programs=r,this.allowProjectsAccess=n}).prototype,"documents",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=K(C.prototype,"programs",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=K(C.prototype,"allowProjectsAccess",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C),V=(R=K((T=function(){function e(){Y(this,e),M(this,"selectedProgramId",R,this),M(this,"selectedDocumentId",A,this),M(this,"selectedProjectId",q,this),this.setSelectedProgramId=this.setSelectedProgramId.bind(this),this.clearSelectedProgramId=this.clearSelectedProgramId.bind(this),this.setSelectedDocumentId=this.setSelectedDocumentId.bind(this),this.clearSelectedDocumentId=this.clearSelectedDocumentId.bind(this),this.setSelectedProjectId=this.setSelectedProjectId.bind(this),this.clearSelectedProjectId=this.clearSelectedProjectId.bind(this)}var t,r,n;return t=e,(r=[{key:"setSelectedProgramId",value:function(e){this.selectedProgramId=e}},{key:"clearSelectedProgramId",value:function(){this.selectedProgramId=null}},{key:"setSelectedDocumentId",value:function(e){this.selectedDocumentId=e}},{key:"clearSelectedDocumentId",value:function(){this.selectedDocumentId=null}},{key:"setSelectedProjectId",value:function(e){this.selectedProjectId=e}},{key:"clearSelectedProjectId",value:function(){this.selectedProjectId=null}}])&&G(t.prototype,r),n&&G(t,n),e}()).prototype,"selectedProgramId",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=K(T.prototype,"selectedDocumentId",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=K(T.prototype,"selectedProjectId",[W.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K(T.prototype,"setSelectedProgramId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"setSelectedProgramId"),T.prototype),K(T.prototype,"clearSelectedProgramId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"clearSelectedProgramId"),T.prototype),K(T.prototype,"setSelectedDocumentId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"setSelectedDocumentId"),T.prototype),K(T.prototype,"clearSelectedDocumentId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"clearSelectedDocumentId"),T.prototype),K(T.prototype,"setSelectedProjectId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"setSelectedProjectId"),T.prototype),K(T.prototype,"clearSelectedProjectId",[W.d],Object.getOwnPropertyDescriptor(T.prototype,"clearSelectedProjectId"),T.prototype),T);function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ee=jsContext,te=ee.documents,re=ee.programs,ne=ee.allowProjectsAccess,oe=ee.readonly,ae=ee.access,ce=new U(te,re,ne),ie=new V;var le=Object(s.b)([{name:"documents",path:"/?program_id&project_id&document_id"}],{defaultRoute:"all",defaultParams:{}});le.usePlugin(Object(d.a)({useHash:!1,base:"/workflow/documentation_list"})),le.subscribe((function(e){e.previousRoute;var t=e.route.params;t.program_id?ie.setSelectedProgramId(parseInt(t.program_id)):ie.clearSelectedProgramId(),t.document_id?ie.setSelectedDocumentId(parseInt(t.document_id)):ie.clearSelectedDocumentId(),t.project_id?ie.setSelectedProjectId(parseInt(t.project_id)):ie.clearSelectedProjectId()})),le.start(),m.a.on("program-id-filter-selected",(function(e){e?le.navigate("documents",{program_id:e}):le.navigate("documents")})),m.a.on("document-id-filter-selected",(function(e){var t=ie.selectedProgramId,r={};t&&(r.program_id=t),e&&(r.document_id=e),le.navigate("documents",r)}));var ue=ae.programs.reduce((function(e,t){return Z(Z({},e),{},$({},t.program,t))}),{});u.a.render(i.a.createElement(Q,{rootStore:ce,uiStore:ie,readonly:oe,access:ue}),document.querySelector("#documents-view"))},qtBC:function(e,t,r){"use strict";var n=r("7+Rn"),o=r.n(n)()();t.a=o}},[["Wr7D",0,1]]]);
//# sourceMappingURL=document_list-93ae15e628f363f08dce.js.map
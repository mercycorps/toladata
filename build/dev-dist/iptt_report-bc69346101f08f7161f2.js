(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1d5Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return d}));var n=r("2vnA"),a=r("5/4V");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l="undefined"!=typeof gettext?gettext:function(e){return e},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pk:parseInt(e.pk),name:e.name,resultsFramework:Boolean(e.results_framework),_resultChainFilterLabel:e.by_result_chain||l("by Outcome chain"),get resultChainFilterLabel(){return this.resultsFramework?this._resultChainFilterLabel:null}}},c=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[s].concat(t).reduce((function(t,r){return Object(n.i)(t,r(e))}),{})}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{reportingPeriodStart:new Date(e.reporting_period_start_iso),reportingPeriodEnd:new Date(e.reporting_period_end_iso)}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_indicatorsLevelOrder:Object(n.n)(e.indicator_pks_level_order||[]),_indicatorsChainOrder:Object(n.n)(e.indicator_pks_chain_order||[]),_applyOrderUpdate:function(e){var t=this;Object(n.p)((function(){return t._indicatorsLevelOrder=e.indicator_pks_level_order||[],t._indicatorsChainOrder=e.indicator_pks_chain_order||[],Object.entries(e.indicators||{}).forEach((function(e){var r=i(e,2),n=r[0],a=r[1];!isNaN(parseInt(n))&&t.indicators.has(parseInt(n))&&t.indicators.get(parseInt(n)).updateData(a)})),e}))},updateOrder:function(){return a.a.programLevelOrdering(this.pk).then(this._applyOrderUpdate.bind(this))},get indicatorsInLevelOrder(){var e=this;return this._indicatorsLevelOrder.map((function(t){return e.indicators.get(t)}))},get indicatorsInChainOrder(){var e=this;return this.hasOwnProperty("resultsFramework")&&!1===this.resultsFramework?this.indicatorsInLevelOrder:this._indicatorsChainOrder.map((function(t){return e.indicators.get(t)}))}}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_levelsLevelOrder:Object(n.n)(e.level_pks_level_order||[]),_levelsChainOrder:Object(n.n)(e.level_pks_chain_order||[]),_unassignedIndicators:Object(n.n)(e.unassigned_indicator_pks||[]),levelIndicators:Object(n.n)(new Map((e.indicator_pks_for_level||[]).map((function(e){return[e.pk,e.indicator_pks]})))),updateOrder:function(){var e=this;return a.a.rfLevelOrdering(this.pk).then((function(t){Object(n.p)((function(){return e._levelsLevelOrder=t.level_pks_level_order||[],e._levelsChainOrder=t.level_pks_chain_order||[],e._unassignedIndicators=t.unassigned_indicator_pks||[],e._updateLevelIndicatorsOrder(t.indicator_pks_for_level),!0}))}))},get levelsInLevelOrder(){var e=this;return this._levelsLevelOrder.map((function(t){return e.levels.get(t)}))||[]},get levelsInChainOrder(){var e=this;return this.hasOwnProperty("resultsFramework")&&!1===this.resultsFramework?this.levelsInLevelOrder:this._levelsChainOrder.map((function(t){return e.levels.get(t)}))||[]},get unassignedIndicators(){var e=this;return this._unassignedIndicators.map((function(t){return e.indicators.get(t)}))||[]},get indicatorsInLevelOrder(){var e=this;return this.resultsFramework?Array.prototype.concat.apply([],this.levelsInLevelOrder.map((function(t){return e.levelIndicators.get(t.pk).filter((function(t){return e.indicators.has(t)})).map((function(t){return e.indicators.get(t)}))}))).concat(this.unassignedIndicators):this.unassignedIndicators},get indicatorsInChainOrder(){var e=this;return this.resultsFramework?Array.prototype.concat.apply([],this.levelsInChainOrder.map((function(t){return e.levelIndicators.get(t.pk).filter((function(t){return e.indicators.has(t)})).map((function(t){return e.indicators.get(t)}))}))).concat(this.unassignedIndicators):this.unassignedIndicators},_updateLevelIndicatorsOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(n.p)((function(){e.levelIndicators.clear(),t.forEach((function(t){var r=t.pk,n=t.indicator_pks;e.levelIndicators.set(r,n)}))}))}}}},"4L+s":function(e,t,r){"use strict";r.d(t,"b",(function(){return g})),r.d(t,"a",(function(){return h}));var n=r("q1tI"),a=r.n(n),i=r("i8i4"),o=r.n(i);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var a=m(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){u(o,e);var t,r,n,i=d(o);function o(e){var t;return s(this,o),(t=i.call(this,e)).placement=e.placement||null,t.popoverRef=e.innerRef||a.a.createRef(),t.iconClass=e.iconClass||"far fa-question-circle",t.iconStyle=e.iconStyle||{},t.linkStyle={},e.linkHeight&&(t.linkStyle.height=e.linkHeight),t}return t=o,(r=[{key:"render",value:function(){return a.a.createElement("a",{tabIndex:"0",style:this.linkStyle,"data-toggle":"popover","data-trigger":"focus","data-html":"true","data-placement":this.placement,"data-content":this.props.content,className:this.props.className,ref:this.popoverRef},a.a.createElement("i",{"aria-label":this.props.ariaText,style:this.iconStyle,className:this.iconClass}))}}])&&c(t.prototype,r),n&&c(t,n),o}(a.a.Component),h=function(e){u(r,e);var t=d(r);function r(){var e;s(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).popoverName="base",e.componentDidMount=function(){e.bodyClickHandler=function(t){0==$("#".concat(e.popoverName,"_popover_content")).parent().find($(t.target)).length&&$(e.refs.target).popover("hide")};var t=function(){$("body").on("click",e.bodyClickHandler),$(e.refs.target).popover("update").on("hide.bs.popover",(function(){$("body").off("click",e.bodyClickHandler)}))};$(e.refs.target).popover({content:'<div id="'.concat(e.popoverName,'_popover_content"></div>'),html:!0,placement:"bottom"}).on("shown.bs.popover",(function(r){o.a.render(e.getPopoverContent(),document.querySelector("#".concat(e.popoverName,"_popover_content")),t)}))},e.getPopoverContent=function(){throw new Error("not implemented")},e}return r}(a.a.Component)},"5/4V":function(e,t,r){"use strict";var n=r("vDqi"),a=r.n(n),i=r("Qyje"),o=r.n(i),l={apiInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"json",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")}}),documentInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"document",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1")},transformResponse:[function(e){return(new XMLSerializer).serializeToString(e)}]}),formPostInstance:a.a.create({withCredentials:!0,baseURL:"/indicators/api/",responseType:"json",headers:{"X-CSRFToken":document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),"content-type":"application/x-www-form-urlencoded"}}),logFailure:function(e){console.log("api call failed:",e)},getProgramPageUrl:function(e){return!isNaN(parseInt(e))&&"/program/".concat(e,"/")},programLevelOrdering:function(e){return this.apiInstance.get("/program/ordering/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},rfLevelOrdering:function(e){return this.apiInstance.get("/program/level_ordering/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},indicatorResultsTable:function(e,t){return this.documentInstance.get("/result_table/".concat(e,"/"),{params:{raw:!0,edit:t}}).then((function(e){return e.data})).catch(this.logFailure)},updateProgramPageIndicator:function(e){return this.apiInstance.get("/program_page/indicator/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},updateAllProgramPageIndicators:function(e){return this.apiInstance.get("/program_page/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)},ipttFilterData:function(e){return this.apiInstance.get("/iptt/".concat(e,"/filter_data/")).then((function(e){return e.data})).catch(this.logFailure)},getIPTTReportData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.programPk,r=e.frequency,n=e.reportType;return this.apiInstance.get("/iptt/".concat(t,"/report_data/"),{params:{frequency:r,report_type:n}}).then((function(e){return e.data})).catch(this.logFailure)},savePinnedReport:function(e){return this.formPostInstance.post("/pinned_report/",o.a.stringify(e)).catch(this.logFailure)},updateIPTTIndicator:function(e){return this.apiInstance.get("/iptt/indicator/".concat(e,"/")).then((function(e){return e.data})).catch(this.logFailure)}};t.a=l},Ez0T:function(e,t,r){"use strict";r.d(t,"d",(function(){return h})),r.d(t,"a",(function(){return v})),r.d(t,"c",(function(){return _})),r.d(t,"b",(function(){return O}));var n=r("q1tI"),a=r.n(n),i=r("Cs6D"),o=r("VCnP"),l=r.n(o),s=0;function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";return s++,"".concat(e).concat(s)}var u=r("v38i");function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(e){var t=c("react-select"),r=e.labelClasses||"col-form-label text-uppercase",n=e.formRowClasses||"form-row mb-3",o=e.selectClasses||"tola-react-select";return a.a.createElement("div",{className:n},a.a.createElement("label",{htmlFor:t,className:r},e.label),a.a.createElement(i.a,{onChange:e.update,value:e.value,id:t,className:o,isDisabled:e.disabled,options:e.options}))},v=function(e){var t=c("date-select"),r=e.options&&1==e.options.length&&void 0!==e.options[0].value?a.a.createElement("option",{value:e.options[0].value},e.options[0].label):e.options&&e.options.length>0&&e.options[0].options&&void 0!==e.options[0].options?e.options.map((function(e,t){return a.a.createElement("optgroup",{label:e.label,key:t},e.options.map((function(e){return a.a.createElement("option",{value:e.value,key:e.value},e.label)})))})):e.options.map((function(e,t){return a.a.createElement("option",{value:e.value,key:t},e.label)}));return a.a.createElement("div",{className:"form-row mb-3"},a.a.createElement("label",{htmlFor:t,className:"col-form-label text-uppercase"},e.label),a.a.createElement("select",{className:"form-control",id:t,value:e.value,onChange:e.update,disabled:e.disabled},r))},b=function(e){var t=c("react-select"),r=e.formGroupClass||"form-row mb-3",n=e.labelClass||"col-form-label text-uppercase",i=e.selectClass||"form-control";return a.a.createElement("div",{className:r},a.a.createElement("label",{htmlFor:t,className:n},e.label),a.a.createElement("select",{onChange:e.update,value:e.value,id:t,className:i,disabled:e.disabled},e.options))},y=function(e){return""==e.children?a.a.createElement("div",null):a.a.createElement(a.a.Fragment,null,a.a.createElement("hr",{style:{margin:"3px 0px 0px 0px"}}),a.a.createElement("div",{className:"text-muted",style:{textTransform:"uppercase",paddingLeft:"4px",marginBottom:"2px"}},e.children))},_=function(e){var t=c("multiselect"),r=!e.options||0==e.options.length||1==e.options.length&&null===e.options[0].value,n=r?{getDropdownButtonLabel:function(){return gettext("None available")},isDisabled:!0,menuIsOpen:!1,options:[]}:{isMulti:!0,options:e.options,getDropdownButtonLabel:function(e){if(!e.value)return gettext("None selected");if(Array.isArray(e.value)){var t=e.value.filter((function(e){return!e.noList}));return 0==t.length?gettext("None selected"):1==t.length?t[0].label:"".concat(t.length,"  ").concat(gettext("selected"))}return e.value.label}},i={dropdownButton:function(e){return r?m(m({},e),{},{backgroundColor:"#E5E6E8",background:""}):e},option:function(e,t){return m(m({},e),{},{padding:"1px 12px",display:"inline-block"})},container:function(e,t){return m(m({},e),{},{backgroundColor:"#f5f5f5"})}};return a.a.createElement("div",{className:"form-row mb-2 tola-react-multiselect-row"},a.a.createElement("label",{htmlFor:t,className:"col-form-label text-uppercase"},e.label),a.a.createElement(l.a,d({id:t,styles:i,formatOptionLabel:function(e){return a.a.createElement("div",{style:{display:"inline-block",float:"right",width:"90%"}},e.label)},components:{GroupHeading:y},value:e.value,onChange:e.update},n)))},O=function(e){var t=e.chainLabel,r=p(e,["chainLabel"]),n=[a.a.createElement("option",{value:u.d,key:1},t),a.a.createElement("option",{value:u.e,key:2},gettext("by Level"))];return a.a.createElement(b,d({label:gettext("Group indicators"),options:n},r))}},"My+N":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return s}));var n=r("2vnA"),a=r("NHe6"),i=r("v38i"),o=("undefined"!=typeof gettext&&gettext,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pk:parseInt(e.pk),name:e.name,levelPk:!isNaN(parseInt(e.level_pk))&&parseInt(e.level_pk),oldLevelDisplay:e.old_level_name||!1,meansOfVerification:e.means_of_verification||!1}}),l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return[o].concat(t).reduce((function(t,r){return Object(n.i)(t,r(e))}),{})}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_formatDecimal:a.a,frequency:parseInt(e.target_frequency),get timeAware(){return i.k.includes(this.frequency)},unitOfMeasure:e.unit_of_measure||!1,isPercent:Boolean(e.is_percent),isCumulative:Boolean(e.is_cumulative),directionOfChange:e.direction_of_change||!1,baseline:e.baseline||null,_lopTarget:e.lop_target||null,_lopActual:e.lop_actual||null,_lopMet:e.lop_met||null,_lopTargetProgress:e.lop_target_progress||null,_lopActualProgress:e.lop_actual_progress||null,_lopMetProgress:e.lop_met_progress||null,get lopTarget(){return this._formatDecimal(this._lopTarget)},get lopActual(){return this._formatDecimal(this._lopActual)},get lopMet(){return this._formatDecimal(this._lopMet)},get lopTargetProgress(){return this._formatDecimal(this._lopTargetProgress)},get lopActualProgress(){return this._formatDecimal(this._lopActualProgress)},get lopMetProgress(){return this._formatDecimal(this._lopMetProgress)}}}},NHe6:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return!isNaN(parseFloat(e))&&(e=parseFloat(e),Number.isInteger(e)?parseInt(e):e)}},OtFd:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("2vnA"),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{frequency:parseInt(e.frequency),get periodCount(){return this.periods.length},get currentPeriod(){return[1,2,8].includes(this.frequency)?null:this.periods.filter((function(e){return e.past})).length-1},getLabel:function(e){return[3,4,5,6].includes(this.frequency)?"".concat(e.name," (").concat(e.label,")"):7==this.frequency?e.name:void 0},get options(){var e=this;return this.periods.map((function(t,r){return{value:r,label:e.getLabel(t),year:t.year}}))}}},i=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return[a].concat(t).reduce((function(t,r){return Object(n.i)(t,r(e))}),{})}}},mYfJ:function(e,t,r){"use strict";r.r(t);var n,a=r("q1tI"),i=r.n(a),o=r("i8i4"),l=r.n(o),s=r("okNM"),c=r("Ez0T");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var a=g(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h,v,b,y,_,O=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.d,{label:gettext("Program"),options:t.programOptions,value:t.selectedProgramOption,update:function(e){t.selectedProgramOption=e}})}))),S=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.d,{label:t.isTVA?gettext("Target periods"):gettext("Time periods"),options:t.frequencyOptions,disabled:t.frequencyDisabled,value:t.selectedFrequencyOption,update:function(e){t.selectedFrequencyOption=e}})}))),P=Object(s.b)("filterStore")(n=Object(s.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,e);var t,r,n,a=f(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).checkMostRecent=function(e){var r=isNaN(parseInt(t.state.mostRecentValue))?2:parseInt(t.state.mostRecentValue);t.setState({mostRecentValue:r}),t.mostRecentInputRef.current.focus()},t.handleChange=function(e){!/^[0-9]+$/.exec(e.target.value)&&e.target.value||t.setState({mostRecentValue:e.target.value})},t.handleBlur=function(e){t.state.revert||(t.props.filterStore.mostRecentValue=t.state.mostRecentValue),t.setState({focus:!1,revert:!1,mostRecentValue:t.props.filterStore.mostRecentValue})},t.handleKeyDown=function(e){13===e.keyCode?e.target.blur():27===e.keyCode&&t.setState({revert:!0},(function(){t.mostRecentInputRef.current.blur()}))},t.handleFocus=function(e){t.setState({focus:!0,revert:!1,mostRecentValue:t.props.filterStore.mostRecentValue})},t.mostRecentInputRef=i.a.createRef(),t.state={focus:!1,revert:!1,mostRecentValue:t.props.filterStore.mostRecentValue},t}return t=o,(r=[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"form-row mb-3"},i.a.createElement("div",{className:"col-sm-4"},i.a.createElement("div",{className:"form-check form-check-inline pt-1"},i.a.createElement("span",{className:"form-check-input"},i.a.createElement("input",{type:"radio",checked:!this.state.focus&&this.props.filterStore.showAll,disabled:this.props.filterStore.periodsDisabled,onChange:function(t){e.props.filterStore.showAll=!0}})),i.a.createElement("label",{onClick:function(t){e.props.filterStore.showAll=!0},className:"form-check-label text-nowrap"},gettext("Show all")))),i.a.createElement("div",{className:"col-sm-4 p-0"},i.a.createElement("div",{className:"form-check form-check-inline mr-1 pt-1 float-right"},i.a.createElement("span",{className:"form-check-input"},i.a.createElement("input",{type:"radio",checked:this.state.focus||this.props.filterStore.mostRecentChecked,disabled:this.props.filterStore.periodsDisabled,onChange:this.checkMostRecent})),i.a.createElement("label",{onClick:this.checkMostRecent,className:"form-check-label text-nowrap"},gettext("Most recent")))),i.a.createElement("div",{className:"col-sm-3"},i.a.createElement("input",{className:"form-control pl-3",value:this.state.focus?this.state.mostRecentValue:this.props.filterStore.mostRecentValue,ref:this.mostRecentInputRef,disabled:this.props.filterStore.periodsDisabled,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown})))}}])&&p(t.prototype,r),n&&p(t,n),o}(i.a.Component))||n)||n,E=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.a,{label:gettext("Start"),disabled:t.periodsDisabled,value:t.startPeriodValue||"",update:function(e){t.startPeriodValue=e.target.value},options:t.startOptions})}))),F=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.a,{label:gettext("End"),disabled:t.periodsDisabled,value:t.endPeriodValue||"",update:function(e){t.endPeriodValue=e.target.value},options:t.endOptions})}))),k=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.b,{chainLabel:t.resultChainFilterLabel,value:t.groupBy,update:function(e){t.groupBy=e.target.value}})}))),w=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Levels"),options:t.levelTierOptions,value:t.levelTierFilters,update:function(e){t.levelTierFilters={levels:e.filter((function(e){return"level"===e.category})).map((function(e){return e.value})),tiers:e.filter((function(e){return"tier"===e.category})).map((function(e){return e.value})),oldLevels:e.filter((function(e){return"oldLevel"===e.category})).map((function(e){return e.value}))}}})}))),I=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Disaggregations"),options:t.disaggregationOptions,value:t.disaggregationFilters,update:function(e){t.disaggregationFilters=e.map((function(e){return e.value}))}})}))),j=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Hide columns"),options:t.hideColumnOptions,value:t.hiddenColumns,update:function(e){t.hiddenColumns=e.map((function(e){return e.value}))}})}))),N=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Sites"),options:t.siteOptions,value:t.siteFilters,update:function(e){t.siteFilters=e.map((function(e){return e.value}))}})}))),x=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Types"),options:t.indicatorTypeOptions,value:t.indicatorTypeFilters,update:function(e){t.indicatorTypeFilters=e.map((function(e){return e.value}))}})}))),C=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Sectors"),options:t.sectorOptions,value:t.sectorFilters,update:function(e){t.sectorFilters=e.map((function(e){return e.value}))}})}))),A=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(c.c,{label:gettext("Indicators"),options:t.indicatorOptions,value:t.indicatorFilters,update:function(e){t.indicatorFilters=e.map((function(e){return e.value}))}})}))),D=function(e){return i.a.createElement("button",{type:"reset",className:"btn btn-block btn-reset"+(e.isDisabled?" disabled":""),onClick:e.action},e.label)},R=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement(i.a.Fragment,null,i.a.createElement(O,null),i.a.createElement(S,null),i.a.createElement(P,null),i.a.createElement(E,null),i.a.createElement(F,null),t.resultsFramework&&i.a.createElement(k,null),i.a.createElement(j,null))}))),T=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(w,null),i.a.createElement(I,null),i.a.createElement(N,null),i.a.createElement(x,null),i.a.createElement(C,null),i.a.createElement(A,null))},L=Object(s.b)("filterStore")(Object(s.c)((function(e){var t=e.filterStore;return i.a.createElement("nav",{id:"id_iptt_report_filter"},i.a.createElement("div",{className:"p-3",id:"filter-top"},i.a.createElement("h3",{className:"filter-title text-title-case"},gettext("Report Options")),i.a.createElement(R,null)),i.a.createElement("div",{id:"filter-middle",className:"px-3 pt-3 pb-2"},i.a.createElement(T,null)),i.a.createElement("div",{id:"filter-bottom"},i.a.createElement(D,{label:gettext("Clear filters"),action:t.clearFilters.bind(t),isDisabled:!t.filtersActive})),t.programFilterData&&i.a.createElement("div",{id:"filter-extra",className:" d-flex justify-content-between no-gutters p-3"},i.a.createElement("a",{href:"/tola_management/audit_log/".concat(t.selectedProgramId,"/"),className:"btn-link"},i.a.createElement("i",{className:"fas fa-history"})," ",gettext("Change log"))))}))),V=function(){return i.a.createElement("div",{className:"sidebar_wrapper"},i.a.createElement("div",{className:"collapse width show",id:"sidebar"},i.a.createElement(L,null)),i.a.createElement("div",{className:"sidebar-toggle"},i.a.createElement("a",{href:"#","data-target":"#sidebar","data-toggle":"collapse",title:gettext("Show/Hide Filters")},i.a.createElement("i",{className:"fa fa-chevron-left"}))))},q=r("4L+s");function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t,r){return t&&W(e.prototype,t),r&&W(e,r),e}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=K(e);if(t){var a=K(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return X(this,r)}}function X(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y=Object(s.c)(h=function(e){z(r,e);var t=Q(r);function r(e){var n;return H(this,r),(n=t.call(this,e)).NOT_SENT=0,n.SENDING=1,n.SENT=2,n.FAILED=3,n.handleChange=function(e){n.setState({reportName:e.target.value})},n.isDisabled=function(){return!n.props.rootStore.pinAPI.pinReady||!n.state.reportName},n.handleClick=function(){n.setState({status:n.SENDING}),n.props.rootStore.pinAPI.savePin(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({name:n.state.reportName},n.props.rootStore.pinParams)).then((function(){n.setState({status:n.SENT}),n.props.updatePosition()})).catch((function(){n.setState({status:n.FAILED}),console.log("ajax error:",ev)}))},n.state={reportName:"",status:n.NOT_SENT},n}return G(r,[{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,function(){switch(e.state.status){case e.SENT:return i.a.createElement("div",{className:"form-group"},i.a.createElement("p",null,i.a.createElement("span",null,gettext("Success!  This report is now pinned to the program page"))),i.a.createElement("p",null,i.a.createElement("a",{href:e.props.rootStore.pinAPI.programPageUrl},gettext("Visit the program page now."))));case e.FAILED:return i.a.createElement("div",{className:"form-group"},i.a.createElement("p",null,i.a.createElement("span",null,gettext("Something went wrong when attempting to pin this report"))));case e.NOT_SENT:return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:""},gettext("Report name")),i.a.createElement("input",{type:"text",className:"form-control",value:e.state.reportName,onChange:e.handleChange,disabled:e.state.sending})),i.a.createElement("button",{type:"button",onClick:e.handleClick,disabled:e.isDisabled(),className:"btn btn-primary btn-block"},gettext("Pin to program page")));case e.SENDING:return i.a.createElement("div",{className:"btn btn-primary",disabled:!0},i.a.createElement("img",{src:"/static/img/ajax-loader.gif"})," ",gettext("Sending"))}}())}}]),r}(i.a.Component))||h,Z=Object(s.b)("rootStore")(v=Object(s.c)(v=function(e){z(r,e);var t=Q(r);function r(){var e;H(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).popoverName="pin",e.getPopoverContent=function(){return i.a.createElement(Y,{rootStore:e.props.rootStore,updatePosition:function(){$(e.refs.target).popover("update")}})},e}return G(r,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{href:"#",className:"btn btn-sm btn-secondary",ref:"target"},i.a.createElement("i",{className:"fas fa-thumbtack"}),gettext("Pin")))}}]),r}(q.a))||v)||v,ee=Object(s.c)(b=function(e){z(r,e);var t=Q(r);function r(){var e;H(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).getCurrent=function(){e.props.excelUrl&&window.open(e.props.excelUrl,"_blank")},e.getAll=function(){e.props.fullExcelUrl&&window.open(e.props.fullExcelUrl,"_blank")},e}return G(r,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.getCurrent},gettext("Current view")),i.a.createElement("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.getAll},gettext("All program data")))}}]),r}(i.a.Component))||b,te=Object(s.c)(y=function(e){z(r,e);var t=Q(r);function r(){var e;H(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).popoverName="excel",e.getPopoverContent=function(){return i.a.createElement(ee,e.props)},e}return G(r,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{type:"button",className:"btn btn-sm btn-secondary",ref:"target"},i.a.createElement("i",{className:"fas fa-download"})," Excel"))}}]),r}(q.a))||y,re=Object(s.c)(_=function(e){z(r,e);var t=Q(r);function r(){var e;H(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleClick=function(){e.props.excelUrl&&window.open(e.props.excelUrl,"_blank")},e}return G(r,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:this.handleClick},i.a.createElement("i",{className:"fas fa-download"})," Excel"))}}]),r}(i.a.Component))||_,ne=Object(s.b)("filterStore","rootStore")(Object(s.c)((function(e){var t=e.filterStore,r=e.rootStore;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"page-subheader"},i.a.createElement("div",{id:"id_span_iptt_date_range",className:"subheader__title"},i.a.createElement("h2",{className:"text-title-case"},gettext("Indicator Performance Tracking Table")),i.a.createElement("h4",null,t.startPeriod&&t.endPeriod?t.startPeriod.startLabel+" - "+t.endPeriod.endLabel:"")),i.a.createElement("div",{className:"subheader__actions"},i.a.createElement("div",{className:"btn-row"},i.a.createElement(Z,null),t.isTVA?i.a.createElement(te,r.excelAPI):i.a.createElement(re,{excelUrl:r.excelAPI.excelUrl})))),r.currentProgram&&i.a.createElement("h3",null,i.a.createElement("a",{href:r.currentProgramPageUrl},r.currentProgram.name)))}))),ae=r("7O5W"),ie=r("IP2g"),oe=r("wHSu"),le=r("ma3e");function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=me(e);if(t){var a=me(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return fe(this,r)}}function fe(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge=function(e){var t=e.styleWidth?{minWidth:"".concat(e.styleWidth,"px")}:{};return i.a.createElement("th",{scope:"col",colSpan:e.colSpan,className:e.className,style:t},e.label)},he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(o,e);var t,r,n,a=de(o);function o(){return ce(this,o),a.apply(this,arguments)}return t=o,(r=[{key:"render",value:function(){var e=gettext("All values in this report are rounded to two decimal places.");return i.a.createElement("span",{className:"text-uppercase"},this.props.children,i.a.createElement("a",{href:"#",className:"popover-icon",tabIndex:"0","data-toggle":"popover","data-placement":"right","data-trigger":"focus","data-content":e},i.a.createElement(le.a,null)))}}])&&ue(t.prototype,r),n&&ue(t,n),o}(i.a.Component),ve=function(e){return i.a.createElement("td",{scope:"colgroup",colSpan:e.isTVA?3:1,className:"iptt-period-header"},i.a.createElement("span",{className:"text-uppercase"},e.period.name),e.period.range&&i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement("small",null,e.period.range)))},be=function(){return i.a.createElement("th",{scope:"col",className:"iptt-period-subheader",style:{minWidth:"110px"}},gettext("Target"))},ye=function(){return i.a.createElement("th",{scope:"col",className:"iptt-period-subheader",style:{minWidth:"110px"}},pgettext("report (long) header","Actual"))},_e=function(){return i.a.createElement("th",{scope:"col",className:"iptt-period-subheader",style:{minWidth:"110px"}},gettext("% Met"))},Oe=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(be,null),i.a.createElement(ye,null),i.a.createElement(_e,null))};ae.b.add(oe.f,oe.d);var Se,Pe=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.rootStore;return i.a.createElement(i.a.Fragment,null,i.a.createElement("colgroup",{span:t.baseColumns+1,className:"iptt-base-columns"}),i.a.createElement("colgroup",{span:3,className:"iptt-lop-columns"}),t.reportPeriods.map((function(e,r){return i.a.createElement("colgroup",{key:r,span:t.isTVA?3:1,className:"iptt-period-columns",id:"period-"+r})})))}))),Ee=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.rootStore;return t.currentProgram?i.a.createElement("tr",{className:"title-row"},i.a.createElement("td",{colSpan:t.baseColumns+1,className:"base-column"},i.a.createElement("button",{className:"btn btn-medium text-action btn-sm",onClick:t.expandAllRows.bind(t),disabled:t.allExpanded},i.a.createElement(ie.a,{icon:"plus-square"}),gettext("Expand all")),i.a.createElement("button",{className:"btn btn-medium text-action btn-sm",onClick:t.collapseAllRows.bind(t),disabled:t.allCollapsed},i.a.createElement(ie.a,{icon:"minus-square"}),gettext("Collapse all"))),i.a.createElement("td",{colSpan:3,className:"iptt-period-header"},i.a.createElement(he,null,gettext("Life of program"))),t.reportPeriods.map((function(e,r){return i.a.createElement(ve,{isTVA:t.isTVA,key:r,period:e})}))):i.a.createElement("tr",null,i.a.createElement("td",null,"Loading"))}))),Fe=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.rootStore;return i.a.createElement("tr",null,i.a.createElement(ge,{styleWidth:110,className:"base-column",label:gettext("No.")}),i.a.createElement(ge,{className:"base-column",styleWidth:600,colSpan:2,label:gettext("Indicator")}),i.a.createElement(ge,{className:"base-column"}),!t.filterStore.resultsFramework&&i.a.createElement(ge,{className:"base-column",styleWidth:90,label:gettext("Level")}),t.hasUOMColumn&&i.a.createElement(ge,{className:"base-column",styleWidth:250,label:gettext("Unit of measure")}),t.hasChangeColumn&&i.a.createElement(ge,{className:"base-column",label:gettext("Change")}),t.hasCNCColumn&&i.a.createElement(ge,{className:"base-column",styleWidth:130,label:gettext("C / NC")}),t.hasUOMTypeColumn&&i.a.createElement(ge,{className:"base-column",styleWidth:50,label:gettext("# / %")}),t.hasBaselineColumn&&i.a.createElement(ge,{className:"base-column",label:gettext("Baseline")}),i.a.createElement(ge,{styleWidth:110,className:"lop-column",label:gettext("Target")}),i.a.createElement(ge,{styleWidth:110,className:"lop-column",label:pgettext("report (long) header","Actual")}),i.a.createElement(ge,{styleWidth:110,className:"lop-column",label:gettext("% Met")}),t.reportPeriods.map((function(e,r){return t.isTVA?i.a.createElement(Oe,{key:r}):i.a.createElement(ye,{key:r})})))}))),ke=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(Pe,null),i.a.createElement("thead",null,i.a.createElement(Ee,null),i.a.createElement(Fe,null)))},we=r("v38i");function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ae(e);if(t){var a=Ae(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Ce(this,r)}}function Ce(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(){return(De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Re(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}ae.b.add(oe.b,oe.c);var Te=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.rootStore,r=e.indicator;return i.a.createElement("td",{className:"indicator-edit-modal-cell "},i.a.createElement("button",{type:"button",className:"btn btn-link p-1 float-right",onClick:function(e){e.preventDefault();var n="/indicators/indicator_update/".concat(r.pk,"/?modal=true");$("#indicator_modal_content").empty(),$("#modalmessages").empty(),$("#indicator_modal_content").load(n),$("#indicator_modal_div").modal("show").on("updated.tola.indicator.save",t.indicatorUpdate.bind(t)).on("deleted.tola.indicator.save",t.indicatorDelete.bind(t)).one("hidden.bs.modal",(function(e){$(e.target).off(".tola.save")}))}},i.a.createElement("i",{className:"fas fa-cog"})))}))),Le=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.indicator,r=e.rootStore;return i.a.createElement("td",{className:"indicator-result-modal-cell "},i.a.createElement("button",{type:"button",className:"btn btn-link p-1 indicator-ajax-popup indicator-data",onClick:function(e){e.preventDefault(),r.loadResultsModal(t.pk)}},i.a.createElement("i",{className:"fas fa-table"})))}))),Ve=function(e){var t=e.value,r=e.resultCell,n=Re(e,["value","resultCell"]),a=t||0===t?t:i.a.createElement("span",{className:"empty-value"},we.b);return r&&!0===r?i.a.createElement("td",De({className:"indicator-cell result-cell"},n),a):i.a.createElement("td",De({className:"indicator-cell "},n),a)},qe=Object(s.c)((function(e){var t=e.value,r=e.expanded,n=e.clickHandler,a=Re(e,["value","expanded","clickHandler"]),o=t||0===t?t:i.a.createElement("span",{className:"empty-value"},we.b);return i.a.createElement("td",De({className:"expando-cell "},a,{onClick:n}),i.a.createElement(ie.a,{icon:r?"caret-down":"caret-right"})," ",o)})),Me=Object(s.c)((function(e){var t=e.value,r=(e.expanded,e.clickHandler),n=Re(e,["value","expanded","clickHandler"]),a=t||0===t?t:we.b;return i.a.createElement("td",De({className:"indicator-cell expando-cell "},n,{onClick:r}),a)})),Ue=window.localizeNumber,Be=function(e){var t=e.value,r=Re(e,["value"]);return t=null!=t?"".concat(Ue(t),"%"):null,i.a.createElement(Ve,De({className:"indicator-cell percent-cell",value:t},r))},$e=function(e){var t=e.value,r=Re(e,["value"]);return t=null!=t?Ue(t):null,i.a.createElement(Ve,De({className:"indicator-cell number-cell",value:t},r))},He=function(e){var t=e.value;e.resultCell,Re(e,["value","resultCell"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement($e,{value:t.target}),i.a.createElement($e,{value:t.actual}),i.a.createElement(Be,{value:t.met}))},We=function(e){var t=e.value;e.resultCell,Re(e,["value","resultCell"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Be,{value:t.target}),i.a.createElement(Be,{value:t.actual}),i.a.createElement(Be,{value:t.met}))},Ge=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.indicator,r=e.disaggregationPk,n=e.rootStore,a=n.getDisaggregationLabels(r);if(!a)return null;var o=$e;t.isPercent&&(o=Be);var l=n.hiddenCategories?a.labels.filter((function(e){return n.disaggregatedLop(t.pk,e.pk)})):a.labels;return l?i.a.createElement(i.a.Fragment,null,l.map((function(e,r){return i.a.createElement("tr",{className:r==l.length-1?"disaggregation-end-row":"",key:r},0==r&&i.a.createElement("td",{className:"disaggregation-name-cell",colSpan:2,rowSpan:l.length},a.name),i.a.createElement("td",{colSpan:n.hasBaselineColumn?n.baseColumns-2:n.baseColumns-1,className:"disaggregation-label-cell"},e.name),n.hasBaselineColumn&&i.a.createElement("td",{className:"disaggregation-value-cell base-column empty-value"},"—"),i.a.createElement("td",{className:"disaggregation-value-cell lop-column empty-value"},"—"),i.a.createElement(o,{className:"disaggregation-value-cell lop-column",value:(s=n.disaggregatedLop(t.pk,e.pk),c=!1,s==gettext("N/A")?s:""===s||isNaN(parseFloat(s))?null:(s=Number.isInteger(s)?String(s):(s=Number.parseFloat(s).toFixed(2)).endsWith("00")?parseInt(s):s.endsWith("0")?s.slice(0,-1):s,!0===c?"".concat(s,"%"):s))}),i.a.createElement("td",{className:"disaggregation-value-cell lop-column empty-value"},"—"),n.disaggregatedPeriodValues(t.pk,e.pk).map((function(e,t){return n.isTVA?i.a.createElement(i.a.Fragment,{key:t},i.a.createElement("td",{className:"disaggregation-value-cell empty-value"},"—"),i.a.createElement(o,{key:t,value:e.actual}),i.a.createElement("td",{className:"disaggregation-value-cell empty-value"},"—")):i.a.createElement(o,{key:t,value:e})})));var s,c}))):i.a.createElement(i.a.Fragment,null)}))),ze=Object(s.b)("rootStore")(Se=Object(s.c)(Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(o,e);var t,r,n,a=xe(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).handleExpandoClick=function(e){t.setState({expanded:!t.state.expanded})},t.expandRow=function(){t.setState({expanded:!0})},t.collapseRow=function(){t.setState({expanded:!1})},t.state={expanded:!1},t}return t=o,(r=[{key:"componentDidMount",value:function(){this.props.rootStore._expandoRows.push(this)}},{key:"componentWillUnmount",value:function(){var e=this;this.props.rootStore._expandoRows=this.props.rootStore._expandoRows.filter((function(t){return t!=e}))}},{key:"render",value:function(){var e,t,r=this.props.indicator,n=this.props.rootStore;r.isPercent?(e=Be,t=n.isTVA?We:Be):(e=$e,t=n.isTVA?He:$e);var a=null===r.isCumulative?null:r.isCumulative?gettext("Cumulative"):gettext("Non-cumulative"),o=r.number;o&&o.length>0&&":"==o.slice(-1)&&(o=o.slice(0,-1));var l=n.getReportData(r.pk);return i.a.createElement(i.a.Fragment,null,i.a.createElement("tr",null,n.indicatorHasActiveDisaggregations(r)?i.a.createElement(qe,{value:o,expanded:this.state.expanded,clickHandler:this.handleExpandoClick}):i.a.createElement(Ve,{className:"indicator-cell ",value:o}),i.a.createElement(Le,{indicator:r}),n.indicatorHasActiveDisaggregations(r)?i.a.createElement(Me,{value:r.name,expanded:this.state.expanded,clickHandler:this.handleExpandoClick}):i.a.createElement(Ve,{className:"indicator-cell ",value:r.name}),i.a.createElement(Te,{indicator:r}),!n.resultsFramework&&i.a.createElement(Ve,{className:"indicator-cell ",value:r.oldLevelDisplay}),n.hasUOMColumn&&i.a.createElement(Ve,{className:"indicator-cell ",value:r.unitOfMeasure}),n.hasChangeColumn&&i.a.createElement(Ve,{className:"indicator-cell ",value:r.directionOfChange||gettext("N/A")}),n.hasCNCColumn&&i.a.createElement(Ve,{className:"indicator-cell ",value:a||gettext("N/A")}),n.hasUOMTypeColumn&&i.a.createElement(Ve,{className:"indicator-cell is-percent-column ",value:r.isPercent?"%":"#"}),n.hasBaselineColumn&&(null===r.baseline?i.a.createElement(Ve,{className:"indicator-cell baseline-column",value:gettext("N/A")}):i.a.createElement(e,{value:r.baseline,className:"lop-column"})),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(e,{value:l.lopTarget,className:"lop-column "}),i.a.createElement(e,{value:l.lopActual,className:"lop-column"}),i.a.createElement(Be,{value:l.lopMet,className:"lop-column"}),l.periodValues&&n.periodValues(r.pk).map((function(e,r){return i.a.createElement(t,{value:e,key:r,resultCell:!0})})))),this.state.expanded&&i.a.createElement(i.a.Fragment,null,n.activeDisaggregationPks.filter((function(e){return r.hasDisaggregation(e)})).map((function(e){return i.a.createElement(i.a.Fragment,{key:e},i.a.createElement(Ge,{indicator:r,disaggregationPk:e}))}))))}}])&&je(t.prototype,r),n&&je(t,n),o}(i.a.Component))||Se)||Se,Je=Object(s.b)("rootStore")(Object(s.c)((function(e){var t=e.rootStore,r=e.children;return i.a.createElement("tr",null,i.a.createElement("td",{colSpan:t.reportColumnWidth+1,className:"iptt-level-row"},r))}))),Qe=function(e){var t=e.level;return i.a.createElement(Je,null,t.tierNumber,": ",t.name)},Xe=function(){return i.a.createElement(Je,null,gettext("Indicators unassigned to a results framework level"))},Ke=function(e){var t=e.level,r=e.indicators;return i.a.createElement(i.a.Fragment,null,t?i.a.createElement(Qe,{level:t}):r&&r.length>0&&i.a.createElement(Xe,null),r.map((function(e,t){return i.a.createElement(ze,{indicator:e,levelCol:!1,key:t})})))},Ye=Object(s.b)("rootStore","filterStore")(Object(s.c)((function(e){var t=e.rootStore;e.filterStore;return i.a.createElement("tbody",null,t.levelRows?t.levelRows.map((function(e,t){return i.a.createElement(Ke,{level:e.level,indicators:e.indicators,key:t})})):t.indicatorRows.map((function(e,t){return i.a.createElement(ze,{indicator:e,key:t})})))}))),Ze=function(){return i.a.createElement("main",{className:"iptt_table_wrapper"},i.a.createElement("div",{id:"id_div_top_iptt_report"},i.a.createElement(ne,null),i.a.createElement("table",{className:"table table-sm table-hover table__iptt",id:"iptt_table"},i.a.createElement(ke,null),i.a.createElement(Ye,null))))},et=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(V,null),i.a.createElement(Ze,null))},tt=r("2vnA"),rt=r("1d5Q"),nt=r("OtFd"),at=r("My+N"),it=Object(at.a)(at.b,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{number:e.number||null,sectorPk:e.sector_pk||null,_typePks:Object(tt.n)(new Set(e.indicator_type_pks||[])),hasIndicatorType:function(e){return!isNaN(parseInt(e))&&this._typePks.has(parseInt(e))},_sitePks:Object(tt.n)(new Set(e.site_pks||[])),hasSite:function(e){return!isNaN(parseInt(e))&&this._sitePks.has(parseInt(e))},_disaggregationPks:Object(tt.n)(new Set(e.disaggregation_pks||[])),hasDisaggregation:function(e){return!isNaN(parseInt(e))&&this._disaggregationPks.has(parseInt(e))},hasDisaggregations:function(e){var t=this;return e.filter((function(e){return t._disaggregationPks.has(e)})).length>0}}})),ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pk:parseInt(e.pk),name:e.name,ontology:e.ontology||null,tierName:e.tier_name}},lt=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[ot].concat(t).reduce((function(t,r){return Object(tt.i)(t,r(e))}),{})}}((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{tierPk:isNaN(parseInt(e.tier_pk))?null:parseInt(e.tier_pk),tierDepth:parseInt(e.tier_depth),showForTier:function(e){return!isNaN(parseInt(e))&&parseInt(e)===this.tierPk},chainPk:isNaN(parseInt(e.chain_pk))?null:parseInt(e.chain_pk),_alwaysShowChain:!1,showForChain:function(e){return this._alwaysShowChain||!isNaN(parseInt(e))&&parseInt(e)===this.chainPk},get isResultChainLevel(){return this.chainPk&&this.chainPk==this.pk},get tierNumber(){return"".concat(this.tierName)+(this.ontology?" ".concat(this.ontology):"")},get resultChainLabel(){var e=gettext("%(this_level_number)s and sub-levels: %(this_level_full_name)s");return interpolate(e,{this_level_number:this.tierNumber,this_level_full_name:this.name},!0)}}}));function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||ut(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e){return function(e){if(Array.isArray(e))return pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ut(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){if(e){if("string"==typeof e)return pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(e,t):void 0}}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(r),!0).forEach((function(t){mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{_frequency:parseInt(e.frequency),_name:e.name,label:e.label,start:new Date(e.start),startLabel:e.start_label,end:new Date(e.end),endLabel:e.end_label,past:Boolean(e.past),year:e.year,get range(){return[2,7].includes(this._frequency)?null:"".concat(this.startLabel," – ").concat(this.endLabel)},get name(){return 7==this._frequency?"".concat(this._name," ").concat(this.year):this._name}}},ht=Object(nt.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{periods:e.periods.map((function(t){return gt(ft(ft({},t),{},{frequency:e.frequency}))})),years:ct(new Set(e.periods.map((function(e){return e.year})))).sort()}})),vt=Object(rt.a)(rt.d,rt.c,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{frequencies:Object(tt.n)(new Set((e.frequencies||[]).map((function(e){return parseInt(e)})).filter((function(e){return!isNaN(e)})))),periodRanges:Object(tt.n)(new Map(Object.entries(e.period_date_ranges||{}).map((function(e){var t=st(e,2),r=t[0],n=t[1],a=parseInt(r);return[a,ht({frequency:a,periods:n})]})))),validFrequency:function(e){return!isNaN(parseInt(e))&&this.frequencies.has(parseInt(e))},resultChainLabel:e.result_chain_label,indicators:Object(tt.n)(new Map((e.indicators||[]).map((function(e){return it(e)})).map((function(e){return[e.pk,e]})))),levels:Object(tt.n)(new Map((e.levels||[]).map((function(e){return lt(e)})).map((function(e){return[e.pk,e]})))),tiers:Object(tt.n)(new Map((e.tiers||[]).map((function(e){return[parseInt(e.pk),{pk:parseInt(e.pk),name:e.name,depth:e.tier_depth}]})))),oldLevels:Object(tt.n)(new Map((e.old_levels||[]).map((function(e){return[parseInt(e.pk),{pk:e.pk,name:e.name}]})))),sectors:Object(tt.n)(new Map((e.sectors||[]).map((function(e){return[parseInt(e.pk),{pk:parseInt(e.pk),name:e.name}]})))),sites:Object(tt.n)(new Map((e.sites||[]).map((function(e){return[parseInt(e.pk),{pk:parseInt(e.pk),name:e.name}]})))),disaggregations:Object(tt.n)(new Map((e.disaggregations||[]).map((function(e){return[parseInt(e.pk),{pk:parseInt(e.pk),name:e.country?e.name:gettext(e.name),country:e.country||null,labels:(e.labels||[]).map((function(e){return{pk:parseInt(e.pk),name:e.name}}))}]})).filter((function(e){var t=st(e,2),r=(t[0],t[1]);return r.labels&&r.labels.length>0})))),indicatorTypes:Object(tt.n)(new Map((e.indicator_types||[]).map((function(e){return[parseInt(e.pk),{pk:parseInt(e.pk),name:e.name}]})))),deleteIndicator:function(e){var t=this;return isNaN(parseInt(e))?this.updateOrder():this.updateOrder().then((function(r){t.indicators.delete(parseInt(e))}))}}})),bt=r("wgi2"),yt=r("0pHI");function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){St(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function St(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Et="?"+[].concat(["frequency","start","end","levels","types","sites","disaggregations","sectors","indicators","tiers","groupby","mr","columns"],["timeframe","numrecentperiods","numrecentcount","start_period","end_period"]).join("&"),Ft=[{name:"iptt",path:"/iptt_report/:programId<\\d+>",children:[{name:"timeperiods",path:"/timeperiods?timeperiods"},{name:"tva",path:"/targetperiods?targetperiods"}]},{name:"ipttExcel",path:"/iptt_api/iptt_excel?fullTVA&reportType&programId"}],kt=function(e){return"string"==typeof e||e instanceof String?[parseInt(e)]:Array.isArray(e)?e.map((function(e){return parseInt(e)})):Number.isInteger(e)?[e]:isNaN(parseInt(e))?[]:[parseInt(e)]},wt=function(){var e=Object(bt.b)(Ft,{trailingSlashMode:"always"});return e.setRootPath(Et),e.usePlugin(Object(yt.a)({useHash:!1,base:"/indicators"})),e.start(),tt.n.object({_router:e,get isTVA(){return"iptt.tva"===this._router.getState().name},get programId(){return this._router.getState().params.programId},get frequency(){var e=this._router.getState().params,t=e.frequency,r=e.timeperiods,n=e.targetperiods;Pt(e,["frequency","timeperiods","targetperiods"]);return isNaN(parseInt(t))?isNaN(parseInt(r))?isNaN(parseInt(n))?null:parseInt(n):parseInt(r):parseInt(t)},get start(){return this._router.getState().params.start},get end(){return this._router.getState().params.end},get timeframe(){return 2==this._router.getState().params.timeframe?{mostRecent:this._router.getState().params.numrecentperiods}:1==this._router.getState().params.timeframe&&{showAll:!0}},get mr(){return 1==this._router.getState().params.mr},get groupBy(){return this._router.getState().params.groupby},get levels(){return kt(this._router.getState().params.levels)},get tiers(){return kt(this._router.getState().params.tiers)},get sectors(){return kt(this._router.getState().params.sectors)},get sites(){return kt(this._router.getState().params.sites)},get disaggregations(){return kt(this._router.getState().params.disaggregations)},get hiddenCategories(){var e=this._router.getState().params.disaggregations;return Array.isArray(e)?e.includes("hide-categories"):e&&"hide-categories"==e},get columns(){return kt(this._router.getState().params.columns)},get types(){return kt(this._router.getState().params.types)},get indicators(){return kt(this._router.getState().params.indicators)},updateParams:function(e){var t=e.tva,r=Pt(e,["tva"]),n=t?"iptt.tva":"iptt.timeperiods";this._router.buildPath(n,r)!==this._router.getState().path&&this._router.navigate(n,r,{replace:!0})},get queryParams(){return this._router.getState().params},getExcelUrl:function(e){var t=e.tva,r=Pt(e,["tva"]);return this._router.buildUrl("ipttExcel",Ot(Ot({},r),{},{reportType:t?we.l:we.i,fullTVA:!1}))},getFullExcelUrl:function(e){var t=e.programId,r=e.groupby;Pt(e,["programId","groupby"]);return this._router.buildUrl("ipttExcel",{programId:t,groupBy:r,fullTVA:!0})}})},It=r("5/4V");function jt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Nt(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ct(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||Ct(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){if(e){if("string"==typeof e)return At(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?At(e,t):void 0}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return tt.n.object({_allPrograms:new Map(e.filter((function(e){var t=xt(e,3),r=t[0];t[1],t[2];return!isNaN(parseInt(r))})).map((function(e){var t=xt(e,3),r=t[0],n=t[1],a=t[2];return[parseInt(r),{pk:parseInt(r),name:n,tvaCount:parseInt(a)}]}))),listPrograms:function(){return Array.from(this._allPrograms.values())},listTvaPrograms:function(){return this.listPrograms().filter((function(e){return e.tvaCount>0}))},getProgram:function(e){return isNaN(parseInt(e))?null:this._allPrograms.get(parseInt(e))},hasProgram:function(e){return!isNaN(parseInt(e))&&this._allPrograms.has(parseInt(e))}})},Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=vt(e);return tt.n.object({_programs:new Map([[t.pk,t]]),getProgramFilterData:function(e){return this._programs.has(parseInt(e))?this._programs.get(parseInt(e)):null},loadProgramFilterData:function(e){var t=this;return isNaN(parseInt(e))?Promise.reject("invalid program Id"):It.a.ipttFilterData(e).then((function(e){return vt(e)})).then((function(e){Object(tt.p)((function(){return t._programs.set(e.pk,e),e}))}))}})},Tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=wt(),r=tt.n.object({_programsListStore:Dt(e.programs_list||[]),_programFilterDataStore:Rt(e.program_data),_router:t,_reportType:null,_selectedProgramId:null,_selectedFrequency:null,_start:null,_end:null,_mostRecentForce:null,_groupBy:we.d,_indicatorFilters:{},_hiddenColumns:[],_hiddenCategories:!1,get isTVA(){return this._reportType===we.l},get selectedProgramId(){return this._programsListStore.hasProgram(this._selectedProgramId)?this._selectedProgramId:null},setProgramId:function(e){var t=this;if(e=parseInt(e),isNaN(e))this._selectedProgramId=null;else if(e!==this._selectedProgramId){this.clearFilters();var r=this.selectedFrequency,n={mostRecent:""!=this.mostRecentValue?this.mostRecentValue:null,showAll:this.showAll,start:this.startPeriodValue,end:this.endPeriodValue};return this._selectedProgramId=e,this.updateProgramFilterData().then((function(){t.setFrequency(r),t.setPeriods(n)}))}},get programOptions(){return(this.isTVA?this._programsListStore.listTvaPrograms():this._programsListStore.listPrograms()).map((function(e){return{value:e.pk,label:e.name}}))},get selectedProgramOption(){var e=this._programsListStore.getProgram(this.selectedProgramId);return e&&null!==e?{value:e.pk,label:e.name}:we.a},set selectedProgramOption(e){this.setProgramId(e.value)},get programFilterData(){return this._programFilterDataStore.getProgramFilterData(this.selectedProgramId)},updateProgramFilterData:function(){return this._programFilterDataStore.loadProgramFilterData(this.selectedProgramId)},get _frequencyLabels(){return this.isTVA?we.m:we.j},get frequencyDisabled(){return null===this.selectedProgramId},get frequencyOptions(){var e=this;return this.programFilterData?(this.isTVA?Array.from(this.programFilterData.frequencies).sort():we.k).map((function(t){return{value:t,label:e._frequencyLabels[t]}})):[we.a]},get selectedFrequency(){return this.selectedProgramId&&!isNaN(parseInt(this._selectedFrequency))?parseInt(this._selectedFrequency):null},setFrequency:function(e){if(e=parseInt(e),isNaN(e))return this._selectedFrequency=null,!1;if(this.isTVA&&!this.programFilterData.frequencies.has(e)?e=parseInt(Array.from(this.programFilterData.frequencies).sort()[0]):this.isTVA||we.k.includes(e)||(e=parseInt(we.k[0])),e!==this._selectedFrequency){var t={mostRecent:""!=this.mostRecentValue?this.mostRecentValue:null,showAll:this.showAll,start:this.startPeriodValue,end:this.endPeriodValue};return this._selectedFrequency=e,this.setPeriods(t),!0}},get selectedFrequencyOption(){return this.programFilterData&&null!==this.selectedFrequency?{value:this.selectedFrequency,label:this._frequencyLabels[this.selectedFrequency]}:we.a},set selectedFrequencyOption(e){this.setFrequency(e.value)},get periodsDisabled(){return!this.programFilterData||!we.k.includes(this.selectedFrequency)},get periodRange(){return this.periodsDisabled?{years:[],options:[we.a]}:this.programFilterData.periodRanges.get(this.selectedFrequency)},get startOptions(){var e=this;if(we.f.includes(this.selectedFrequency))return[we.a];if(3==this.selectedFrequency)return this.periodRange.options;var t=this.periodRange.years.map((function(t){return{label:t,options:e.periodRange.options.filter((function(e){return e.year==t}))}})).filter((function(e){return e.options.length>0}));return 0==t.length?[we.a]:1==t.length?t[0].options:t},get endOptions(){var e=this;if(we.f.includes(this.selectedFrequency))return[we.a];var t=this.periodRange.options.filter((function(t){return!e.startPeriodValue||t.value>=e.startPeriodValue}));if(3==this.selectedFrequency)return t;var r=this.periodRange.years.map((function(e){return{label:e,options:t.filter((function(t){return t.year==e}))}})).filter((function(e){return e.options.length>0}));return 0==r.length?[we.a]:1==r.length?r[0].options:r},get _lastPeriod(){return this.periodsDisabled?null:this.programFilterData.periodRanges.get(this.selectedFrequency).periodCount-1},get _currentPeriod(){return this.periodsDisabled?null:this.programFilterData.periodRanges.get(this.selectedFrequency).currentPeriod},get mostRecentChecked(){return""!==this.mostRecentValue},get mostRecentValue(){return this.periodsDisabled||this.showAll||this.endPeriodValue!==this._currentPeriod?"":this.endPeriodValue-this.startPeriodValue+1},get showAll(){return!this.periodsDisabled&&!this._mostRecentForce&&(0===this.startPeriodValue&&this._lastPeriod&&this.endPeriodValue==this._lastPeriod)},set showAll(e){this._mostRecentForce=!1,this.startPeriodValue=0,this.endPeriodValue=this._lastPeriod},set mostRecentValue(e){if(this.startPeriodValue=0,this.endPeriodValue=this._currentPeriod,this.startPeriodValue=this.endPeriodValue-e+1,this.showAll){this._mostRecentForce=!0;var t=this;Object(tt.o)((function(){return[t.mostRecentChecked,t.startPeriodValue,t.endPeriodValue]}),(function(e,r){t._mostRecentForce=!1,r.dispose()}))}},get startPeriod(){return this.programFilterData&&we.f.includes(this.selectedFrequency)?this.programFilterData.periodRanges.get(this.selectedFrequency).periods[0]:this.programFilterData&&this.selectedFrequency&&null!==this._start?this.programFilterData.periodRanges.get(this.selectedFrequency).periods[this._start]:null},get startPeriodValue(){return this.periodsDisabled?null:this._start},set startPeriodValue(e){e=isNaN(parseInt(e))?0:parseInt(e),null!==this._lastPeriod&&(this._start=Math.max(0,Math.min(this._lastPeriod,e))),this.endPeriodValue&&this.startPeriodValue>this.endPeriodValue&&(this.endPeriodValue=this.startPeriodValue)},get endPeriod(){return this.programFilterData&&we.f.includes(this.selectedFrequency)?this.programFilterData.periodRanges.get(this.selectedFrequency).periods.slice(-1).pop():this.programFilterData&&this.selectedFrequency&&null!==this._end?this.programFilterData.periodRanges.get(this.selectedFrequency).periods[this._end]:null},get endPeriodValue(){return this.periodsDisabled?null:this._end},set endPeriodValue(e){e=isNaN(parseInt(e))?this._lastPeriod:parseInt(e),null!==this._lastPeriod&&(this._end=Math.max(this.startPeriodValue||0,Math.min(this._lastPeriod,e)))},setTimeframe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mostRecent,r=void 0===t?null:t,n=e.showAll,a=void 0===n?null:n;r&&(this.mostRecentValue=r),a&&(this.showAll=!0)},setPeriods:function(e){var t=e.mostRecent,r=void 0===t?null:t,n=e.showAll,a=void 0===n?null:n,i=e.start,o=void 0===i?null:i,l=e.end,s=void 0===l?null:l;r?this.mostRecentValue=r:a?this.showAll=!0:(this.startPeriodValue=o,this.endPeriodValue=s)},get resultsFramework(){return this.programFilterData&&this.programFilterData.resultsFramework},get resultChainFilterLabel(){return this.programFilterData?this.programFilterData.resultChainFilterLabel:null},get groupBy(){return this.resultsFramework?this._groupBy:null},set groupBy(e){this._groupBy=parseInt(e)===we.e?we.e:we.d},get allLevels(){return(this.resultsFramework?this.groupBy===we.d?this.programFilterData.levelsInChainOrder:this.programFilterData.levelsInLevelOrder:[])||[]},get levels(){return this.allLevels},get _levelOptions(){var e=this.resultsFramework?[].concat(Nt(this.getAllIndicators("levels").map((function(e){return e.levelPk}))),Nt(this._indicatorFilters.levels)):[];return this.levels.filter((function(t){return t.isResultChainLevel&&e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.resultChainLabel,category:"level"}}))},get _tierOptions(){var e=this,t=this.resultsFramework?[].concat(Nt(this.getAllIndicators("levels").filter((function(e){return e.levelPk})).map((function(t){return e.programFilterData.levels.get(t.levelPk).tierPk}))),Nt(this._indicatorFilters.tiers)):[];return this.programFilterData?(Array.from(this.programFilterData.tiers.values())||[]).filter((function(e){return t.includes(e.pk)})).map((function(e){return{value:e.pk,label:e.name,category:"tier"}})):[]},get _oldLevelOptions(){var e=this.resultsFramework?[]:[].concat(Nt(this.getAllIndicators("levels").map((function(e){return e.levelPk}))),Nt(this._indicatorFilters.oldLevels));return this.programFilterData?(Array.from(this.programFilterData.oldLevels.values())||[]).filter((function(t){return e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.name,category:"oldLevel"}})):[we.a]},get levelTierOptions(){if(!this.programFilterData)return[we.a];if(this.programFilterData.resultsFramework){var e=[{label:"",options:this._tierOptions},{label:this.programFilterData.resultChainLabel,options:this._levelOptions}].filter((function(e){return e.options&&e.options.length>0}));return e&&e.length>0?e:[we.a]}return this._oldLevelOptions&&this._oldLevelOptions.length>0?this._oldLevelOptions:[we.a]},get levelTierFilters(){var e=this;return[].concat(Nt(this._tierOptions.filter((function(t){return e._indicatorFilters.tiers.includes(t.value)}))),Nt(this._levelOptions.filter((function(t){return e._indicatorFilters.levels.includes(t.value)}))),Nt(this._oldLevelOptions.filter((function(t){return e._indicatorFilters.oldLevels.includes(t.value)}))))},set levelTierFilters(e){var t=void 0===e?{}:e,r=t.levels,n=void 0===r?[]:r,a=t.tiers,i=void 0===a?[]:a,o=t.oldLevels,l=void 0===o?[]:o;i.length>0&&n.length>0&&(this._indicatorFilters.levels.length>0?n=[]:i=[]),this._indicatorFilters.tiers=this.resultsFramework?i:[],this._indicatorFilters.levels=this.resultsFramework?n:[],this._indicatorFilters.oldLevels=this.resultsFramework?[]:l},get sectorOptions(){var e=[].concat(Nt(new Set(this.getAllIndicators("sectors").filter((function(e){return e.sectorPk})).map((function(e){return e.sectorPk})))),Nt(this._indicatorFilters.sectors));return this.programFilterData?Array.from(this.programFilterData.sectors.values()).filter((function(t){return e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.name}})):[we.a]},get sectorFilters(){var e=this;return this.sectorOptions.filter((function(t){return e._indicatorFilters.sectors.includes(t.value)}))},set sectorFilters(e){void 0===e&&(e=[]),this._indicatorFilters.sectors=e.map((function(e){return parseInt(e)}))},get siteOptions(){var e=[].concat(Nt(new Set(this.getAllIndicators("sites").map((function(e){return Array.from(e._sitePks.values())})).reduce((function(e,t){return e.concat(t)}),[]))),Nt(this._indicatorFilters.sites));return this.programFilterData?Array.from(this.programFilterData.sites.values()).filter((function(t){return e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.name}})):[we.a]},get siteFilters(){var e=this;return this.siteOptions.filter((function(t){return e._indicatorFilters.sites.includes(t.value)}))},set siteFilters(e){void 0===e&&(e=[]),this._indicatorFilters.sites=e.map((function(e){return parseInt(e)}))},get disaggregationOptions(){var e=[].concat(Nt(new Set(this.getAllIndicators("disaggregations").map((function(e){return Array.from(e._disaggregationPks.values())})).reduce((function(e,t){return e.concat(t)}),[]))),Nt(this._indicatorFilters.disaggregations));if(!this.programFilterData)return[we.a];var t=Array.from(this.programFilterData.disaggregations.values()).filter((function(t){return e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.name,country:e.country}})),r=Nt(new Set(t.map((function(e){return e.country})))).filter((function(e){return null!==e})).sort(),n=[];return n.push({value:"hide-categories",label:gettext("Only show categories with results"),noList:!0}),t.filter((function(e){return null===e.country})).length>0&&n.push({label:gettext("Global disaggregations"),options:t.filter((function(e){return null===e.country}))}),r.forEach((function(e){n.push({label:"".concat(e," ").concat(gettext("Disaggregations")),options:t.filter((function(t){return t.country===e}))})})),n},get currentDisaggregations(){var e=this._indicatorFilters.disaggregations&&this._indicatorFilters.disaggregations.length>0?this._indicatorFilters.disaggregations:Nt(new Set(this.getAllIndicators("disaggregations").map((function(e){return Array.from(e._disaggregationPks.values())})).reduce((function(e,t){return e.concat(t)}),[])));return this.programFilterData?Array.from(this.programFilterData.disaggregations.values()).filter((function(t){return e.includes(t.pk)})).sort((function(e,t){return e.name>t.name?1:-1})).map((function(e){return e.pk})):[]},get disaggregationFilters(){var e=this,t=[].concat.apply([],this.disaggregationOptions.slice(1).map((function(e){return e.options})));return t=t.filter((function(t){return t&&t.value&&e._indicatorFilters.disaggregations.includes(t.value)})),this._hiddenCategories&&(t=[this.disaggregationOptions[0]].concat(Nt(t))),t},set disaggregationFilters(e){void 0===e&&(e=[]),this._indicatorFilters.disaggregations=e.filter((function(e){return"hide-categories"!=e&&"NaN"!=e&&!isNaN(parseInt(e))})).map((function(e){return parseInt(e)})),this._hiddenCategories=e.includes("hide-categories")},get indicatorTypeOptions(){var e=[].concat(Nt(new Set(this.getAllIndicators("types").map((function(e){return Array.from(e._typePks.values())})).reduce((function(e,t){return e.concat(t)}),[]))),Nt(this._indicatorFilters.indicatorTypes));return this.programFilterData?Array.from(this.programFilterData.indicatorTypes.values()).filter((function(t){return e.includes(t.pk)})).map((function(e){return{value:e.pk,label:e.name}})):[we.a]},get indicatorTypeFilters(){var e=this;return this.indicatorTypeOptions.filter((function(t){return e._indicatorFilters.indicatorTypes.includes(t.value)}))},set indicatorTypeFilters(e){void 0===e&&(e=[]),this._indicatorFilters.indicatorTypes=e.map((function(e){return parseInt(e)}))},_filterFrequency:function(e){var t=this;return e=e||[],this.isTVA&&(e=e.filter((function(e){return e.frequency==t.selectedFrequency}))),e},_filterLevelTiers:function(e){var t=this;return e=e||[],this.resultsFramework&&this._indicatorFilters.tiers&&this._indicatorFilters.tiers.length>0&&(e=e.filter((function(e){return e.levelPk&&t._indicatorFilters.tiers.some((function(r){return t.programFilterData.levels.get(e.levelPk).showForTier(r)}))}))),this.resultsFramework&&this._indicatorFilters.levels&&this._indicatorFilters.levels.length>0&&(e=e.filter((function(e){return e.levelPk&&t._indicatorFilters.levels.some((function(r){return t.programFilterData.levels.get(e.levelPk).showForChain(r)}))}))),!this.resultsFramework&&this._indicatorFilters.oldLevels&&this._indicatorFilters.oldLevels.length>0&&(e=e.filter((function(e){return e.levelPk&&t._indicatorFilters.oldLevels.includes(e.levelPk)}))),e},_filterSites:function(e){var t=this;return this._indicatorFilters.sites&&this._indicatorFilters.sites.length>0&&(e=e.filter((function(e){return t._indicatorFilters.sites.some((function(t){return e.hasSite(t)}))}))),e},_filterDisaggregations:function(e){var t=this;return this._indicatorFilters.disaggregations&&this._indicatorFilters.disaggregations.length>0&&(e=e.filter((function(e){return t._indicatorFilters.disaggregations.some((function(t){return e.hasDisaggregation(t)}))}))),e},_filterIndicatorTypes:function(e){var t=this;return this._indicatorFilters.indicatorTypes&&this._indicatorFilters.indicatorTypes.length>0&&(e=e.filter((function(e){return t._indicatorFilters.indicatorTypes.some((function(t){return e.hasIndicatorType(t)}))}))),e},_filterSectors:function(e){var t=this;return this._indicatorFilters.sectors&&this._indicatorFilters.sectors.length>0&&(e=e.filter((function(e){return e.sectorPk&&t._indicatorFilters.sectors.includes(e.sectorPk)}))),e},_filterIndicatorFilter:function(e){var t=this;return e=e||[],this._indicatorFilters.indicators&&this._indicatorFilters.indicators.length>0&&(e=e.filter((function(e){return t._indicatorFilters.indicators.includes(e.pk)}))),e},filterIndicators:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=e||[],e=this._filterFrequency(e),"levels"!=t&&(e=this._filterLevelTiers(e)),"disaggregations"!=t&&(e=this._filterDisaggregations(e)),"sites"!=t&&(e=this._filterSites(e)),"types"!=t&&(e=this._filterIndicatorTypes(e)),"sectors"!=t&&(e=this._filterSectors(e)),"indicators"!=t&&(e=this._filterIndicatorFilter(e)),e},getUnassignedIndicators:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.filterIndicators(this.programFilterData.unassignedIndicators,e)},getLevelIndicators:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.filterIndicators((this.programFilterData.levelIndicators.get(e)||[]).map((function(e){return t.programFilterData.indicators.get(e)})),r)||[]},getAllIndicators:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.programFilterData){var t=this.groupBy===we.d?this.programFilterData.indicatorsInChainOrder:this.programFilterData.indicatorsInLevelOrder;return this.filterIndicators(t,e)}return[]},getLevelIndicatorGroups:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.resultsFramework?[].concat(Nt(this.levels.map((function(r){return{level:r,indicators:e.getLevelIndicators(r.pk,t)}}))),[{level:null,indicators:this.getUnassignedIndicators(t)}]):(Array.from(this.programFilterData.oldLevels.values())||[]).map((function(r){return{level:r,indicators:e.getAllIndicators(t).filter((function(e){return e.levelPk==r.pk}))}}))},get indicatorOptions(){if(this.programFilterData){var e=this.getLevelIndicatorGroups("indicators");return 0===(e=(e=this.resultsFramework?e.map((function(e){return{label:e.level?e.level.tierNumber:gettext("Indicators unassigned to  a results framework level"),options:e.indicators.map((function(e){return{value:e.pk,label:e.name}}))}})):e.map((function(e){return{label:e.level.name,options:e.indicators.map((function(e){return{value:e.pk,label:e.name}}))}}))).filter((function(e){return e.options&&e.options.length>0}))).length?[we.a]:1===e.length?e[0].options:e}return[we.a]},get indicatorFilters(){var e=this,t=this.indicatorOptions;return t&&0!=t.length?(t[0].options&&t[0].options.length>0&&(t=t.reduce((function(e,t){return[].concat(Nt(e),Nt(t.options))}),[])),t.filter((function(t){return e._indicatorFilters.indicators.includes(t.value)}))):[]},set indicatorFilters(e){void 0===e&&(e=[]),this._indicatorFilters.indicators=e.map((function(e){return parseInt(e)}))},clearFilters:function(){this._indicatorFilters={levels:[],tiers:[],oldLevels:[],disaggregations:[],sectors:[],sites:[],indicatorTypes:[],indicators:[]},this._hiddenCategories=!1},get filtersActive(){return Object.values(this._indicatorFilters).reduce((function(e,t){return e+t.length}),0)>0||this._hiddenCategories},get hideColumnOptions(){return[{label:gettext("Unit of measure"),value:0},{label:gettext("Change"),value:1},{label:gettext("C / NC"),value:2},{label:"# / %",value:3},{label:gettext("Baseline"),value:4}]},get hiddenColumns(){var e=this;return this.hideColumnOptions.filter((function(t){return e._hiddenColumns.includes(t.value)}))},set hiddenColumns(e){void 0===e&&(e=[]),this._hiddenColumns=e.map((function(e){return parseInt(e)}))},get pathParams(){var e={tva:this.isTVA,programId:this.selectedProgramId,frequency:this.selectedFrequency,start:this.startPeriodValue,end:this.endPeriodValue,mr:this._mostRecentForce?1:null,groupby:this.groupBy,levels:(this.resultsFramework?this.levelTierFilters.filter((function(e){return"level"==e.category})):this.levelTierFilters.filter((function(e){return"oldLevel"==e.category}))).map((function(e){return e.value})),tiers:this.resultsFramework?this.levelTierFilters.filter((function(e){return"tier"==e.category})).map((function(e){return e.value})):null,sectors:this.sectorFilters.map((function(e){return e.value})),sites:this.siteFilters.map((function(e){return e.value})),types:this.indicatorTypeFilters.map((function(e){return e.value})),indicators:this.indicatorFilters.map((function(e){return e.value})),disaggregations:this.disaggregationFilters.map((function(e){return e.value})),columns:this.hiddenColumns.map((function(e){return e.value}))};return Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},updateParams:function(e){e.programId&&this._router.updateParams(e)},get queryString(){var e=this.pathParams,t=(e.tva,e.programId,jt(e,["tva","programId"]));return Object.entries(t).filter((function(e){var t=xt(e,2),r=(t[0],t[1]);return(0===r||r)&&(!Array.isArray(r)||r.length>0)})).map((function(e){var t=xt(e,2),r=t[0],n=t[1];return Array.isArray(n)?n.map((function(e){return"".concat(r,"=").concat(e)})).join("&"):"".concat(r,"=").concat(n)})).reduce((function(e,t){return e.concat(t)}),[]).join("&")},get excelUrl(){return!!this.selectedFrequency&&this._router.getExcelUrl(this.pathParams)},get fullExcelUrl(){return!!this.selectedProgramId&&this._router.getFullExcelUrl(this.pathParams)}});r._reportType=r._router.isTVA?we.l:we.i,r._selectedProgramId=r._router.programId,r._selectedFrequency=r._router.frequency,r._router.timeframe?r.setTimeframe(r._router.timeframe):(r.startPeriodValue=r._router.start,r.endPeriodValue=r._router.end),r._mostRecentForce=r._router.mr,r.groupBy=r._router.groupBy,r.sectorFilters=r._router.sectors,r.siteFilters=r._router.sites,r.disaggregationFilters=r._router.disaggregations,r.indicatorTypeFilters=r._router.types,r.indicatorFilters=r._router.indicators,r._hiddenColumns=r._router.columns,r._hiddenCategories=r._router.hiddenCategories,r.levelTierFilters={levels:r._router.levels,tiers:r._router.tiers,oldLevels:r._router.levels};Object(tt.o)((function(){return r.pathParams}),(function(e){return r.updateParams(e)}),{fireImmediately:!0});return r};function Lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||Vt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(e,t){if(e){if("string"==typeof e)return qt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qt(e,t):void 0}}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.target,r=void 0===t?null:t,n=e.actual,a=void 0===n?null:n,i=e.met,o=void 0===i?null:i,l=e.disaggregations,s=void 0===l?{}:l,c=new Map(Object.entries(s).map((function(e){var t=Lt(e,2),r=t[0],n=t[1];return[parseInt(r),{actual:n.actual}]})));return{target:r,actual:a,met:o,disaggregations:c}}var Ut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(tt.n)({pk:parseInt(t.pk),frequency:parseInt(e),_lopPeriod:Mt(t.lop_period),get lopTarget(){return this._lopPeriod.target},get lopActual(){return this._lopPeriod.actual},get lopMet(){return this._lopPeriod.met},_reportData:Object(tt.n)(new Map((t.periods||[]).map((function(e){return[parseInt(e.count),Mt(e)]})))),get periodValues(){return Array.from(this._reportData.values())},_disaggregatedData:Object(tt.n)(new Map(Object.entries(t.disaggregated_data||{}).map((function(e){var t=Lt(e,2),r=t[0],n=t[1];return[parseInt(r),n]})))),disaggregatedLop:function(e){return!isNaN(parseInt(e))&&this._lopPeriod.disaggregations.has(parseInt(e))?this._lopPeriod.disaggregations.get(parseInt(e)).actual:null},disaggregatedPeriodValues:function(e){return isNaN(parseInt(e))?[]:this.periodValues.map((function(t){return t.disaggregations.get(parseInt(e))}))}})};function Bt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $t(e){return function(e){if(Array.isArray(e))return Ht(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ht(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=1,r=2,n=Object(tt.n)({_reportMap:tt.n.map([].concat($t(we.k),$t(we.f)).sort().map((function(e){return[e,tt.n.map()]}))),getReport:function(e){return this._reportMap.get(e)},programStatus:tt.n.map([].concat($t(we.k),$t(we.f)).sort().map((function(e){return[e,tt.n.map()]}))),callForReportData:function(e){var n=this,a=e.update,i=Bt(e,["update"]),o=parseInt(i.programPk),l=parseInt(i.frequency);return this.programStatus.get(l).get(o)===t?Promise.resolve(!1):a||this.programStatus.get(l).get(o)!==r?(this.programStatus.get(l).set(o,t),It.a.getIPTTReportData(i).then((function(e){Object(tt.p)((function(){n.updateReportData(e)}))}))):Promise.resolve(!1)},updateReportData:function(e){var t=this,n=parseInt(e.report_frequency);return(e.report_data||[]).forEach((function(e){var r=Ut(n,e);t._reportMap.get(n).set(r.pk,r)})),this.programStatus.get(n).set(parseInt(e.program_pk),r),e}});if(e&&e.report_data){var a=parseInt(e.report_frequency),i=n.getReport(a);(e.report_data||[]).map((function(e){return Ut(a,e)})).forEach((function(e){return i.set(e.pk,e)})),n.programStatus.get(a).set(parseInt(e.program_pk),r)}return n};function Gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Qt=new function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(tt.n)({_filterStore:Tt(e),get filterStore(){return this._filterStore},_reportStore:Wt(e.report||{}),_expandoRows:[],expandAllRows:function(){this._expandoRows.forEach((function(e){e.expandRow()}))},get allExpanded(){return this._expandoRows.every((function(e){return e.state.expanded}))},get allCollapsed(){return this._expandoRows.every((function(e){return!e.state.expanded}))},collapseAllRows:function(){this._expandoRows.forEach((function(e){e.collapseRow()}))},get reportStore(){return this._reportStore},get currentReport(){return this.reportStore.getReport(this.filterStore.selectedFrequency)},loadReportData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,r=void 0!==t&&t;return this.reportStore.callForReportData({programPk:this.filterStore.selectedProgramId,frequency:this.filterStore.selectedFrequency,reportType:this.filterStore.isTVA?we.l:we.i,update:r})},get pinParams(){return{program:this.filterStore.selectedProgramId,report_type:this.filterStore.isTVA?"targetperiods":"timeperiods",query_string:this.filterStore.queryString}},get pinAPI(){return{programPageUrl:It.a.getProgramPageUrl(this.filterStore.selectedProgramId),pinReady:!0,pinParams:this.pinParams,savePin:function(e){return It.a.savePinnedReport(e)}}},get excelAPI(){return{excelUrl:this.filterStore.excelUrl,fullExcelUrl:this.filterStore.fullExcelUrl}},get currentProgram(){return this.filterStore.programFilterData},get currentProgramPageUrl(){return this.currentProgram?It.a.getProgramPageUrl(this.currentProgram.pk):null},get isTVA(){return this.filterStore.isTVA},get resultsFramework(){return this.filterStore.resultsFramework},get levelRows(){var e=this;return!!(this.filterStore.resultsFramework&&this.filterStore.allLevels.length>0)&&this.filterStore.getLevelIndicatorGroups().filter((function(t){return t.indicators.length>0||!e.filterStore.filtersActive&&null!==t.level&&1===t.level.tierDepth}))},get indicatorRows(){return this.filterStore.getAllIndicators()},get reportPeriods(){return this.currentProgram&&this.filterStore.selectedFrequency&&1!==this.filterStore.selectedFrequency?2==this.filterStore.selectedFrequency?this.currentProgram.periodRanges.get(this.filterStore.selectedFrequency).periods:this.currentProgram.periodRanges.get(this.filterStore.selectedFrequency).periods.slice(this.filterStore.startPeriodValue,this.filterStore.endPeriodValue+1):[]},getReportData:function(e){return this.currentReport&&this.currentReport.has(parseInt(e))?this.currentReport.get(parseInt(e)):{}},periodValues:function(e){var t=this.currentReport.has(parseInt(e))?2==this.filterStore.selectedFrequency?this.currentReport.get(parseInt(e)).periodValues:this.currentReport.get(parseInt(e)).periodValues.slice(this.filterStore.startPeriodValue,this.filterStore.endPeriodValue+1):[];return t&&!this.isTVA&&(t=t.map((function(e){return e.actual}))),t},disaggregatedLop:function(e,t){return this.currentReport.has(parseInt(e))?this.currentReport.get(parseInt(e)).disaggregatedLop(parseInt(t)):null},disaggregatedPeriodValues:function(e,t){var r=this.currentReport.has(parseInt(e))?this.currentReport.get(parseInt(e)).disaggregatedPeriodValues(parseInt(t)):null;return r&&2!=this.filterStore.selectedFrequency&&(r=r.slice(this.filterStore.startPeriodValue,this.filterStore.endPeriodValue+1)),r&&!this.isTVA&&(r=r.map((function(e){return e.actual}))),r||[]},get hiddenCategories(){return!0===this.filterStore._hiddenCategories},get baseColumns(){return 8+(this.filterStore.resultsFramework?0:1)-this.filterStore._hiddenColumns.length},get reportColumnWidth(){return this.baseColumns+(!this.resultsFramework&&1)+3+this.reportPeriods.length*(this.isTVA?3:1)},get activeDisaggregationPks(){return this.filterStore.currentDisaggregations},indicatorHasActiveDisaggregations:function(e){var t=this;return!!e.hasDisaggregations(this.activeDisaggregationPks)&&(!this.hiddenCategories||this.activeDisaggregationPks.map((function(e){return t.getDisaggregationLabels(e).labels||[]})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(r){return t.disaggregatedLop(e.pk,r.pk)})).length>0)},getDisaggregationLabels:function(e){return!(!this.currentProgram||!this.currentProgram.disaggregations.has(e))&&this.currentProgram.disaggregations.get(e)},get hasUOMColumn(){return!this.filterStore._hiddenColumns.includes(0)},get hasChangeColumn(){return!this.filterStore._hiddenColumns.includes(1)},get hasCNCColumn(){return!this.filterStore._hiddenColumns.includes(2)},get hasUOMTypeColumn(){return!this.filterStore._hiddenColumns.includes(3)},get hasBaselineColumn(){return!this.filterStore._hiddenColumns.includes(4)},loadResultsModal:function(e){It.a.indicatorResultsTable(e,!1).then((function(e){$("#modalmessages").empty();var t=$("#indicator_modal_content");t.empty().html(e),$("#indicator_modal_div").modal("show"),t.find('[data-toggle="popover"]').popover({html:!0,placement:"right",container:t,template:'<div class="popover" style="width: 325px;" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'})}))},indicatorUpdate:function(e,t){var r=this;t.indicatorId,Jt(t,["indicatorId"]);return this.filterStore.updateProgramFilterData().then((function(){r.loadReportData({update:!0})}))},indicatorDelete:function(e,t){var r=t.indicatorId;Jt(t,["indicatorId"]);this.filterStore.programFilterData.deleteIndicator(r)}});Object(tt.o)((function(){return[t.filterStore.selectedProgramId,t.filterStore.selectedFrequency]}),(function(e){var r=Gt(e,2),n=r[0],a=r[1];n&&a&&t.loadReportData()}),{fireImmediately:!0});return t}(reactContext);l.a.render(i.a.createElement(s.a,{rootStore:Qt,filterStore:Qt.filterStore,reportStore:Qt.reportStore},i.a.createElement(et,null)),document.querySelector("#id_div_content"))},v38i:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"l",(function(){return l})),r.d(t,"i",(function(){return s})),r.d(t,"k",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"m",(function(){return p})),r.d(t,"j",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return m})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return v}));var a={value:null,label:"---------"},i="—",o=i,l=1,s=2,c=[3,4,5,6,7],u=[1,2],p=Object.freeze({1:gettext("Life of Program (LoP) only"),2:gettext("Midline and endline"),3:gettext("Annual"),4:gettext("Semi-annual"),5:gettext("Tri-annual"),6:gettext("Quarterly"),7:gettext("Monthly")}),d=Object.freeze({3:gettext("Years"),4:gettext("Semi-annual periods"),5:gettext("Tri-annual periods"),6:gettext("Quarters"),7:gettext("Months")}),f=1,m=2;"undefined"!=typeof gettext&&gettext;var g,h=Object.freeze({noFilter:0,missingTarget:1,missingResults:2,missingEvidence:3,aboveTarget:5,belowTarget:6,onTarget:7,nonReporting:8}),v=null!==(g="reason_for_change_options",n="undefined"!=typeof JS_GLOBALS&&JS_GLOBALS.hasOwnProperty(g)?JS_GLOBALS[g]:null)&&void 0!==n?n:[]}},[["mYfJ",0,1]]]);
//# sourceMappingURL=iptt_report-bc69346101f08f7161f2.js.map